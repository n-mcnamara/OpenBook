(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function s(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(l){if(l.ep)return;l.ep=!0;const c=s(l);fetch(l.href,c)}})();function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var jsxRuntime={exports:{}},reactJsxRuntime_production={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var t=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function s(a,l,c){var h=null;if(c!==void 0&&(h=""+c),l.key!==void 0&&(h=""+l.key),"key"in l){c={};for(var y in l)y!=="key"&&(c[y]=l[y])}else c=l;return l=c.ref,{$$typeof:t,type:a,key:h,ref:l!==void 0?l:null,props:c}}return reactJsxRuntime_production.Fragment=n,reactJsxRuntime_production.jsx=s,reactJsxRuntime_production.jsxs=s,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var t=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),h=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),v=Symbol.iterator;function w(T){return T===null||typeof T!="object"?null:(T=v&&T[v]||T["@@iterator"],typeof T=="function"?T:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,B={};function N(T,D,Q){this.props=T,this.context=D,this.refs=B,this.updater=Q||S}N.prototype.isReactComponent={},N.prototype.setState=function(T,D){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,D,"setState")},N.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function L(){}L.prototype=N.prototype;function G(T,D,Q){this.props=T,this.context=D,this.refs=B,this.updater=Q||S}var V=G.prototype=new L;V.constructor=G,A(V,N.prototype),V.isPureReactComponent=!0;var ie=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},$=Object.prototype.hasOwnProperty;function j(T,D,Q,re,oe,le){return Q=le.ref,{$$typeof:t,type:T,key:D,ref:Q!==void 0?Q:null,props:le}}function I(T,D){return j(T.type,D,void 0,void 0,void 0,T.props)}function X(T){return typeof T=="object"&&T!==null&&T.$$typeof===t}function te(T){var D={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(Q){return D[Q]})}var H=/\/+/g;function z(T,D){return typeof T=="object"&&T!==null&&T.key!=null?te(""+T.key):D.toString(36)}function C(){}function O(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(C,C):(T.status="pending",T.then(function(D){T.status==="pending"&&(T.status="fulfilled",T.value=D)},function(D){T.status==="pending"&&(T.status="rejected",T.reason=D)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function _(T,D,Q,re,oe){var le=typeof T;(le==="undefined"||le==="boolean")&&(T=null);var ue=!1;if(T===null)ue=!0;else switch(le){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(T.$$typeof){case t:case n:ue=!0;break;case b:return ue=T._init,_(ue(T._payload),D,Q,re,oe)}}if(ue)return oe=oe(T),ue=re===""?"."+z(T,0):re,ie(oe)?(Q="",ue!=null&&(Q=ue.replace(H,"$&/")+"/"),_(oe,D,Q,"",function(ve){return ve})):oe!=null&&(X(oe)&&(oe=I(oe,Q+(oe.key==null||T&&T.key===oe.key?"":(""+oe.key).replace(H,"$&/")+"/")+ue)),D.push(oe)),1;ue=0;var me=re===""?".":re+":";if(ie(T))for(var be=0;be<T.length;be++)re=T[be],le=me+z(re,be),ue+=_(re,D,Q,le,oe);else if(be=w(T),typeof be=="function")for(T=be.call(T),be=0;!(re=T.next()).done;)re=re.value,le=me+z(re,be++),ue+=_(re,D,Q,le,oe);else if(le==="object"){if(typeof T.then=="function")return _(O(T),D,Q,re,oe);throw D=String(T),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.")}return ue}function R(T,D,Q){if(T==null)return T;var re=[],oe=0;return _(T,re,"","",function(le){return D.call(Q,le,oe++)}),re}function U(T){if(T._status===-1){var D=T._result;D=D(),D.then(function(Q){(T._status===0||T._status===-1)&&(T._status=1,T._result=Q)},function(Q){(T._status===0||T._status===-1)&&(T._status=2,T._result=Q)}),T._status===-1&&(T._status=0,T._result=D)}if(T._status===1)return T._result.default;throw T._result}var Y=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var D=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(D))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)};function J(){}return react_production.Children={map:R,forEach:function(T,D,Q){R(T,function(){D.apply(this,arguments)},Q)},count:function(T){var D=0;return R(T,function(){D++}),D},toArray:function(T){return R(T,function(D){return D})||[]},only:function(T){if(!X(T))throw Error("React.Children.only expected to receive a single React element child.");return T}},react_production.Component=N,react_production.Fragment=s,react_production.Profiler=l,react_production.PureComponent=G,react_production.StrictMode=a,react_production.Suspense=g,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(T){return k.H.useMemoCache(T)}},react_production.cache=function(T){return function(){return T.apply(null,arguments)}},react_production.cloneElement=function(T,D,Q){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var re=A({},T.props),oe=T.key,le=void 0;if(D!=null)for(ue in D.ref!==void 0&&(le=void 0),D.key!==void 0&&(oe=""+D.key),D)!$.call(D,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&D.ref===void 0||(re[ue]=D[ue]);var ue=arguments.length-2;if(ue===1)re.children=Q;else if(1<ue){for(var me=Array(ue),be=0;be<ue;be++)me[be]=arguments[be+2];re.children=me}return j(T.type,oe,void 0,void 0,le,re)},react_production.createContext=function(T){return T={$$typeof:h,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:c,_context:T},T},react_production.createElement=function(T,D,Q){var re,oe={},le=null;if(D!=null)for(re in D.key!==void 0&&(le=""+D.key),D)$.call(D,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(oe[re]=D[re]);var ue=arguments.length-2;if(ue===1)oe.children=Q;else if(1<ue){for(var me=Array(ue),be=0;be<ue;be++)me[be]=arguments[be+2];oe.children=me}if(T&&T.defaultProps)for(re in ue=T.defaultProps,ue)oe[re]===void 0&&(oe[re]=ue[re]);return j(T,le,void 0,void 0,null,oe)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(T){return{$$typeof:y,render:T}},react_production.isValidElement=X,react_production.lazy=function(T){return{$$typeof:b,_payload:{_status:-1,_result:T},_init:U}},react_production.memo=function(T,D){return{$$typeof:m,type:T,compare:D===void 0?null:D}},react_production.startTransition=function(T){var D=k.T,Q={};k.T=Q;try{var re=T(),oe=k.S;oe!==null&&oe(Q,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(J,Y)}catch(le){Y(le)}finally{k.T=D}},react_production.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},react_production.use=function(T){return k.H.use(T)},react_production.useActionState=function(T,D,Q){return k.H.useActionState(T,D,Q)},react_production.useCallback=function(T,D){return k.H.useCallback(T,D)},react_production.useContext=function(T){return k.H.useContext(T)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(T,D){return k.H.useDeferredValue(T,D)},react_production.useEffect=function(T,D,Q){var re=k.H;if(typeof Q=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return re.useEffect(T,D)},react_production.useId=function(){return k.H.useId()},react_production.useImperativeHandle=function(T,D,Q){return k.H.useImperativeHandle(T,D,Q)},react_production.useInsertionEffect=function(T,D){return k.H.useInsertionEffect(T,D)},react_production.useLayoutEffect=function(T,D){return k.H.useLayoutEffect(T,D)},react_production.useMemo=function(T,D){return k.H.useMemo(T,D)},react_production.useOptimistic=function(T,D){return k.H.useOptimistic(T,D)},react_production.useReducer=function(T,D,Q){return k.H.useReducer(T,D,Q)},react_production.useRef=function(T){return k.H.useRef(T)},react_production.useState=function(T){return k.H.useState(T)},react_production.useSyncExternalStore=function(T,D,Q){return k.H.useSyncExternalStore(T,D,Q)},react_production.useTransition=function(){return k.H.useTransition()},react_production.version="19.1.1",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,(function(t){function n(R,U){var Y=R.length;R.push(U);e:for(;0<Y;){var J=Y-1>>>1,T=R[J];if(0<l(T,U))R[J]=U,R[Y]=T,Y=J;else break e}}function s(R){return R.length===0?null:R[0]}function a(R){if(R.length===0)return null;var U=R[0],Y=R.pop();if(Y!==U){R[0]=Y;e:for(var J=0,T=R.length,D=T>>>1;J<D;){var Q=2*(J+1)-1,re=R[Q],oe=Q+1,le=R[oe];if(0>l(re,Y))oe<T&&0>l(le,re)?(R[J]=le,R[oe]=Y,J=oe):(R[J]=re,R[Q]=Y,J=Q);else if(oe<T&&0>l(le,Y))R[J]=le,R[oe]=Y,J=oe;else break e}}return U}function l(R,U){var Y=R.sortIndex-U.sortIndex;return Y!==0?Y:R.id-U.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var h=Date,y=h.now();t.unstable_now=function(){return h.now()-y}}var g=[],m=[],b=1,v=null,w=3,S=!1,A=!1,B=!1,N=!1,L=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;function ie(R){for(var U=s(m);U!==null;){if(U.callback===null)a(m);else if(U.startTime<=R)a(m),U.sortIndex=U.expirationTime,n(g,U);else break;U=s(m)}}function k(R){if(B=!1,ie(R),!A)if(s(g)!==null)A=!0,$||($=!0,z());else{var U=s(m);U!==null&&_(k,U.startTime-R)}}var $=!1,j=-1,I=5,X=-1;function te(){return N?!0:!(t.unstable_now()-X<I)}function H(){if(N=!1,$){var R=t.unstable_now();X=R;var U=!0;try{e:{A=!1,B&&(B=!1,G(j),j=-1),S=!0;var Y=w;try{t:{for(ie(R),v=s(g);v!==null&&!(v.expirationTime>R&&te());){var J=v.callback;if(typeof J=="function"){v.callback=null,w=v.priorityLevel;var T=J(v.expirationTime<=R);if(R=t.unstable_now(),typeof T=="function"){v.callback=T,ie(R),U=!0;break t}v===s(g)&&a(g),ie(R)}else a(g);v=s(g)}if(v!==null)U=!0;else{var D=s(m);D!==null&&_(k,D.startTime-R),U=!1}}break e}finally{v=null,w=Y,S=!1}U=void 0}}finally{U?z():$=!1}}}var z;if(typeof V=="function")z=function(){V(H)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,O=C.port2;C.port1.onmessage=H,z=function(){O.postMessage(null)}}else z=function(){L(H,0)};function _(R,U){j=L(function(){R(t.unstable_now())},U)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(R){R.callback=null},t.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<R?Math.floor(1e3/R):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_next=function(R){switch(w){case 1:case 2:case 3:var U=3;break;default:U=w}var Y=w;w=U;try{return R()}finally{w=Y}},t.unstable_requestPaint=function(){N=!0},t.unstable_runWithPriority=function(R,U){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var Y=w;w=R;try{return U()}finally{w=Y}},t.unstable_scheduleCallback=function(R,U,Y){var J=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?J+Y:J):Y=J,R){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=Y+T,R={id:b++,callback:U,priorityLevel:R,startTime:Y,expirationTime:T,sortIndex:-1},Y>J?(R.sortIndex=Y,n(m,R),s(g)===null&&R===s(m)&&(B?(G(j),j=-1):B=!0,_(k,Y-J))):(R.sortIndex=T,n(g,R),A||S||(A=!0,$||($=!0,z()))),R},t.unstable_shouldYield=te,t.unstable_wrapCallback=function(R){var U=w;return function(){var Y=w;w=U;try{return R.apply(this,arguments)}finally{w=Y}}}})(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var t=requireReact();function n(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)m+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var a={d:{f:s,r:function(){throw Error(n(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},l=Symbol.for("react.portal");function c(g,m,b){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:v==null?null:""+v,children:g,containerInfo:m,implementation:b}}var h=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function y(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,reactDom_production.createPortal=function(g,m){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(n(299));return c(g,m,null,b)},reactDom_production.flushSync=function(g){var m=h.T,b=a.p;try{if(h.T=null,a.p=2,g)return g()}finally{h.T=m,a.p=b,a.d.f()}},reactDom_production.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,a.d.C(g,m))},reactDom_production.prefetchDNS=function(g){typeof g=="string"&&a.d.D(g)},reactDom_production.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var b=m.as,v=y(b,m.crossOrigin),w=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;b==="style"?a.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:w,fetchPriority:S}):b==="script"&&a.d.X(g,{crossOrigin:v,integrity:w,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},reactDom_production.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var b=y(m.as,m.crossOrigin);a.d.M(g,{crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&a.d.M(g)},reactDom_production.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var b=m.as,v=y(b,m.crossOrigin);a.d.L(g,b,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},reactDom_production.preloadModule=function(g,m){if(typeof g=="string")if(m){var b=y(m.as,m.crossOrigin);a.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else a.d.m(g)},reactDom_production.requestFormReset=function(g){a.d.r(g)},reactDom_production.unstable_batchedUpdates=function(g,m){return g(m)},reactDom_production.useFormState=function(g,m,b){return h.H.useFormState(g,m,b)},reactDom_production.useFormStatus=function(){return h.H.useHostTransitionStatus()},reactDom_production.version="19.1.1",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}return t(),reactDom.exports=requireReactDom_production(),reactDom.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var t=requireScheduler(),n=requireReact(),s=requireReactDom();function a(e){var r="https://react.dev/errors/"+e;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c(e){var r=e,o=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,(r.flags&4098)!==0&&(o=r.return),e=r.return;while(e)}return r.tag===3?o:null}function h(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function y(e){if(c(e)!==e)throw Error(a(188))}function g(e){var r=e.alternate;if(!r){if(r=c(e),r===null)throw Error(a(188));return r!==e?null:e}for(var o=e,u=r;;){var f=o.return;if(f===null)break;var p=f.alternate;if(p===null){if(u=f.return,u!==null){o=u;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===o)return y(f),e;if(p===u)return y(f),r;p=p.sibling}throw Error(a(188))}if(o.return!==u.return)o=f,u=p;else{for(var E=!1,x=f.child;x;){if(x===o){E=!0,o=f,u=p;break}if(x===u){E=!0,u=f,o=p;break}x=x.sibling}if(!E){for(x=p.child;x;){if(x===o){E=!0,o=p,u=f;break}if(x===u){E=!0,u=p,o=f;break}x=x.sibling}if(!E)throw Error(a(189))}}if(o.alternate!==u)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?e:r}function m(e){var r=e.tag;if(r===5||r===26||r===27||r===6)return e;for(e=e.child;e!==null;){if(r=m(e),r!==null)return r;e=e.sibling}return null}var b=Object.assign,v=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),G=Symbol.for("react.consumer"),V=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),X=Symbol.for("react.activity"),te=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function z(e){return e===null||typeof e!="object"?null:(e=H&&e[H]||e["@@iterator"],typeof e=="function"?e:null)}var C=Symbol.for("react.client.reference");function O(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===C?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case A:return"Fragment";case N:return"Profiler";case B:return"StrictMode";case k:return"Suspense";case $:return"SuspenseList";case X:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case S:return"Portal";case V:return(e.displayName||"Context")+".Provider";case G:return(e._context.displayName||"Context")+".Consumer";case ie:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case j:return r=e.displayName||null,r!==null?r:O(e.type)||"Memo";case I:r=e._payload,e=e._init;try{return O(e(r))}catch{}}return null}var _=Array.isArray,R=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y={pending:!1,data:null,method:null,action:null},J=[],T=-1;function D(e){return{current:e}}function Q(e){0>T||(e.current=J[T],J[T]=null,T--)}function re(e,r){T++,J[T]=e.current,e.current=r}var oe=D(null),le=D(null),ue=D(null),me=D(null);function be(e,r){switch(re(ue,r),re(le,e),re(oe,null),r.nodeType){case 9:case 11:e=(e=r.documentElement)&&(e=e.namespaceURI)?kf(e):0;break;default:if(e=r.tagName,r=r.namespaceURI)r=kf(r),e=Tf(r,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Q(oe),re(oe,e)}function ve(){Q(oe),Q(le),Q(ue)}function Ue(e){e.memoizedState!==null&&re(me,e);var r=oe.current,o=Tf(r,e.type);r!==o&&(re(le,e),re(oe,o))}function bt(e){le.current===e&&(Q(oe),Q(le)),me.current===e&&(Q(me),Er._currentValue=Y)}var Xe=Object.prototype.hasOwnProperty,ot=t.unstable_scheduleCallback,Wt=t.unstable_cancelCallback,_r=t.unstable_shouldYield,kr=t.unstable_requestPaint,Nt=t.unstable_now,xh=t.unstable_getCurrentPriorityLevel,sl=t.unstable_ImmediatePriority,al=t.unstable_UserBlockingPriority,Tr=t.unstable_NormalPriority,Rh=t.unstable_LowPriority,ol=t.unstable_IdlePriority,Sh=t.log,_h=t.unstable_setDisableYieldValue,Ai=null,lt=null;function Jt(e){if(typeof Sh=="function"&&_h(e),lt&&typeof lt.setStrictMode=="function")try{lt.setStrictMode(Ai,e)}catch{}}var ct=Math.clz32?Math.clz32:Ah,kh=Math.log,Th=Math.LN2;function Ah(e){return e>>>=0,e===0?32:31-(kh(e)/Th|0)|0}var Ar=256,Cr=4194304;function Sn(e){var r=e&42;if(r!==0)return r;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Br(e,r,o){var u=e.pendingLanes;if(u===0)return 0;var f=0,p=e.suspendedLanes,E=e.pingedLanes;e=e.warmLanes;var x=u&134217727;return x!==0?(u=x&~p,u!==0?f=Sn(u):(E&=x,E!==0?f=Sn(E):o||(o=x&~e,o!==0&&(f=Sn(o))))):(x=u&~p,x!==0?f=Sn(x):E!==0?f=Sn(E):o||(o=u&~e,o!==0&&(f=Sn(o)))),f===0?0:r!==0&&r!==f&&(r&p)===0&&(p=f&-f,o=r&-r,p>=o||p===32&&(o&4194048)!==0)?r:f}function Ci(e,r){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&r)===0}function Ch(e,r){switch(e){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ll(){var e=Ar;return Ar<<=1,(Ar&4194048)===0&&(Ar=256),e}function ul(){var e=Cr;return Cr<<=1,(Cr&62914560)===0&&(Cr=4194304),e}function Is(e){for(var r=[],o=0;31>o;o++)r.push(e);return r}function Bi(e,r){e.pendingLanes|=r,r!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Bh(e,r,o,u,f,p){var E=e.pendingLanes;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=o,e.entangledLanes&=o,e.errorRecoveryDisabledLanes&=o,e.shellSuspendCounter=0;var x=e.entanglements,M=e.expirationTimes,Z=e.hiddenUpdates;for(o=E&~o;0<o;){var ne=31-ct(o),ae=1<<ne;x[ne]=0,M[ne]=-1;var K=Z[ne];if(K!==null)for(Z[ne]=null,ne=0;ne<K.length;ne++){var W=K[ne];W!==null&&(W.lane&=-536870913)}o&=~ae}u!==0&&cl(e,u,0),p!==0&&f===0&&e.tag!==0&&(e.suspendedLanes|=p&~(E&~r))}function cl(e,r,o){e.pendingLanes|=r,e.suspendedLanes&=~r;var u=31-ct(r);e.entangledLanes|=r,e.entanglements[u]=e.entanglements[u]|1073741824|o&4194090}function fl(e,r){var o=e.entangledLanes|=r;for(e=e.entanglements;o;){var u=31-ct(o),f=1<<u;f&r|e[u]&r&&(e[u]|=r),o&=~f}}function Ps(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Fs(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function hl(){var e=U.p;return e!==0?e:(e=window.event,e===void 0?32:Gf(e.type))}function Nh(e,r){var o=U.p;try{return U.p=e,r()}finally{U.p=o}}var en=Math.random().toString(36).slice(2),Je="__reactFiber$"+en,nt="__reactProps$"+en,In="__reactContainer$"+en,Gs="__reactEvents$"+en,Uh="__reactListeners$"+en,$h="__reactHandles$"+en,dl="__reactResources$"+en,Ni="__reactMarker$"+en;function Ys(e){delete e[Je],delete e[nt],delete e[Gs],delete e[Uh],delete e[$h]}function Pn(e){var r=e[Je];if(r)return r;for(var o=e.parentNode;o;){if(r=o[In]||o[Je]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(e=Nf(e);e!==null;){if(o=e[Je])return o;e=Nf(e)}return r}e=o,o=e.parentNode}return null}function Fn(e){if(e=e[Je]||e[In]){var r=e.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return e}return null}function Ui(e){var r=e.tag;if(r===5||r===26||r===27||r===6)return e.stateNode;throw Error(a(33))}function Gn(e){var r=e[dl];return r||(r=e[dl]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Fe(e){e[Ni]=!0}var pl=new Set,yl={};function _n(e,r){Yn(e,r),Yn(e+"Capture",r)}function Yn(e,r){for(yl[e]=r,e=0;e<r.length;e++)pl.add(r[e])}var Mh=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gl={},ml={};function Lh(e){return Xe.call(ml,e)?!0:Xe.call(gl,e)?!1:Mh.test(e)?ml[e]=!0:(gl[e]=!0,!1)}function Nr(e,r,o){if(Lh(r))if(o===null)e.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":e.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){e.removeAttribute(r);return}}e.setAttribute(r,""+o)}}function Ur(e,r,o){if(o===null)e.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttribute(r,""+o)}}function Dt(e,r,o,u){if(u===null)e.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(o);return}e.setAttributeNS(r,o,""+u)}}var Zs,bl;function Zn(e){if(Zs===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Zs=r&&r[1]||"",bl=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Zs+e+bl}var Xs=!1;function Qs(e,r){if(!e||Xs)return"";Xs=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var ae=function(){throw Error()};if(Object.defineProperty(ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ae,[])}catch(W){var K=W}Reflect.construct(e,[],ae)}else{try{ae.call()}catch(W){K=W}e.call(ae.prototype)}}else{try{throw Error()}catch(W){K=W}(ae=e())&&typeof ae.catch=="function"&&ae.catch(function(){})}}catch(W){if(W&&K&&typeof W.stack=="string")return[W.stack,K.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=u.DetermineComponentFrameRoot(),E=p[0],x=p[1];if(E&&x){var M=E.split(`
`),Z=x.split(`
`);for(f=u=0;u<M.length&&!M[u].includes("DetermineComponentFrameRoot");)u++;for(;f<Z.length&&!Z[f].includes("DetermineComponentFrameRoot");)f++;if(u===M.length||f===Z.length)for(u=M.length-1,f=Z.length-1;1<=u&&0<=f&&M[u]!==Z[f];)f--;for(;1<=u&&0<=f;u--,f--)if(M[u]!==Z[f]){if(u!==1||f!==1)do if(u--,f--,0>f||M[u]!==Z[f]){var ne=`
`+M[u].replace(" at new "," at ");return e.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",e.displayName)),ne}while(1<=u&&0<=f);break}}}finally{Xs=!1,Error.prepareStackTrace=o}return(o=e?e.displayName||e.name:"")?Zn(o):""}function Oh(e){switch(e.tag){case 26:case 27:case 5:return Zn(e.type);case 16:return Zn("Lazy");case 13:return Zn("Suspense");case 19:return Zn("SuspenseList");case 0:case 15:return Qs(e.type,!1);case 11:return Qs(e.type.render,!1);case 1:return Qs(e.type,!0);case 31:return Zn("Activity");default:return""}}function vl(e){try{var r="";do r+=Oh(e),e=e.return;while(e);return r}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function vt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function El(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Dh(e){var r=El(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),u=""+e[r];if(!e.hasOwnProperty(r)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var f=o.get,p=o.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return f.call(this)},set:function(E){u=""+E,p.call(this,E)}}),Object.defineProperty(e,r,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(E){u=""+E},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function $r(e){e._valueTracker||(e._valueTracker=Dh(e))}function wl(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var o=r.getValue(),u="";return e&&(u=El(e)?e.checked?"true":"false":e.value),e=u,e!==o?(r.setValue(e),!0):!1}function Mr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var jh=/[\n"\\]/g;function Et(e){return e.replace(jh,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Ks(e,r,o,u,f,p,E,x){e.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?e.type=E:e.removeAttribute("type"),r!=null?E==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+vt(r)):e.value!==""+vt(r)&&(e.value=""+vt(r)):E!=="submit"&&E!=="reset"||e.removeAttribute("value"),r!=null?Ws(e,E,vt(r)):o!=null?Ws(e,E,vt(o)):u!=null&&e.removeAttribute("value"),f==null&&p!=null&&(e.defaultChecked=!!p),f!=null&&(e.checked=f&&typeof f!="function"&&typeof f!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?e.name=""+vt(x):e.removeAttribute("name")}function xl(e,r,o,u,f,p,E,x){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.type=p),r!=null||o!=null){if(!(p!=="submit"&&p!=="reset"||r!=null))return;o=o!=null?""+vt(o):"",r=r!=null?""+vt(r):o,x||r===e.value||(e.value=r),e.defaultValue=r}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,e.checked=x?e.checked:!!u,e.defaultChecked=!!u,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(e.name=E)}function Ws(e,r,o){r==="number"&&Mr(e.ownerDocument)===e||e.defaultValue===""+o||(e.defaultValue=""+o)}function Xn(e,r,o,u){if(e=e.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<e.length;o++)f=r.hasOwnProperty("$"+e[o].value),e[o].selected!==f&&(e[o].selected=f),f&&u&&(e[o].defaultSelected=!0)}else{for(o=""+vt(o),r=null,f=0;f<e.length;f++){if(e[f].value===o){e[f].selected=!0,u&&(e[f].defaultSelected=!0);return}r!==null||e[f].disabled||(r=e[f])}r!==null&&(r.selected=!0)}}function Rl(e,r,o){if(r!=null&&(r=""+vt(r),r!==e.value&&(e.value=r),o==null)){e.defaultValue!==r&&(e.defaultValue=r);return}e.defaultValue=o!=null?""+vt(o):""}function Sl(e,r,o,u){if(r==null){if(u!=null){if(o!=null)throw Error(a(92));if(_(u)){if(1<u.length)throw Error(a(93));u=u[0]}o=u}o==null&&(o=""),r=o}o=vt(r),e.defaultValue=o,u=e.textContent,u===o&&u!==""&&u!==null&&(e.value=u)}function Qn(e,r){if(r){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=r;return}}e.textContent=r}var Hh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _l(e,r,o){var u=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="":u?e.setProperty(r,o):typeof o!="number"||o===0||Hh.has(r)?r==="float"?e.cssFloat=o:e[r]=(""+o).trim():e[r]=o+"px"}function kl(e,r,o){if(r!=null&&typeof r!="object")throw Error(a(62));if(e=e.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?e.setProperty(u,""):u==="float"?e.cssFloat="":e[u]="");for(var f in r)u=r[f],r.hasOwnProperty(f)&&o[f]!==u&&_l(e,f,u)}else for(var p in r)r.hasOwnProperty(p)&&_l(e,p,r[p])}function Js(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Lr(e){return qh.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var ea=null;function ta(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Kn=null,Wn=null;function Tl(e){var r=Fn(e);if(r&&(e=r.stateNode)){var o=e[nt]||null;e:switch(e=r.stateNode,r.type){case"input":if(Ks(e,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Et(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var u=o[r];if(u!==e&&u.form===e.form){var f=u[nt]||null;if(!f)throw Error(a(90));Ks(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)u=o[r],u.form===e.form&&wl(u)}break e;case"textarea":Rl(e,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&Xn(e,!!o.multiple,r,!1)}}}var na=!1;function Al(e,r,o){if(na)return e(r,o);na=!0;try{var u=e(r);return u}finally{if(na=!1,(Kn!==null||Wn!==null)&&(ws(),Kn&&(r=Kn,e=Wn,Wn=Kn=null,Tl(r),e)))for(r=0;r<e.length;r++)Tl(e[r])}}function $i(e,r){var o=e.stateNode;if(o===null)return null;var u=o[nt]||null;if(u===null)return null;o=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(a(231,r,typeof o));return o}var jt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ia=!1;if(jt)try{var Mi={};Object.defineProperty(Mi,"passive",{get:function(){ia=!0}}),window.addEventListener("test",Mi,Mi),window.removeEventListener("test",Mi,Mi)}catch{ia=!1}var tn=null,ra=null,Or=null;function Cl(){if(Or)return Or;var e,r=ra,o=r.length,u,f="value"in tn?tn.value:tn.textContent,p=f.length;for(e=0;e<o&&r[e]===f[e];e++);var E=o-e;for(u=1;u<=E&&r[o-u]===f[p-u];u++);return Or=f.slice(e,1<u?1-u:void 0)}function Dr(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function jr(){return!0}function Bl(){return!1}function it(e){function r(o,u,f,p,E){this._reactName=o,this._targetInst=f,this.type=u,this.nativeEvent=p,this.target=E,this.currentTarget=null;for(var x in e)e.hasOwnProperty(x)&&(o=e[x],this[x]=o?o(p):p[x]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?jr:Bl,this.isPropagationStopped=Bl,this}return b(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=jr)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=jr)},persist:function(){},isPersistent:jr}),r}var kn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hr=it(kn),Li=b({},kn,{view:0,detail:0}),Vh=it(Li),sa,aa,Oi,zr=b({},Li,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:la,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Oi&&(Oi&&e.type==="mousemove"?(sa=e.screenX-Oi.screenX,aa=e.screenY-Oi.screenY):aa=sa=0,Oi=e),sa)},movementY:function(e){return"movementY"in e?e.movementY:aa}}),Nl=it(zr),Ih=b({},zr,{dataTransfer:0}),Ph=it(Ih),Fh=b({},Li,{relatedTarget:0}),oa=it(Fh),Gh=b({},kn,{animationName:0,elapsedTime:0,pseudoElement:0}),Yh=it(Gh),Zh=b({},kn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Xh=it(Zh),Qh=b({},kn,{data:0}),Ul=it(Qh),Kh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ed(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=Jh[e])?!!r[e]:!1}function la(){return ed}var td=b({},Li,{key:function(e){if(e.key){var r=Kh[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=Dr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Wh[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:la,charCode:function(e){return e.type==="keypress"?Dr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Dr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),nd=it(td),id=b({},zr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$l=it(id),rd=b({},Li,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:la}),sd=it(rd),ad=b({},kn,{propertyName:0,elapsedTime:0,pseudoElement:0}),od=it(ad),ld=b({},zr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ud=it(ld),cd=b({},kn,{newState:0,oldState:0}),fd=it(cd),hd=[9,13,27,32],ua=jt&&"CompositionEvent"in window,Di=null;jt&&"documentMode"in document&&(Di=document.documentMode);var dd=jt&&"TextEvent"in window&&!Di,Ml=jt&&(!ua||Di&&8<Di&&11>=Di),Ll=" ",Ol=!1;function Dl(e,r){switch(e){case"keyup":return hd.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jl(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Jn=!1;function pd(e,r){switch(e){case"compositionend":return jl(r);case"keypress":return r.which!==32?null:(Ol=!0,Ll);case"textInput":return e=r.data,e===Ll&&Ol?null:e;default:return null}}function yd(e,r){if(Jn)return e==="compositionend"||!ua&&Dl(e,r)?(e=Cl(),Or=ra=tn=null,Jn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Ml&&r.locale!=="ko"?null:r.data;default:return null}}var gd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hl(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!gd[e.type]:r==="textarea"}function zl(e,r,o,u){Kn?Wn?Wn.push(u):Wn=[u]:Kn=u,r=Ts(r,"onChange"),0<r.length&&(o=new Hr("onChange","change",null,o,u),e.push({event:o,listeners:r}))}var ji=null,Hi=null;function md(e){wf(e,0)}function qr(e){var r=Ui(e);if(wl(r))return e}function ql(e,r){if(e==="change")return r}var Vl=!1;if(jt){var ca;if(jt){var fa="oninput"in document;if(!fa){var Il=document.createElement("div");Il.setAttribute("oninput","return;"),fa=typeof Il.oninput=="function"}ca=fa}else ca=!1;Vl=ca&&(!document.documentMode||9<document.documentMode)}function Pl(){ji&&(ji.detachEvent("onpropertychange",Fl),Hi=ji=null)}function Fl(e){if(e.propertyName==="value"&&qr(Hi)){var r=[];zl(r,Hi,e,ta(e)),Al(md,r)}}function bd(e,r,o){e==="focusin"?(Pl(),ji=r,Hi=o,ji.attachEvent("onpropertychange",Fl)):e==="focusout"&&Pl()}function vd(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return qr(Hi)}function Ed(e,r){if(e==="click")return qr(r)}function wd(e,r){if(e==="input"||e==="change")return qr(r)}function xd(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var ft=typeof Object.is=="function"?Object.is:xd;function zi(e,r){if(ft(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var o=Object.keys(e),u=Object.keys(r);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var f=o[u];if(!Xe.call(r,f)||!ft(e[f],r[f]))return!1}return!0}function Gl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Yl(e,r){var o=Gl(e);e=0;for(var u;o;){if(o.nodeType===3){if(u=e+o.textContent.length,e<=r&&u>=r)return{node:o,offset:r-e};e=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Gl(o)}}function Zl(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?Zl(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function Xl(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var r=Mr(e.document);r instanceof e.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)e=r.contentWindow;else break;r=Mr(e.document)}return r}function ha(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}var Rd=jt&&"documentMode"in document&&11>=document.documentMode,ei=null,da=null,qi=null,pa=!1;function Ql(e,r,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;pa||ei==null||ei!==Mr(u)||(u=ei,"selectionStart"in u&&ha(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),qi&&zi(qi,u)||(qi=u,u=Ts(da,"onSelect"),0<u.length&&(r=new Hr("onSelect","select",null,r,o),e.push({event:r,listeners:u}),r.target=ei)))}function Tn(e,r){var o={};return o[e.toLowerCase()]=r.toLowerCase(),o["Webkit"+e]="webkit"+r,o["Moz"+e]="moz"+r,o}var ti={animationend:Tn("Animation","AnimationEnd"),animationiteration:Tn("Animation","AnimationIteration"),animationstart:Tn("Animation","AnimationStart"),transitionrun:Tn("Transition","TransitionRun"),transitionstart:Tn("Transition","TransitionStart"),transitioncancel:Tn("Transition","TransitionCancel"),transitionend:Tn("Transition","TransitionEnd")},ya={},Kl={};jt&&(Kl=document.createElement("div").style,"AnimationEvent"in window||(delete ti.animationend.animation,delete ti.animationiteration.animation,delete ti.animationstart.animation),"TransitionEvent"in window||delete ti.transitionend.transition);function An(e){if(ya[e])return ya[e];if(!ti[e])return e;var r=ti[e],o;for(o in r)if(r.hasOwnProperty(o)&&o in Kl)return ya[e]=r[o];return e}var Wl=An("animationend"),Jl=An("animationiteration"),eu=An("animationstart"),Sd=An("transitionrun"),_d=An("transitionstart"),kd=An("transitioncancel"),tu=An("transitionend"),nu=new Map,ga="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ga.push("scrollEnd");function At(e,r){nu.set(e,r),_n(r,[e])}var iu=new WeakMap;function wt(e,r){if(typeof e=="object"&&e!==null){var o=iu.get(e);return o!==void 0?o:(r={value:e,source:r,stack:vl(r)},iu.set(e,r),r)}return{value:e,source:r,stack:vl(r)}}var xt=[],ni=0,ma=0;function Vr(){for(var e=ni,r=ma=ni=0;r<e;){var o=xt[r];xt[r++]=null;var u=xt[r];xt[r++]=null;var f=xt[r];xt[r++]=null;var p=xt[r];if(xt[r++]=null,u!==null&&f!==null){var E=u.pending;E===null?f.next=f:(f.next=E.next,E.next=f),u.pending=f}p!==0&&ru(o,f,p)}}function Ir(e,r,o,u){xt[ni++]=e,xt[ni++]=r,xt[ni++]=o,xt[ni++]=u,ma|=u,e.lanes|=u,e=e.alternate,e!==null&&(e.lanes|=u)}function ba(e,r,o,u){return Ir(e,r,o,u),Pr(e)}function ii(e,r){return Ir(e,null,null,r),Pr(e)}function ru(e,r,o){e.lanes|=o;var u=e.alternate;u!==null&&(u.lanes|=o);for(var f=!1,p=e.return;p!==null;)p.childLanes|=o,u=p.alternate,u!==null&&(u.childLanes|=o),p.tag===22&&(e=p.stateNode,e===null||e._visibility&1||(f=!0)),e=p,p=p.return;return e.tag===3?(p=e.stateNode,f&&r!==null&&(f=31-ct(o),e=p.hiddenUpdates,u=e[f],u===null?e[f]=[r]:u.push(r),r.lane=o|536870912),p):null}function Pr(e){if(50<hr)throw hr=0,ko=null,Error(a(185));for(var r=e.return;r!==null;)e=r,r=e.return;return e.tag===3?e.stateNode:null}var ri={};function Td(e,r,o,u){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ht(e,r,o,u){return new Td(e,r,o,u)}function va(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ht(e,r){var o=e.alternate;return o===null?(o=ht(e.tag,r,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=r,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&65011712,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,r=e.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o.refCleanup=e.refCleanup,o}function su(e,r){e.flags&=65011714;var o=e.alternate;return o===null?(e.childLanes=0,e.lanes=r,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=o.childLanes,e.lanes=o.lanes,e.child=o.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=o.memoizedProps,e.memoizedState=o.memoizedState,e.updateQueue=o.updateQueue,e.type=o.type,r=o.dependencies,e.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),e}function Fr(e,r,o,u,f,p){var E=0;if(u=e,typeof e=="function")va(e)&&(E=1);else if(typeof e=="string")E=Cp(e,o,oe.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case X:return e=ht(31,o,r,f),e.elementType=X,e.lanes=p,e;case A:return Cn(o.children,f,p,r);case B:E=8,f|=24;break;case N:return e=ht(12,o,r,f|2),e.elementType=N,e.lanes=p,e;case k:return e=ht(13,o,r,f),e.elementType=k,e.lanes=p,e;case $:return e=ht(19,o,r,f),e.elementType=$,e.lanes=p,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case L:case V:E=10;break e;case G:E=9;break e;case ie:E=11;break e;case j:E=14;break e;case I:E=16,u=null;break e}E=29,o=Error(a(130,e===null?"null":typeof e,"")),u=null}return r=ht(E,o,r,f),r.elementType=e,r.type=u,r.lanes=p,r}function Cn(e,r,o,u){return e=ht(7,e,u,r),e.lanes=o,e}function Ea(e,r,o){return e=ht(6,e,null,r),e.lanes=o,e}function wa(e,r,o){return r=ht(4,e.children!==null?e.children:[],e.key,r),r.lanes=o,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}var si=[],ai=0,Gr=null,Yr=0,Rt=[],St=0,Bn=null,zt=1,qt="";function Nn(e,r){si[ai++]=Yr,si[ai++]=Gr,Gr=e,Yr=r}function au(e,r,o){Rt[St++]=zt,Rt[St++]=qt,Rt[St++]=Bn,Bn=e;var u=zt;e=qt;var f=32-ct(u)-1;u&=~(1<<f),o+=1;var p=32-ct(r)+f;if(30<p){var E=f-f%5;p=(u&(1<<E)-1).toString(32),u>>=E,f-=E,zt=1<<32-ct(r)+f|o<<f|u,qt=p+e}else zt=1<<p|o<<f|u,qt=e}function xa(e){e.return!==null&&(Nn(e,1),au(e,1,0))}function Ra(e){for(;e===Gr;)Gr=si[--ai],si[ai]=null,Yr=si[--ai],si[ai]=null;for(;e===Bn;)Bn=Rt[--St],Rt[St]=null,qt=Rt[--St],Rt[St]=null,zt=Rt[--St],Rt[St]=null}var tt=null,De=null,ke=!1,Un=null,Ut=!1,Sa=Error(a(519));function $n(e){var r=Error(a(418,""));throw Pi(wt(r,e)),Sa}function ou(e){var r=e.stateNode,o=e.type,u=e.memoizedProps;switch(r[Je]=e,r[nt]=u,o){case"dialog":Re("cancel",r),Re("close",r);break;case"iframe":case"object":case"embed":Re("load",r);break;case"video":case"audio":for(o=0;o<pr.length;o++)Re(pr[o],r);break;case"source":Re("error",r);break;case"img":case"image":case"link":Re("error",r),Re("load",r);break;case"details":Re("toggle",r);break;case"input":Re("invalid",r),xl(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),$r(r);break;case"select":Re("invalid",r);break;case"textarea":Re("invalid",r),Sl(r,u.value,u.defaultValue,u.children),$r(r)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||u.suppressHydrationWarning===!0||_f(r.textContent,o)?(u.popover!=null&&(Re("beforetoggle",r),Re("toggle",r)),u.onScroll!=null&&Re("scroll",r),u.onScrollEnd!=null&&Re("scrollend",r),u.onClick!=null&&(r.onclick=As),r=!0):r=!1,r||$n(e)}function lu(e){for(tt=e.return;tt;)switch(tt.tag){case 5:case 13:Ut=!1;return;case 27:case 3:Ut=!0;return;default:tt=tt.return}}function Vi(e){if(e!==tt)return!1;if(!ke)return lu(e),ke=!0,!1;var r=e.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=e.type,o=!(o!=="form"&&o!=="button")||Vo(e.type,e.memoizedProps)),o=!o),o&&De&&$n(e),lu(e),r===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8)if(o=e.data,o==="/$"){if(r===0){De=Bt(e.nextSibling);break e}r--}else o!=="$"&&o!=="$!"&&o!=="$?"||r++;e=e.nextSibling}De=null}}else r===27?(r=De,bn(e.type)?(e=Go,Go=null,De=e):De=r):De=tt?Bt(e.stateNode.nextSibling):null;return!0}function Ii(){De=tt=null,ke=!1}function uu(){var e=Un;return e!==null&&(at===null?at=e:at.push.apply(at,e),Un=null),e}function Pi(e){Un===null?Un=[e]:Un.push(e)}var ka=D(null),Mn=null,Vt=null;function nn(e,r,o){re(ka,r._currentValue),r._currentValue=o}function It(e){e._currentValue=ka.current,Q(ka)}function Ta(e,r,o){for(;e!==null;){var u=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),e===o)break;e=e.return}}function Aa(e,r,o,u){var f=e.child;for(f!==null&&(f.return=e);f!==null;){var p=f.dependencies;if(p!==null){var E=f.child;p=p.firstContext;e:for(;p!==null;){var x=p;p=f;for(var M=0;M<r.length;M++)if(x.context===r[M]){p.lanes|=o,x=p.alternate,x!==null&&(x.lanes|=o),Ta(p.return,o,e),u||(E=null);break e}p=x.next}}else if(f.tag===18){if(E=f.return,E===null)throw Error(a(341));E.lanes|=o,p=E.alternate,p!==null&&(p.lanes|=o),Ta(E,o,e),E=null}else E=f.child;if(E!==null)E.return=f;else for(E=f;E!==null;){if(E===e){E=null;break}if(f=E.sibling,f!==null){f.return=E.return,E=f;break}E=E.return}f=E}}function Fi(e,r,o,u){e=null;for(var f=r,p=!1;f!==null;){if(!p){if((f.flags&524288)!==0)p=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var E=f.alternate;if(E===null)throw Error(a(387));if(E=E.memoizedProps,E!==null){var x=f.type;ft(f.pendingProps.value,E.value)||(e!==null?e.push(x):e=[x])}}else if(f===me.current){if(E=f.alternate,E===null)throw Error(a(387));E.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(e!==null?e.push(Er):e=[Er])}f=f.return}e!==null&&Aa(r,e,o,u),r.flags|=262144}function Zr(e){for(e=e.firstContext;e!==null;){if(!ft(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ln(e){Mn=e,Vt=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function et(e){return cu(Mn,e)}function Xr(e,r){return Mn===null&&Ln(e),cu(e,r)}function cu(e,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Vt===null){if(e===null)throw Error(a(308));Vt=r,e.dependencies={lanes:0,firstContext:r},e.flags|=524288}else Vt=Vt.next=r;return o}var Ad=typeof AbortController<"u"?AbortController:function(){var e=[],r=this.signal={aborted:!1,addEventListener:function(o,u){e.push(u)}};this.abort=function(){r.aborted=!0,e.forEach(function(o){return o()})}},Cd=t.unstable_scheduleCallback,Bd=t.unstable_NormalPriority,Ie={$$typeof:V,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ca(){return{controller:new Ad,data:new Map,refCount:0}}function Gi(e){e.refCount--,e.refCount===0&&Cd(Bd,function(){e.controller.abort()})}var Yi=null,Ba=0,oi=0,li=null;function Nd(e,r){if(Yi===null){var o=Yi=[];Ba=0,oi=$o(),li={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Ba++,r.then(fu,fu),r}function fu(){if(--Ba===0&&Yi!==null){li!==null&&(li.status="fulfilled");var e=Yi;Yi=null,oi=0,li=null;for(var r=0;r<e.length;r++)(0,e[r])()}}function Ud(e,r){var o=[],u={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return e.then(function(){u.status="fulfilled",u.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(u.status="rejected",u.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),u}var hu=R.S;R.S=function(e,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&Nd(e,r),hu!==null&&hu(e,r)};var On=D(null);function Na(){var e=On.current;return e!==null?e:Me.pooledCache}function Qr(e,r){r===null?re(On,On.current):re(On,r.pool)}function du(){var e=Na();return e===null?null:{parent:Ie._currentValue,pool:e}}var Zi=Error(a(460)),pu=Error(a(474)),Kr=Error(a(542)),Ua={then:function(){}};function yu(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Wr(){}function gu(e,r,o){switch(o=e[o],o===void 0?e.push(r):o!==r&&(r.then(Wr,Wr),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw e=r.reason,bu(e),e;default:if(typeof r.status=="string")r.then(Wr,Wr);else{if(e=Me,e!==null&&100<e.shellSuspendCounter)throw Error(a(482));e=r,e.status="pending",e.then(function(u){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=u}},function(u){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw e=r.reason,bu(e),e}throw Xi=r,Zi}}var Xi=null;function mu(){if(Xi===null)throw Error(a(459));var e=Xi;return Xi=null,e}function bu(e){if(e===Zi||e===Kr)throw Error(a(483))}var rn=!1;function $a(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ma(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function sn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function an(e,r,o){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,(Te&2)!==0){var f=u.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),u.pending=r,r=Pr(e),ru(e,null,o),r}return Ir(e,u,r,o),Pr(e)}function Qi(e,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var u=r.lanes;u&=e.pendingLanes,o|=u,r.lanes=o,fl(e,o)}}function La(e,r){var o=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var f=null,p=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};p===null?f=p=E:p=p.next=E,o=o.next}while(o!==null);p===null?f=p=r:p=p.next=r}else f=p=r;o={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:u.shared,callbacks:u.callbacks},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=r:e.next=r,o.lastBaseUpdate=r}var Oa=!1;function Ki(){if(Oa){var e=li;if(e!==null)throw e}}function Wi(e,r,o,u){Oa=!1;var f=e.updateQueue;rn=!1;var p=f.firstBaseUpdate,E=f.lastBaseUpdate,x=f.shared.pending;if(x!==null){f.shared.pending=null;var M=x,Z=M.next;M.next=null,E===null?p=Z:E.next=Z,E=M;var ne=e.alternate;ne!==null&&(ne=ne.updateQueue,x=ne.lastBaseUpdate,x!==E&&(x===null?ne.firstBaseUpdate=Z:x.next=Z,ne.lastBaseUpdate=M))}if(p!==null){var ae=f.baseState;E=0,ne=Z=M=null,x=p;do{var K=x.lane&-536870913,W=K!==x.lane;if(W?(Se&K)===K:(u&K)===K){K!==0&&K===oi&&(Oa=!0),ne!==null&&(ne=ne.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var ye=e,de=x;K=r;var Ne=o;switch(de.tag){case 1:if(ye=de.payload,typeof ye=="function"){ae=ye.call(Ne,ae,K);break e}ae=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=de.payload,K=typeof ye=="function"?ye.call(Ne,ae,K):ye,K==null)break e;ae=b({},ae,K);break e;case 2:rn=!0}}K=x.callback,K!==null&&(e.flags|=64,W&&(e.flags|=8192),W=f.callbacks,W===null?f.callbacks=[K]:W.push(K))}else W={lane:K,tag:x.tag,payload:x.payload,callback:x.callback,next:null},ne===null?(Z=ne=W,M=ae):ne=ne.next=W,E|=K;if(x=x.next,x===null){if(x=f.shared.pending,x===null)break;W=x,x=W.next,W.next=null,f.lastBaseUpdate=W,f.shared.pending=null}}while(!0);ne===null&&(M=ae),f.baseState=M,f.firstBaseUpdate=Z,f.lastBaseUpdate=ne,p===null&&(f.shared.lanes=0),pn|=E,e.lanes=E,e.memoizedState=ae}}function vu(e,r){if(typeof e!="function")throw Error(a(191,e));e.call(r)}function Eu(e,r){var o=e.callbacks;if(o!==null)for(e.callbacks=null,e=0;e<o.length;e++)vu(o[e],r)}var ui=D(null),Jr=D(0);function wu(e,r){e=Qt,re(Jr,e),re(ui,r),Qt=e|r.baseLanes}function Da(){re(Jr,Qt),re(ui,ui.current)}function ja(){Qt=Jr.current,Q(ui),Q(Jr)}var on=0,Ee=null,Ce=null,qe=null,es=!1,ci=!1,Dn=!1,ts=0,Ji=0,fi=null,$d=0;function He(){throw Error(a(321))}function Ha(e,r){if(r===null)return!1;for(var o=0;o<r.length&&o<e.length;o++)if(!ft(e[o],r[o]))return!1;return!0}function za(e,r,o,u,f,p){return on=p,Ee=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,R.H=e===null||e.memoizedState===null?rc:sc,Dn=!1,p=o(u,f),Dn=!1,ci&&(p=Ru(r,o,u,f)),xu(e),p}function xu(e){R.H=os;var r=Ce!==null&&Ce.next!==null;if(on=0,qe=Ce=Ee=null,es=!1,Ji=0,fi=null,r)throw Error(a(300));e===null||Ge||(e=e.dependencies,e!==null&&Zr(e)&&(Ge=!0))}function Ru(e,r,o,u){Ee=e;var f=0;do{if(ci&&(fi=null),Ji=0,ci=!1,25<=f)throw Error(a(301));if(f+=1,qe=Ce=null,e.updateQueue!=null){var p=e.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}R.H=zd,p=r(o,u)}while(ci);return p}function Md(){var e=R.H,r=e.useState()[0];return r=typeof r.then=="function"?er(r):r,e=e.useState()[0],(Ce!==null?Ce.memoizedState:null)!==e&&(Ee.flags|=1024),r}function qa(){var e=ts!==0;return ts=0,e}function Va(e,r,o){r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~o}function Ia(e){if(es){for(e=e.memoizedState;e!==null;){var r=e.queue;r!==null&&(r.pending=null),e=e.next}es=!1}on=0,qe=Ce=Ee=null,ci=!1,Ji=ts=0,fi=null}function rt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qe===null?Ee.memoizedState=qe=e:qe=qe.next=e,qe}function Ve(){if(Ce===null){var e=Ee.alternate;e=e!==null?e.memoizedState:null}else e=Ce.next;var r=qe===null?Ee.memoizedState:qe.next;if(r!==null)qe=r,Ce=e;else{if(e===null)throw Ee.alternate===null?Error(a(467)):Error(a(310));Ce=e,e={memoizedState:Ce.memoizedState,baseState:Ce.baseState,baseQueue:Ce.baseQueue,queue:Ce.queue,next:null},qe===null?Ee.memoizedState=qe=e:qe=qe.next=e}return qe}function Pa(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function er(e){var r=Ji;return Ji+=1,fi===null&&(fi=[]),e=gu(fi,e,r),r=Ee,(qe===null?r.memoizedState:qe.next)===null&&(r=r.alternate,R.H=r===null||r.memoizedState===null?rc:sc),e}function ns(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return er(e);if(e.$$typeof===V)return et(e)}throw Error(a(438,String(e)))}function Fa(e){var r=null,o=Ee.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var u=Ee.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=Pa(),Ee.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(e),u=0;u<e;u++)o[u]=te;return r.index++,o}function Pt(e,r){return typeof r=="function"?r(e):r}function is(e){var r=Ve();return Ga(r,Ce,e)}function Ga(e,r,o){var u=e.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=o;var f=e.baseQueue,p=u.pending;if(p!==null){if(f!==null){var E=f.next;f.next=p.next,p.next=E}r.baseQueue=f=p,u.pending=null}if(p=e.baseState,f===null)e.memoizedState=p;else{r=f.next;var x=E=null,M=null,Z=r,ne=!1;do{var ae=Z.lane&-536870913;if(ae!==Z.lane?(Se&ae)===ae:(on&ae)===ae){var K=Z.revertLane;if(K===0)M!==null&&(M=M.next={lane:0,revertLane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),ae===oi&&(ne=!0);else if((on&K)===K){Z=Z.next,K===oi&&(ne=!0);continue}else ae={lane:0,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},M===null?(x=M=ae,E=p):M=M.next=ae,Ee.lanes|=K,pn|=K;ae=Z.action,Dn&&o(p,ae),p=Z.hasEagerState?Z.eagerState:o(p,ae)}else K={lane:ae,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},M===null?(x=M=K,E=p):M=M.next=K,Ee.lanes|=ae,pn|=ae;Z=Z.next}while(Z!==null&&Z!==r);if(M===null?E=p:M.next=x,!ft(p,e.memoizedState)&&(Ge=!0,ne&&(o=li,o!==null)))throw o;e.memoizedState=p,e.baseState=E,e.baseQueue=M,u.lastRenderedState=p}return f===null&&(u.lanes=0),[e.memoizedState,u.dispatch]}function Ya(e){var r=Ve(),o=r.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=e;var u=o.dispatch,f=o.pending,p=r.memoizedState;if(f!==null){o.pending=null;var E=f=f.next;do p=e(p,E.action),E=E.next;while(E!==f);ft(p,r.memoizedState)||(Ge=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),o.lastRenderedState=p}return[p,u]}function Su(e,r,o){var u=Ee,f=Ve(),p=ke;if(p){if(o===void 0)throw Error(a(407));o=o()}else o=r();var E=!ft((Ce||f).memoizedState,o);E&&(f.memoizedState=o,Ge=!0),f=f.queue;var x=Tu.bind(null,u,f,e);if(tr(2048,8,x,[e]),f.getSnapshot!==r||E||qe!==null&&qe.memoizedState.tag&1){if(u.flags|=2048,hi(9,rs(),ku.bind(null,u,f,o,r),null),Me===null)throw Error(a(349));p||(on&124)!==0||_u(u,r,o)}return o}function _u(e,r,o){e.flags|=16384,e={getSnapshot:r,value:o},r=Ee.updateQueue,r===null?(r=Pa(),Ee.updateQueue=r,r.stores=[e]):(o=r.stores,o===null?r.stores=[e]:o.push(e))}function ku(e,r,o,u){r.value=o,r.getSnapshot=u,Au(r)&&Cu(e)}function Tu(e,r,o){return o(function(){Au(r)&&Cu(e)})}function Au(e){var r=e.getSnapshot;e=e.value;try{var o=r();return!ft(e,o)}catch{return!0}}function Cu(e){var r=ii(e,2);r!==null&&mt(r,e,2)}function Za(e){var r=rt();if(typeof e=="function"){var o=e;if(e=o(),Dn){Jt(!0);try{o()}finally{Jt(!1)}}}return r.memoizedState=r.baseState=e,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pt,lastRenderedState:e},r}function Bu(e,r,o,u){return e.baseState=o,Ga(e,Ce,typeof u=="function"?u:Pt)}function Ld(e,r,o,u,f){if(as(e))throw Error(a(485));if(e=r.action,e!==null){var p={payload:f,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){p.listeners.push(E)}};R.T!==null?o(!0):p.isTransition=!1,u(p),o=r.pending,o===null?(p.next=r.pending=p,Nu(r,p)):(p.next=o.next,r.pending=o.next=p)}}function Nu(e,r){var o=r.action,u=r.payload,f=e.state;if(r.isTransition){var p=R.T,E={};R.T=E;try{var x=o(f,u),M=R.S;M!==null&&M(E,x),Uu(e,r,x)}catch(Z){Xa(e,r,Z)}finally{R.T=p}}else try{p=o(f,u),Uu(e,r,p)}catch(Z){Xa(e,r,Z)}}function Uu(e,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){$u(e,r,u)},function(u){return Xa(e,r,u)}):$u(e,r,o)}function $u(e,r,o){r.status="fulfilled",r.value=o,Mu(r),e.state=o,r=e.pending,r!==null&&(o=r.next,o===r?e.pending=null:(o=o.next,r.next=o,Nu(e,o)))}function Xa(e,r,o){var u=e.pending;if(e.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=o,Mu(r),r=r.next;while(r!==u)}e.action=null}function Mu(e){e=e.listeners;for(var r=0;r<e.length;r++)(0,e[r])()}function Lu(e,r){return r}function Ou(e,r){if(ke){var o=Me.formState;if(o!==null){e:{var u=Ee;if(ke){if(De){t:{for(var f=De,p=Ut;f.nodeType!==8;){if(!p){f=null;break t}if(f=Bt(f.nextSibling),f===null){f=null;break t}}p=f.data,f=p==="F!"||p==="F"?f:null}if(f){De=Bt(f.nextSibling),u=f.data==="F!";break e}}$n(u)}u=!1}u&&(r=o[0])}}return o=rt(),o.memoizedState=o.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Lu,lastRenderedState:r},o.queue=u,o=tc.bind(null,Ee,u),u.dispatch=o,u=Za(!1),p=eo.bind(null,Ee,!1,u.queue),u=rt(),f={state:r,dispatch:null,action:e,pending:null},u.queue=f,o=Ld.bind(null,Ee,f,p,o),f.dispatch=o,u.memoizedState=e,[r,o,!1]}function Du(e){var r=Ve();return ju(r,Ce,e)}function ju(e,r,o){if(r=Ga(e,r,Lu)[0],e=is(Pt)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=er(r)}catch(E){throw E===Zi?Kr:E}else u=r;r=Ve();var f=r.queue,p=f.dispatch;return o!==r.memoizedState&&(Ee.flags|=2048,hi(9,rs(),Od.bind(null,f,o),null)),[u,p,e]}function Od(e,r){e.action=r}function Hu(e){var r=Ve(),o=Ce;if(o!==null)return ju(r,o,e);Ve(),r=r.memoizedState,o=Ve();var u=o.queue.dispatch;return o.memoizedState=e,[r,u,!1]}function hi(e,r,o,u){return e={tag:e,create:o,deps:u,inst:r,next:null},r=Ee.updateQueue,r===null&&(r=Pa(),Ee.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=e.next=e:(u=o.next,o.next=e,e.next=u,r.lastEffect=e),e}function rs(){return{destroy:void 0,resource:void 0}}function zu(){return Ve().memoizedState}function ss(e,r,o,u){var f=rt();u=u===void 0?null:u,Ee.flags|=e,f.memoizedState=hi(1|r,rs(),o,u)}function tr(e,r,o,u){var f=Ve();u=u===void 0?null:u;var p=f.memoizedState.inst;Ce!==null&&u!==null&&Ha(u,Ce.memoizedState.deps)?f.memoizedState=hi(r,p,o,u):(Ee.flags|=e,f.memoizedState=hi(1|r,p,o,u))}function qu(e,r){ss(8390656,8,e,r)}function Vu(e,r){tr(2048,8,e,r)}function Iu(e,r){return tr(4,2,e,r)}function Pu(e,r){return tr(4,4,e,r)}function Fu(e,r){if(typeof r=="function"){e=e();var o=r(e);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function Gu(e,r,o){o=o!=null?o.concat([e]):null,tr(4,4,Fu.bind(null,r,e),o)}function Qa(){}function Yu(e,r){var o=Ve();r=r===void 0?null:r;var u=o.memoizedState;return r!==null&&Ha(r,u[1])?u[0]:(o.memoizedState=[e,r],e)}function Zu(e,r){var o=Ve();r=r===void 0?null:r;var u=o.memoizedState;if(r!==null&&Ha(r,u[1]))return u[0];if(u=e(),Dn){Jt(!0);try{e()}finally{Jt(!1)}}return o.memoizedState=[u,r],u}function Ka(e,r,o){return o===void 0||(on&1073741824)!==0?e.memoizedState=r:(e.memoizedState=o,e=Kc(),Ee.lanes|=e,pn|=e,o)}function Xu(e,r,o,u){return ft(o,r)?o:ui.current!==null?(e=Ka(e,o,u),ft(e,r)||(Ge=!0),e):(on&42)===0?(Ge=!0,e.memoizedState=o):(e=Kc(),Ee.lanes|=e,pn|=e,r)}function Qu(e,r,o,u,f){var p=U.p;U.p=p!==0&&8>p?p:8;var E=R.T,x={};R.T=x,eo(e,!1,r,o);try{var M=f(),Z=R.S;if(Z!==null&&Z(x,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var ne=Ud(M,u);nr(e,r,ne,gt(e))}else nr(e,r,u,gt(e))}catch(ae){nr(e,r,{then:function(){},status:"rejected",reason:ae},gt())}finally{U.p=p,R.T=E}}function Dd(){}function Wa(e,r,o,u){if(e.tag!==5)throw Error(a(476));var f=Ku(e).queue;Qu(e,f,r,Y,o===null?Dd:function(){return Wu(e),o(u)})}function Ku(e){var r=e.memoizedState;if(r!==null)return r;r={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pt,lastRenderedState:Y},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pt,lastRenderedState:o},next:null},e.memoizedState=r,e=e.alternate,e!==null&&(e.memoizedState=r),r}function Wu(e){var r=Ku(e).next.queue;nr(e,r,{},gt())}function Ja(){return et(Er)}function Ju(){return Ve().memoizedState}function ec(){return Ve().memoizedState}function jd(e){for(var r=e.return;r!==null;){switch(r.tag){case 24:case 3:var o=gt();e=sn(o);var u=an(r,e,o);u!==null&&(mt(u,r,o),Qi(u,r,o)),r={cache:Ca()},e.payload=r;return}r=r.return}}function Hd(e,r,o){var u=gt();o={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},as(e)?nc(r,o):(o=ba(e,r,o,u),o!==null&&(mt(o,e,u),ic(o,r,u)))}function tc(e,r,o){var u=gt();nr(e,r,o,u)}function nr(e,r,o,u){var f={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(as(e))nc(r,f);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var E=r.lastRenderedState,x=p(E,o);if(f.hasEagerState=!0,f.eagerState=x,ft(x,E))return Ir(e,r,f,0),Me===null&&Vr(),!1}catch{}finally{}if(o=ba(e,r,f,u),o!==null)return mt(o,e,u),ic(o,r,u),!0}return!1}function eo(e,r,o,u){if(u={lane:2,revertLane:$o(),action:u,hasEagerState:!1,eagerState:null,next:null},as(e)){if(r)throw Error(a(479))}else r=ba(e,o,u,2),r!==null&&mt(r,e,2)}function as(e){var r=e.alternate;return e===Ee||r!==null&&r===Ee}function nc(e,r){ci=es=!0;var o=e.pending;o===null?r.next=r:(r.next=o.next,o.next=r),e.pending=r}function ic(e,r,o){if((o&4194048)!==0){var u=r.lanes;u&=e.pendingLanes,o|=u,r.lanes=o,fl(e,o)}}var os={readContext:et,use:ns,useCallback:He,useContext:He,useEffect:He,useImperativeHandle:He,useLayoutEffect:He,useInsertionEffect:He,useMemo:He,useReducer:He,useRef:He,useState:He,useDebugValue:He,useDeferredValue:He,useTransition:He,useSyncExternalStore:He,useId:He,useHostTransitionStatus:He,useFormState:He,useActionState:He,useOptimistic:He,useMemoCache:He,useCacheRefresh:He},rc={readContext:et,use:ns,useCallback:function(e,r){return rt().memoizedState=[e,r===void 0?null:r],e},useContext:et,useEffect:qu,useImperativeHandle:function(e,r,o){o=o!=null?o.concat([e]):null,ss(4194308,4,Fu.bind(null,r,e),o)},useLayoutEffect:function(e,r){return ss(4194308,4,e,r)},useInsertionEffect:function(e,r){ss(4,2,e,r)},useMemo:function(e,r){var o=rt();r=r===void 0?null:r;var u=e();if(Dn){Jt(!0);try{e()}finally{Jt(!1)}}return o.memoizedState=[u,r],u},useReducer:function(e,r,o){var u=rt();if(o!==void 0){var f=o(r);if(Dn){Jt(!0);try{o(r)}finally{Jt(!1)}}}else f=r;return u.memoizedState=u.baseState=f,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:f},u.queue=e,e=e.dispatch=Hd.bind(null,Ee,e),[u.memoizedState,e]},useRef:function(e){var r=rt();return e={current:e},r.memoizedState=e},useState:function(e){e=Za(e);var r=e.queue,o=tc.bind(null,Ee,r);return r.dispatch=o,[e.memoizedState,o]},useDebugValue:Qa,useDeferredValue:function(e,r){var o=rt();return Ka(o,e,r)},useTransition:function(){var e=Za(!1);return e=Qu.bind(null,Ee,e.queue,!0,!1),rt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,r,o){var u=Ee,f=rt();if(ke){if(o===void 0)throw Error(a(407));o=o()}else{if(o=r(),Me===null)throw Error(a(349));(Se&124)!==0||_u(u,r,o)}f.memoizedState=o;var p={value:o,getSnapshot:r};return f.queue=p,qu(Tu.bind(null,u,p,e),[e]),u.flags|=2048,hi(9,rs(),ku.bind(null,u,p,o,r),null),o},useId:function(){var e=rt(),r=Me.identifierPrefix;if(ke){var o=qt,u=zt;o=(u&~(1<<32-ct(u)-1)).toString(32)+o,r="«"+r+"R"+o,o=ts++,0<o&&(r+="H"+o.toString(32)),r+="»"}else o=$d++,r="«"+r+"r"+o.toString(32)+"»";return e.memoizedState=r},useHostTransitionStatus:Ja,useFormState:Ou,useActionState:Ou,useOptimistic:function(e){var r=rt();r.memoizedState=r.baseState=e;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=eo.bind(null,Ee,!0,o),o.dispatch=r,[e,r]},useMemoCache:Fa,useCacheRefresh:function(){return rt().memoizedState=jd.bind(null,Ee)}},sc={readContext:et,use:ns,useCallback:Yu,useContext:et,useEffect:Vu,useImperativeHandle:Gu,useInsertionEffect:Iu,useLayoutEffect:Pu,useMemo:Zu,useReducer:is,useRef:zu,useState:function(){return is(Pt)},useDebugValue:Qa,useDeferredValue:function(e,r){var o=Ve();return Xu(o,Ce.memoizedState,e,r)},useTransition:function(){var e=is(Pt)[0],r=Ve().memoizedState;return[typeof e=="boolean"?e:er(e),r]},useSyncExternalStore:Su,useId:Ju,useHostTransitionStatus:Ja,useFormState:Du,useActionState:Du,useOptimistic:function(e,r){var o=Ve();return Bu(o,Ce,e,r)},useMemoCache:Fa,useCacheRefresh:ec},zd={readContext:et,use:ns,useCallback:Yu,useContext:et,useEffect:Vu,useImperativeHandle:Gu,useInsertionEffect:Iu,useLayoutEffect:Pu,useMemo:Zu,useReducer:Ya,useRef:zu,useState:function(){return Ya(Pt)},useDebugValue:Qa,useDeferredValue:function(e,r){var o=Ve();return Ce===null?Ka(o,e,r):Xu(o,Ce.memoizedState,e,r)},useTransition:function(){var e=Ya(Pt)[0],r=Ve().memoizedState;return[typeof e=="boolean"?e:er(e),r]},useSyncExternalStore:Su,useId:Ju,useHostTransitionStatus:Ja,useFormState:Hu,useActionState:Hu,useOptimistic:function(e,r){var o=Ve();return Ce!==null?Bu(o,Ce,e,r):(o.baseState=e,[e,o.queue.dispatch])},useMemoCache:Fa,useCacheRefresh:ec},di=null,ir=0;function ls(e){var r=ir;return ir+=1,di===null&&(di=[]),gu(di,e,r)}function rr(e,r){r=r.props.ref,e.ref=r!==void 0?r:null}function us(e,r){throw r.$$typeof===v?Error(a(525)):(e=Object.prototype.toString.call(r),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e)))}function ac(e){var r=e._init;return r(e._payload)}function oc(e){function r(P,q){if(e){var F=P.deletions;F===null?(P.deletions=[q],P.flags|=16):F.push(q)}}function o(P,q){if(!e)return null;for(;q!==null;)r(P,q),q=q.sibling;return null}function u(P){for(var q=new Map;P!==null;)P.key!==null?q.set(P.key,P):q.set(P.index,P),P=P.sibling;return q}function f(P,q){return P=Ht(P,q),P.index=0,P.sibling=null,P}function p(P,q,F){return P.index=F,e?(F=P.alternate,F!==null?(F=F.index,F<q?(P.flags|=67108866,q):F):(P.flags|=67108866,q)):(P.flags|=1048576,q)}function E(P){return e&&P.alternate===null&&(P.flags|=67108866),P}function x(P,q,F,se){return q===null||q.tag!==6?(q=Ea(F,P.mode,se),q.return=P,q):(q=f(q,F),q.return=P,q)}function M(P,q,F,se){var ce=F.type;return ce===A?ne(P,q,F.props.children,se,F.key):q!==null&&(q.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===I&&ac(ce)===q.type)?(q=f(q,F.props),rr(q,F),q.return=P,q):(q=Fr(F.type,F.key,F.props,null,P.mode,se),rr(q,F),q.return=P,q)}function Z(P,q,F,se){return q===null||q.tag!==4||q.stateNode.containerInfo!==F.containerInfo||q.stateNode.implementation!==F.implementation?(q=wa(F,P.mode,se),q.return=P,q):(q=f(q,F.children||[]),q.return=P,q)}function ne(P,q,F,se,ce){return q===null||q.tag!==7?(q=Cn(F,P.mode,se,ce),q.return=P,q):(q=f(q,F),q.return=P,q)}function ae(P,q,F){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=Ea(""+q,P.mode,F),q.return=P,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case w:return F=Fr(q.type,q.key,q.props,null,P.mode,F),rr(F,q),F.return=P,F;case S:return q=wa(q,P.mode,F),q.return=P,q;case I:var se=q._init;return q=se(q._payload),ae(P,q,F)}if(_(q)||z(q))return q=Cn(q,P.mode,F,null),q.return=P,q;if(typeof q.then=="function")return ae(P,ls(q),F);if(q.$$typeof===V)return ae(P,Xr(P,q),F);us(P,q)}return null}function K(P,q,F,se){var ce=q!==null?q.key:null;if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return ce!==null?null:x(P,q,""+F,se);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case w:return F.key===ce?M(P,q,F,se):null;case S:return F.key===ce?Z(P,q,F,se):null;case I:return ce=F._init,F=ce(F._payload),K(P,q,F,se)}if(_(F)||z(F))return ce!==null?null:ne(P,q,F,se,null);if(typeof F.then=="function")return K(P,q,ls(F),se);if(F.$$typeof===V)return K(P,q,Xr(P,F),se);us(P,F)}return null}function W(P,q,F,se,ce){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return P=P.get(F)||null,x(q,P,""+se,ce);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case w:return P=P.get(se.key===null?F:se.key)||null,M(q,P,se,ce);case S:return P=P.get(se.key===null?F:se.key)||null,Z(q,P,se,ce);case I:var we=se._init;return se=we(se._payload),W(P,q,F,se,ce)}if(_(se)||z(se))return P=P.get(F)||null,ne(q,P,se,ce,null);if(typeof se.then=="function")return W(P,q,F,ls(se),ce);if(se.$$typeof===V)return W(P,q,F,Xr(q,se),ce);us(q,se)}return null}function ye(P,q,F,se){for(var ce=null,we=null,he=q,pe=q=0,Ze=null;he!==null&&pe<F.length;pe++){he.index>pe?(Ze=he,he=null):Ze=he.sibling;var _e=K(P,he,F[pe],se);if(_e===null){he===null&&(he=Ze);break}e&&he&&_e.alternate===null&&r(P,he),q=p(_e,q,pe),we===null?ce=_e:we.sibling=_e,we=_e,he=Ze}if(pe===F.length)return o(P,he),ke&&Nn(P,pe),ce;if(he===null){for(;pe<F.length;pe++)he=ae(P,F[pe],se),he!==null&&(q=p(he,q,pe),we===null?ce=he:we.sibling=he,we=he);return ke&&Nn(P,pe),ce}for(he=u(he);pe<F.length;pe++)Ze=W(he,P,pe,F[pe],se),Ze!==null&&(e&&Ze.alternate!==null&&he.delete(Ze.key===null?pe:Ze.key),q=p(Ze,q,pe),we===null?ce=Ze:we.sibling=Ze,we=Ze);return e&&he.forEach(function(Rn){return r(P,Rn)}),ke&&Nn(P,pe),ce}function de(P,q,F,se){if(F==null)throw Error(a(151));for(var ce=null,we=null,he=q,pe=q=0,Ze=null,_e=F.next();he!==null&&!_e.done;pe++,_e=F.next()){he.index>pe?(Ze=he,he=null):Ze=he.sibling;var Rn=K(P,he,_e.value,se);if(Rn===null){he===null&&(he=Ze);break}e&&he&&Rn.alternate===null&&r(P,he),q=p(Rn,q,pe),we===null?ce=Rn:we.sibling=Rn,we=Rn,he=Ze}if(_e.done)return o(P,he),ke&&Nn(P,pe),ce;if(he===null){for(;!_e.done;pe++,_e=F.next())_e=ae(P,_e.value,se),_e!==null&&(q=p(_e,q,pe),we===null?ce=_e:we.sibling=_e,we=_e);return ke&&Nn(P,pe),ce}for(he=u(he);!_e.done;pe++,_e=F.next())_e=W(he,P,pe,_e.value,se),_e!==null&&(e&&_e.alternate!==null&&he.delete(_e.key===null?pe:_e.key),q=p(_e,q,pe),we===null?ce=_e:we.sibling=_e,we=_e);return e&&he.forEach(function(qp){return r(P,qp)}),ke&&Nn(P,pe),ce}function Ne(P,q,F,se){if(typeof F=="object"&&F!==null&&F.type===A&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case w:e:{for(var ce=F.key;q!==null;){if(q.key===ce){if(ce=F.type,ce===A){if(q.tag===7){o(P,q.sibling),se=f(q,F.props.children),se.return=P,P=se;break e}}else if(q.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===I&&ac(ce)===q.type){o(P,q.sibling),se=f(q,F.props),rr(se,F),se.return=P,P=se;break e}o(P,q);break}else r(P,q);q=q.sibling}F.type===A?(se=Cn(F.props.children,P.mode,se,F.key),se.return=P,P=se):(se=Fr(F.type,F.key,F.props,null,P.mode,se),rr(se,F),se.return=P,P=se)}return E(P);case S:e:{for(ce=F.key;q!==null;){if(q.key===ce)if(q.tag===4&&q.stateNode.containerInfo===F.containerInfo&&q.stateNode.implementation===F.implementation){o(P,q.sibling),se=f(q,F.children||[]),se.return=P,P=se;break e}else{o(P,q);break}else r(P,q);q=q.sibling}se=wa(F,P.mode,se),se.return=P,P=se}return E(P);case I:return ce=F._init,F=ce(F._payload),Ne(P,q,F,se)}if(_(F))return ye(P,q,F,se);if(z(F)){if(ce=z(F),typeof ce!="function")throw Error(a(150));return F=ce.call(F),de(P,q,F,se)}if(typeof F.then=="function")return Ne(P,q,ls(F),se);if(F.$$typeof===V)return Ne(P,q,Xr(P,F),se);us(P,F)}return typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint"?(F=""+F,q!==null&&q.tag===6?(o(P,q.sibling),se=f(q,F),se.return=P,P=se):(o(P,q),se=Ea(F,P.mode,se),se.return=P,P=se),E(P)):o(P,q)}return function(P,q,F,se){try{ir=0;var ce=Ne(P,q,F,se);return di=null,ce}catch(he){if(he===Zi||he===Kr)throw he;var we=ht(29,he,null,P.mode);return we.lanes=se,we.return=P,we}finally{}}}var pi=oc(!0),lc=oc(!1),_t=D(null),$t=null;function ln(e){var r=e.alternate;re(Pe,Pe.current&1),re(_t,e),$t===null&&(r===null||ui.current!==null||r.memoizedState!==null)&&($t=e)}function uc(e){if(e.tag===22){if(re(Pe,Pe.current),re(_t,e),$t===null){var r=e.alternate;r!==null&&r.memoizedState!==null&&($t=e)}}else un()}function un(){re(Pe,Pe.current),re(_t,_t.current)}function Ft(e){Q(_t),$t===e&&($t=null),Q(Pe)}var Pe=D(0);function cs(e){for(var r=e;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||Fo(o)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function to(e,r,o,u){r=e.memoizedState,o=o(u,r),o=o==null?r:b({},r,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var no={enqueueSetState:function(e,r,o){e=e._reactInternals;var u=gt(),f=sn(u);f.payload=r,o!=null&&(f.callback=o),r=an(e,f,u),r!==null&&(mt(r,e,u),Qi(r,e,u))},enqueueReplaceState:function(e,r,o){e=e._reactInternals;var u=gt(),f=sn(u);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=an(e,f,u),r!==null&&(mt(r,e,u),Qi(r,e,u))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var o=gt(),u=sn(o);u.tag=2,r!=null&&(u.callback=r),r=an(e,u,o),r!==null&&(mt(r,e,o),Qi(r,e,o))}};function cc(e,r,o,u,f,p,E){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,p,E):r.prototype&&r.prototype.isPureReactComponent?!zi(o,u)||!zi(f,p):!0}function fc(e,r,o,u){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,u),r.state!==e&&no.enqueueReplaceState(r,r.state,null)}function jn(e,r){var o=r;if("ref"in r){o={};for(var u in r)u!=="ref"&&(o[u]=r[u])}if(e=e.defaultProps){o===r&&(o=b({},o));for(var f in e)o[f]===void 0&&(o[f]=e[f])}return o}var fs=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function hc(e){fs(e)}function dc(e){console.error(e)}function pc(e){fs(e)}function hs(e,r){try{var o=e.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function yc(e,r,o){try{var u=e.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function io(e,r,o){return o=sn(o),o.tag=3,o.payload={element:null},o.callback=function(){hs(e,r)},o}function gc(e){return e=sn(e),e.tag=3,e}function mc(e,r,o,u){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var p=u.value;e.payload=function(){return f(p)},e.callback=function(){yc(r,o,u)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(e.callback=function(){yc(r,o,u),typeof f!="function"&&(yn===null?yn=new Set([this]):yn.add(this));var x=u.stack;this.componentDidCatch(u.value,{componentStack:x!==null?x:""})})}function qd(e,r,o,u,f){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=o.alternate,r!==null&&Fi(r,o,f,!0),o=_t.current,o!==null){switch(o.tag){case 13:return $t===null?Ao():o.alternate===null&&je===0&&(je=3),o.flags&=-257,o.flags|=65536,o.lanes=f,u===Ua?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([u]):r.add(u),Bo(e,u,f)),!1;case 22:return o.flags|=65536,u===Ua?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([u]):o.add(u)),Bo(e,u,f)),!1}throw Error(a(435,o.tag))}return Bo(e,u,f),Ao(),!1}if(ke)return r=_t.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,u!==Sa&&(e=Error(a(422),{cause:u}),Pi(wt(e,o)))):(u!==Sa&&(r=Error(a(423),{cause:u}),Pi(wt(r,o))),e=e.current.alternate,e.flags|=65536,f&=-f,e.lanes|=f,u=wt(u,o),f=io(e.stateNode,u,f),La(e,f),je!==4&&(je=2)),!1;var p=Error(a(520),{cause:u});if(p=wt(p,o),fr===null?fr=[p]:fr.push(p),je!==4&&(je=2),r===null)return!0;u=wt(u,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,e=f&-f,o.lanes|=e,e=io(o.stateNode,u,e),La(o,e),!1;case 1:if(r=o.type,p=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(yn===null||!yn.has(p))))return o.flags|=65536,f&=-f,o.lanes|=f,f=gc(f),mc(f,e,o,u),La(o,f),!1}o=o.return}while(o!==null);return!1}var bc=Error(a(461)),Ge=!1;function Qe(e,r,o,u){r.child=e===null?lc(r,null,o,u):pi(r,e.child,o,u)}function vc(e,r,o,u,f){o=o.render;var p=r.ref;if("ref"in u){var E={};for(var x in u)x!=="ref"&&(E[x]=u[x])}else E=u;return Ln(r),u=za(e,r,o,E,p,f),x=qa(),e!==null&&!Ge?(Va(e,r,f),Gt(e,r,f)):(ke&&x&&xa(r),r.flags|=1,Qe(e,r,u,f),r.child)}function Ec(e,r,o,u,f){if(e===null){var p=o.type;return typeof p=="function"&&!va(p)&&p.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=p,wc(e,r,p,u,f)):(e=Fr(o.type,null,u,r,r.mode,f),e.ref=r.ref,e.return=r,r.child=e)}if(p=e.child,!fo(e,f)){var E=p.memoizedProps;if(o=o.compare,o=o!==null?o:zi,o(E,u)&&e.ref===r.ref)return Gt(e,r,f)}return r.flags|=1,e=Ht(p,u),e.ref=r.ref,e.return=r,r.child=e}function wc(e,r,o,u,f){if(e!==null){var p=e.memoizedProps;if(zi(p,u)&&e.ref===r.ref)if(Ge=!1,r.pendingProps=u=p,fo(e,f))(e.flags&131072)!==0&&(Ge=!0);else return r.lanes=e.lanes,Gt(e,r,f)}return ro(e,r,o,u,f)}function xc(e,r,o){var u=r.pendingProps,f=u.children,p=e!==null?e.memoizedState:null;if(u.mode==="hidden"){if((r.flags&128)!==0){if(u=p!==null?p.baseLanes|o:o,e!==null){for(f=r.child=e.child,p=0;f!==null;)p=p|f.lanes|f.childLanes,f=f.sibling;r.childLanes=p&~u}else r.childLanes=0,r.child=null;return Rc(e,r,u,o)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},e!==null&&Qr(r,p!==null?p.cachePool:null),p!==null?wu(r,p):Da(),uc(r);else return r.lanes=r.childLanes=536870912,Rc(e,r,p!==null?p.baseLanes|o:o,o)}else p!==null?(Qr(r,p.cachePool),wu(r,p),un(),r.memoizedState=null):(e!==null&&Qr(r,null),Da(),un());return Qe(e,r,f,o),r.child}function Rc(e,r,o,u){var f=Na();return f=f===null?null:{parent:Ie._currentValue,pool:f},r.memoizedState={baseLanes:o,cachePool:f},e!==null&&Qr(r,null),Da(),uc(r),e!==null&&Fi(e,r,u,!0),null}function ds(e,r){var o=r.ref;if(o===null)e!==null&&e.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(a(284));(e===null||e.ref!==o)&&(r.flags|=4194816)}}function ro(e,r,o,u,f){return Ln(r),o=za(e,r,o,u,void 0,f),u=qa(),e!==null&&!Ge?(Va(e,r,f),Gt(e,r,f)):(ke&&u&&xa(r),r.flags|=1,Qe(e,r,o,f),r.child)}function Sc(e,r,o,u,f,p){return Ln(r),r.updateQueue=null,o=Ru(r,u,o,f),xu(e),u=qa(),e!==null&&!Ge?(Va(e,r,p),Gt(e,r,p)):(ke&&u&&xa(r),r.flags|=1,Qe(e,r,o,p),r.child)}function _c(e,r,o,u,f){if(Ln(r),r.stateNode===null){var p=ri,E=o.contextType;typeof E=="object"&&E!==null&&(p=et(E)),p=new o(u,p),r.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=no,r.stateNode=p,p._reactInternals=r,p=r.stateNode,p.props=u,p.state=r.memoizedState,p.refs={},$a(r),E=o.contextType,p.context=typeof E=="object"&&E!==null?et(E):ri,p.state=r.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(to(r,o,E,u),p.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(E=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),E!==p.state&&no.enqueueReplaceState(p,p.state,null),Wi(r,u,p,f),Ki(),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(e===null){p=r.stateNode;var x=r.memoizedProps,M=jn(o,x);p.props=M;var Z=p.context,ne=o.contextType;E=ri,typeof ne=="object"&&ne!==null&&(E=et(ne));var ae=o.getDerivedStateFromProps;ne=typeof ae=="function"||typeof p.getSnapshotBeforeUpdate=="function",x=r.pendingProps!==x,ne||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(x||Z!==E)&&fc(r,p,u,E),rn=!1;var K=r.memoizedState;p.state=K,Wi(r,u,p,f),Ki(),Z=r.memoizedState,x||K!==Z||rn?(typeof ae=="function"&&(to(r,o,ae,u),Z=r.memoizedState),(M=rn||cc(r,o,M,u,K,Z,E))?(ne||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(r.flags|=4194308)):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=Z),p.props=u,p.state=Z,p.context=E,u=M):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{p=r.stateNode,Ma(e,r),E=r.memoizedProps,ne=jn(o,E),p.props=ne,ae=r.pendingProps,K=p.context,Z=o.contextType,M=ri,typeof Z=="object"&&Z!==null&&(M=et(Z)),x=o.getDerivedStateFromProps,(Z=typeof x=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(E!==ae||K!==M)&&fc(r,p,u,M),rn=!1,K=r.memoizedState,p.state=K,Wi(r,u,p,f),Ki();var W=r.memoizedState;E!==ae||K!==W||rn||e!==null&&e.dependencies!==null&&Zr(e.dependencies)?(typeof x=="function"&&(to(r,o,x,u),W=r.memoizedState),(ne=rn||cc(r,o,ne,u,K,W,M)||e!==null&&e.dependencies!==null&&Zr(e.dependencies))?(Z||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,W,M),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,W,M)),typeof p.componentDidUpdate=="function"&&(r.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof p.componentDidUpdate!="function"||E===e.memoizedProps&&K===e.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&K===e.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=W),p.props=u,p.state=W,p.context=M,u=ne):(typeof p.componentDidUpdate!="function"||E===e.memoizedProps&&K===e.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&K===e.memoizedState||(r.flags|=1024),u=!1)}return p=u,ds(e,r),u=(r.flags&128)!==0,p||u?(p=r.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:p.render(),r.flags|=1,e!==null&&u?(r.child=pi(r,e.child,null,f),r.child=pi(r,null,o,f)):Qe(e,r,o,f),r.memoizedState=p.state,e=r.child):e=Gt(e,r,f),e}function kc(e,r,o,u){return Ii(),r.flags|=256,Qe(e,r,o,u),r.child}var so={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ao(e){return{baseLanes:e,cachePool:du()}}function oo(e,r,o){return e=e!==null?e.childLanes&~o:0,r&&(e|=kt),e}function Tc(e,r,o){var u=r.pendingProps,f=!1,p=(r.flags&128)!==0,E;if((E=p)||(E=e!==null&&e.memoizedState===null?!1:(Pe.current&2)!==0),E&&(f=!0,r.flags&=-129),E=(r.flags&32)!==0,r.flags&=-33,e===null){if(ke){if(f?ln(r):un(),ke){var x=De,M;if(M=x){e:{for(M=x,x=Ut;M.nodeType!==8;){if(!x){x=null;break e}if(M=Bt(M.nextSibling),M===null){x=null;break e}}x=M}x!==null?(r.memoizedState={dehydrated:x,treeContext:Bn!==null?{id:zt,overflow:qt}:null,retryLane:536870912,hydrationErrors:null},M=ht(18,null,null,0),M.stateNode=x,M.return=r,r.child=M,tt=r,De=null,M=!0):M=!1}M||$n(r)}if(x=r.memoizedState,x!==null&&(x=x.dehydrated,x!==null))return Fo(x)?r.lanes=32:r.lanes=536870912,null;Ft(r)}return x=u.children,u=u.fallback,f?(un(),f=r.mode,x=ps({mode:"hidden",children:x},f),u=Cn(u,f,o,null),x.return=r,u.return=r,x.sibling=u,r.child=x,f=r.child,f.memoizedState=ao(o),f.childLanes=oo(e,E,o),r.memoizedState=so,u):(ln(r),lo(r,x))}if(M=e.memoizedState,M!==null&&(x=M.dehydrated,x!==null)){if(p)r.flags&256?(ln(r),r.flags&=-257,r=uo(e,r,o)):r.memoizedState!==null?(un(),r.child=e.child,r.flags|=128,r=null):(un(),f=u.fallback,x=r.mode,u=ps({mode:"visible",children:u.children},x),f=Cn(f,x,o,null),f.flags|=2,u.return=r,f.return=r,u.sibling=f,r.child=u,pi(r,e.child,null,o),u=r.child,u.memoizedState=ao(o),u.childLanes=oo(e,E,o),r.memoizedState=so,r=f);else if(ln(r),Fo(x)){if(E=x.nextSibling&&x.nextSibling.dataset,E)var Z=E.dgst;E=Z,u=Error(a(419)),u.stack="",u.digest=E,Pi({value:u,source:null,stack:null}),r=uo(e,r,o)}else if(Ge||Fi(e,r,o,!1),E=(o&e.childLanes)!==0,Ge||E){if(E=Me,E!==null&&(u=o&-o,u=(u&42)!==0?1:Ps(u),u=(u&(E.suspendedLanes|o))!==0?0:u,u!==0&&u!==M.retryLane))throw M.retryLane=u,ii(e,u),mt(E,e,u),bc;x.data==="$?"||Ao(),r=uo(e,r,o)}else x.data==="$?"?(r.flags|=192,r.child=e.child,r=null):(e=M.treeContext,De=Bt(x.nextSibling),tt=r,ke=!0,Un=null,Ut=!1,e!==null&&(Rt[St++]=zt,Rt[St++]=qt,Rt[St++]=Bn,zt=e.id,qt=e.overflow,Bn=r),r=lo(r,u.children),r.flags|=4096);return r}return f?(un(),f=u.fallback,x=r.mode,M=e.child,Z=M.sibling,u=Ht(M,{mode:"hidden",children:u.children}),u.subtreeFlags=M.subtreeFlags&65011712,Z!==null?f=Ht(Z,f):(f=Cn(f,x,o,null),f.flags|=2),f.return=r,u.return=r,u.sibling=f,r.child=u,u=f,f=r.child,x=e.child.memoizedState,x===null?x=ao(o):(M=x.cachePool,M!==null?(Z=Ie._currentValue,M=M.parent!==Z?{parent:Z,pool:Z}:M):M=du(),x={baseLanes:x.baseLanes|o,cachePool:M}),f.memoizedState=x,f.childLanes=oo(e,E,o),r.memoizedState=so,u):(ln(r),o=e.child,e=o.sibling,o=Ht(o,{mode:"visible",children:u.children}),o.return=r,o.sibling=null,e!==null&&(E=r.deletions,E===null?(r.deletions=[e],r.flags|=16):E.push(e)),r.child=o,r.memoizedState=null,o)}function lo(e,r){return r=ps({mode:"visible",children:r},e.mode),r.return=e,e.child=r}function ps(e,r){return e=ht(22,e,null,r),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function uo(e,r,o){return pi(r,e.child,null,o),e=lo(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function Ac(e,r,o){e.lanes|=r;var u=e.alternate;u!==null&&(u.lanes|=r),Ta(e.return,r,o)}function co(e,r,o,u,f){var p=e.memoizedState;p===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:f}:(p.isBackwards=r,p.rendering=null,p.renderingStartTime=0,p.last=u,p.tail=o,p.tailMode=f)}function Cc(e,r,o){var u=r.pendingProps,f=u.revealOrder,p=u.tail;if(Qe(e,r,u.children,o),u=Pe.current,(u&2)!==0)u=u&1|2,r.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ac(e,o,r);else if(e.tag===19)Ac(e,o,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}u&=1}switch(re(Pe,u),f){case"forwards":for(o=r.child,f=null;o!==null;)e=o.alternate,e!==null&&cs(e)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),co(r,!1,f,o,p);break;case"backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(e=f.alternate,e!==null&&cs(e)===null){r.child=f;break}e=f.sibling,f.sibling=o,o=f,f=e}co(r,!0,o,null,p);break;case"together":co(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Gt(e,r,o){if(e!==null&&(r.dependencies=e.dependencies),pn|=r.lanes,(o&r.childLanes)===0)if(e!==null){if(Fi(e,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(e!==null&&r.child!==e.child)throw Error(a(153));if(r.child!==null){for(e=r.child,o=Ht(e,e.pendingProps),r.child=o,o.return=r;e.sibling!==null;)e=e.sibling,o=o.sibling=Ht(e,e.pendingProps),o.return=r;o.sibling=null}return r.child}function fo(e,r){return(e.lanes&r)!==0?!0:(e=e.dependencies,!!(e!==null&&Zr(e)))}function Vd(e,r,o){switch(r.tag){case 3:be(r,r.stateNode.containerInfo),nn(r,Ie,e.memoizedState.cache),Ii();break;case 27:case 5:Ue(r);break;case 4:be(r,r.stateNode.containerInfo);break;case 10:nn(r,r.type,r.memoizedProps.value);break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(ln(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Tc(e,r,o):(ln(r),e=Gt(e,r,o),e!==null?e.sibling:null);ln(r);break;case 19:var f=(e.flags&128)!==0;if(u=(o&r.childLanes)!==0,u||(Fi(e,r,o,!1),u=(o&r.childLanes)!==0),f){if(u)return Cc(e,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),re(Pe,Pe.current),u)break;return null;case 22:case 23:return r.lanes=0,xc(e,r,o);case 24:nn(r,Ie,e.memoizedState.cache)}return Gt(e,r,o)}function Bc(e,r,o){if(e!==null)if(e.memoizedProps!==r.pendingProps)Ge=!0;else{if(!fo(e,o)&&(r.flags&128)===0)return Ge=!1,Vd(e,r,o);Ge=(e.flags&131072)!==0}else Ge=!1,ke&&(r.flags&1048576)!==0&&au(r,Yr,r.index);switch(r.lanes=0,r.tag){case 16:e:{e=r.pendingProps;var u=r.elementType,f=u._init;if(u=f(u._payload),r.type=u,typeof u=="function")va(u)?(e=jn(u,e),r.tag=1,r=_c(null,r,u,e,o)):(r.tag=0,r=ro(null,r,u,e,o));else{if(u!=null){if(f=u.$$typeof,f===ie){r.tag=11,r=vc(null,r,u,e,o);break e}else if(f===j){r.tag=14,r=Ec(null,r,u,e,o);break e}}throw r=O(u)||u,Error(a(306,r,""))}}return r;case 0:return ro(e,r,r.type,r.pendingProps,o);case 1:return u=r.type,f=jn(u,r.pendingProps),_c(e,r,u,f,o);case 3:e:{if(be(r,r.stateNode.containerInfo),e===null)throw Error(a(387));u=r.pendingProps;var p=r.memoizedState;f=p.element,Ma(e,r),Wi(r,u,null,o);var E=r.memoizedState;if(u=E.cache,nn(r,Ie,u),u!==p.cache&&Aa(r,[Ie],o,!0),Ki(),u=E.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:E.cache},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){r=kc(e,r,u,o);break e}else if(u!==f){f=wt(Error(a(424)),r),Pi(f),r=kc(e,r,u,o);break e}else{switch(e=r.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(De=Bt(e.firstChild),tt=r,ke=!0,Un=null,Ut=!0,o=lc(r,null,u,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Ii(),u===f){r=Gt(e,r,o);break e}Qe(e,r,u,o)}r=r.child}return r;case 26:return ds(e,r),e===null?(o=Lf(r.type,null,r.pendingProps,null))?r.memoizedState=o:ke||(o=r.type,e=r.pendingProps,u=Cs(ue.current).createElement(o),u[Je]=r,u[nt]=e,We(u,o,e),Fe(u),r.stateNode=u):r.memoizedState=Lf(r.type,e.memoizedProps,r.pendingProps,e.memoizedState),null;case 27:return Ue(r),e===null&&ke&&(u=r.stateNode=Uf(r.type,r.pendingProps,ue.current),tt=r,Ut=!0,f=De,bn(r.type)?(Go=f,De=Bt(u.firstChild)):De=f),Qe(e,r,r.pendingProps.children,o),ds(e,r),e===null&&(r.flags|=4194304),r.child;case 5:return e===null&&ke&&((f=u=De)&&(u=gp(u,r.type,r.pendingProps,Ut),u!==null?(r.stateNode=u,tt=r,De=Bt(u.firstChild),Ut=!1,f=!0):f=!1),f||$n(r)),Ue(r),f=r.type,p=r.pendingProps,E=e!==null?e.memoizedProps:null,u=p.children,Vo(f,p)?u=null:E!==null&&Vo(f,E)&&(r.flags|=32),r.memoizedState!==null&&(f=za(e,r,Md,null,null,o),Er._currentValue=f),ds(e,r),Qe(e,r,u,o),r.child;case 6:return e===null&&ke&&((e=o=De)&&(o=mp(o,r.pendingProps,Ut),o!==null?(r.stateNode=o,tt=r,De=null,e=!0):e=!1),e||$n(r)),null;case 13:return Tc(e,r,o);case 4:return be(r,r.stateNode.containerInfo),u=r.pendingProps,e===null?r.child=pi(r,null,u,o):Qe(e,r,u,o),r.child;case 11:return vc(e,r,r.type,r.pendingProps,o);case 7:return Qe(e,r,r.pendingProps,o),r.child;case 8:return Qe(e,r,r.pendingProps.children,o),r.child;case 12:return Qe(e,r,r.pendingProps.children,o),r.child;case 10:return u=r.pendingProps,nn(r,r.type,u.value),Qe(e,r,u.children,o),r.child;case 9:return f=r.type._context,u=r.pendingProps.children,Ln(r),f=et(f),u=u(f),r.flags|=1,Qe(e,r,u,o),r.child;case 14:return Ec(e,r,r.type,r.pendingProps,o);case 15:return wc(e,r,r.type,r.pendingProps,o);case 19:return Cc(e,r,o);case 31:return u=r.pendingProps,o=r.mode,u={mode:u.mode,children:u.children},e===null?(o=ps(u,o),o.ref=r.ref,r.child=o,o.return=r,r=o):(o=Ht(e.child,u),o.ref=r.ref,r.child=o,o.return=r,r=o),r;case 22:return xc(e,r,o);case 24:return Ln(r),u=et(Ie),e===null?(f=Na(),f===null&&(f=Me,p=Ca(),f.pooledCache=p,p.refCount++,p!==null&&(f.pooledCacheLanes|=o),f=p),r.memoizedState={parent:u,cache:f},$a(r),nn(r,Ie,f)):((e.lanes&o)!==0&&(Ma(e,r),Wi(r,null,null,o),Ki()),f=e.memoizedState,p=r.memoizedState,f.parent!==u?(f={parent:u,cache:u},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),nn(r,Ie,u)):(u=p.cache,nn(r,Ie,u),u!==f.cache&&Aa(r,[Ie],o,!0))),Qe(e,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(a(156,r.tag))}function Yt(e){e.flags|=4}function Nc(e,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!zf(r)){if(r=_t.current,r!==null&&((Se&4194048)===Se?$t!==null:(Se&62914560)!==Se&&(Se&536870912)===0||r!==$t))throw Xi=Ua,pu;e.flags|=8192}}function ys(e,r){r!==null&&(e.flags|=4),e.flags&16384&&(r=e.tag!==22?ul():536870912,e.lanes|=r,bi|=r)}function sr(e,r){if(!ke)switch(e.tailMode){case"hidden":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function Oe(e){var r=e.alternate!==null&&e.alternate.child===e.child,o=0,u=0;if(r)for(var f=e.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=u,e.childLanes=o,r}function Id(e,r,o){var u=r.pendingProps;switch(Ra(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oe(r),null;case 1:return Oe(r),null;case 3:return o=r.stateNode,u=null,e!==null&&(u=e.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),It(Ie),ve(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(Vi(r)?Yt(r):e===null||e.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,uu())),Oe(r),null;case 26:return o=r.memoizedState,e===null?(Yt(r),o!==null?(Oe(r),Nc(r,o)):(Oe(r),r.flags&=-16777217)):o?o!==e.memoizedState?(Yt(r),Oe(r),Nc(r,o)):(Oe(r),r.flags&=-16777217):(e.memoizedProps!==u&&Yt(r),Oe(r),r.flags&=-16777217),null;case 27:bt(r),o=ue.current;var f=r.type;if(e!==null&&r.stateNode!=null)e.memoizedProps!==u&&Yt(r);else{if(!u){if(r.stateNode===null)throw Error(a(166));return Oe(r),null}e=oe.current,Vi(r)?ou(r):(e=Uf(f,u,o),r.stateNode=e,Yt(r))}return Oe(r),null;case 5:if(bt(r),o=r.type,e!==null&&r.stateNode!=null)e.memoizedProps!==u&&Yt(r);else{if(!u){if(r.stateNode===null)throw Error(a(166));return Oe(r),null}if(e=oe.current,Vi(r))ou(r);else{switch(f=Cs(ue.current),e){case 1:e=f.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:e=f.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":e=f.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":e=f.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof u.is=="string"?f.createElement("select",{is:u.is}):f.createElement("select"),u.multiple?e.multiple=!0:u.size&&(e.size=u.size);break;default:e=typeof u.is=="string"?f.createElement(o,{is:u.is}):f.createElement(o)}}e[Je]=r,e[nt]=u;e:for(f=r.child;f!==null;){if(f.tag===5||f.tag===6)e.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===r)break e;for(;f.sibling===null;){if(f.return===null||f.return===r)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}r.stateNode=e;e:switch(We(e,o,u),o){case"button":case"input":case"select":case"textarea":e=!!u.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Yt(r)}}return Oe(r),r.flags&=-16777217,null;case 6:if(e&&r.stateNode!=null)e.memoizedProps!==u&&Yt(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(a(166));if(e=ue.current,Vi(r)){if(e=r.stateNode,o=r.memoizedProps,u=null,f=tt,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}e[Je]=r,e=!!(e.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||_f(e.nodeValue,o)),e||$n(r)}else e=Cs(e).createTextNode(u),e[Je]=r,r.stateNode=e}return Oe(r),null;case 13:if(u=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(f=Vi(r),u!==null&&u.dehydrated!==null){if(e===null){if(!f)throw Error(a(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[Je]=r}else Ii(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Oe(r),f=!1}else f=uu(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Ft(r),r):(Ft(r),null)}if(Ft(r),(r.flags&128)!==0)return r.lanes=o,r;if(o=u!==null,e=e!==null&&e.memoizedState!==null,o){u=r.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool);var p=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==f&&(u.flags|=2048)}return o!==e&&o&&(r.child.flags|=8192),ys(r,r.updateQueue),Oe(r),null;case 4:return ve(),e===null&&Do(r.stateNode.containerInfo),Oe(r),null;case 10:return It(r.type),Oe(r),null;case 19:if(Q(Pe),f=r.memoizedState,f===null)return Oe(r),null;if(u=(r.flags&128)!==0,p=f.rendering,p===null)if(u)sr(f,!1);else{if(je!==0||e!==null&&(e.flags&128)!==0)for(e=r.child;e!==null;){if(p=cs(e),p!==null){for(r.flags|=128,sr(f,!1),e=p.updateQueue,r.updateQueue=e,ys(r,e),r.subtreeFlags=0,e=o,o=r.child;o!==null;)su(o,e),o=o.sibling;return re(Pe,Pe.current&1|2),r.child}e=e.sibling}f.tail!==null&&Nt()>vs&&(r.flags|=128,u=!0,sr(f,!1),r.lanes=4194304)}else{if(!u)if(e=cs(p),e!==null){if(r.flags|=128,u=!0,e=e.updateQueue,r.updateQueue=e,ys(r,e),sr(f,!0),f.tail===null&&f.tailMode==="hidden"&&!p.alternate&&!ke)return Oe(r),null}else 2*Nt()-f.renderingStartTime>vs&&o!==536870912&&(r.flags|=128,u=!0,sr(f,!1),r.lanes=4194304);f.isBackwards?(p.sibling=r.child,r.child=p):(e=f.last,e!==null?e.sibling=p:r.child=p,f.last=p)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=Nt(),r.sibling=null,e=Pe.current,re(Pe,u?e&1|2:e&1),r):(Oe(r),null);case 22:case 23:return Ft(r),ja(),u=r.memoizedState!==null,e!==null?e.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(o&536870912)!==0&&(r.flags&128)===0&&(Oe(r),r.subtreeFlags&6&&(r.flags|=8192)):Oe(r),o=r.updateQueue,o!==null&&ys(r,o.retryQueue),o=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(o=e.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==o&&(r.flags|=2048),e!==null&&Q(On),null;case 24:return o=null,e!==null&&(o=e.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),It(Ie),Oe(r),null;case 25:return null;case 30:return null}throw Error(a(156,r.tag))}function Pd(e,r){switch(Ra(r),r.tag){case 1:return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return It(Ie),ve(),e=r.flags,(e&65536)!==0&&(e&128)===0?(r.flags=e&-65537|128,r):null;case 26:case 27:case 5:return bt(r),null;case 13:if(Ft(r),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(a(340));Ii()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Q(Pe),null;case 4:return ve(),null;case 10:return It(r.type),null;case 22:case 23:return Ft(r),ja(),e!==null&&Q(On),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 24:return It(Ie),null;case 25:return null;default:return null}}function Uc(e,r){switch(Ra(r),r.tag){case 3:It(Ie),ve();break;case 26:case 27:case 5:bt(r);break;case 4:ve();break;case 13:Ft(r);break;case 19:Q(Pe);break;case 10:It(r.type);break;case 22:case 23:Ft(r),ja(),e!==null&&Q(On);break;case 24:It(Ie)}}function ar(e,r){try{var o=r.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var f=u.next;o=f;do{if((o.tag&e)===e){u=void 0;var p=o.create,E=o.inst;u=p(),E.destroy=u}o=o.next}while(o!==f)}}catch(x){$e(r,r.return,x)}}function cn(e,r,o){try{var u=r.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var p=f.next;u=p;do{if((u.tag&e)===e){var E=u.inst,x=E.destroy;if(x!==void 0){E.destroy=void 0,f=r;var M=o,Z=x;try{Z()}catch(ne){$e(f,M,ne)}}}u=u.next}while(u!==p)}}catch(ne){$e(r,r.return,ne)}}function $c(e){var r=e.updateQueue;if(r!==null){var o=e.stateNode;try{Eu(r,o)}catch(u){$e(e,e.return,u)}}}function Mc(e,r,o){o.props=jn(e.type,e.memoizedProps),o.state=e.memoizedState;try{o.componentWillUnmount()}catch(u){$e(e,r,u)}}function or(e,r){try{var o=e.ref;if(o!==null){switch(e.tag){case 26:case 27:case 5:var u=e.stateNode;break;case 30:u=e.stateNode;break;default:u=e.stateNode}typeof o=="function"?e.refCleanup=o(u):o.current=u}}catch(f){$e(e,r,f)}}function Mt(e,r){var o=e.ref,u=e.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(f){$e(e,r,f)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){$e(e,r,f)}else o.current=null}function Lc(e){var r=e.type,o=e.memoizedProps,u=e.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(f){$e(e,e.return,f)}}function ho(e,r,o){try{var u=e.stateNode;fp(u,e.type,o,r),u[nt]=r}catch(f){$e(e,e.return,f)}}function Oc(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&bn(e.type)||e.tag===4}function po(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Oc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&bn(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yo(e,r,o){var u=e.tag;if(u===5||u===6)e=e.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(e,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(e),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=As));else if(u!==4&&(u===27&&bn(e.type)&&(o=e.stateNode,r=null),e=e.child,e!==null))for(yo(e,r,o),e=e.sibling;e!==null;)yo(e,r,o),e=e.sibling}function gs(e,r,o){var u=e.tag;if(u===5||u===6)e=e.stateNode,r?o.insertBefore(e,r):o.appendChild(e);else if(u!==4&&(u===27&&bn(e.type)&&(o=e.stateNode),e=e.child,e!==null))for(gs(e,r,o),e=e.sibling;e!==null;)gs(e,r,o),e=e.sibling}function Dc(e){var r=e.stateNode,o=e.memoizedProps;try{for(var u=e.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);We(r,u,o),r[Je]=e,r[nt]=o}catch(p){$e(e,e.return,p)}}var Zt=!1,ze=!1,go=!1,jc=typeof WeakSet=="function"?WeakSet:Set,Ye=null;function Fd(e,r){if(e=e.containerInfo,zo=Ls,e=Xl(e),ha(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var f=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{o.nodeType,p.nodeType}catch{o=null;break e}var E=0,x=-1,M=-1,Z=0,ne=0,ae=e,K=null;t:for(;;){for(var W;ae!==o||f!==0&&ae.nodeType!==3||(x=E+f),ae!==p||u!==0&&ae.nodeType!==3||(M=E+u),ae.nodeType===3&&(E+=ae.nodeValue.length),(W=ae.firstChild)!==null;)K=ae,ae=W;for(;;){if(ae===e)break t;if(K===o&&++Z===f&&(x=E),K===p&&++ne===u&&(M=E),(W=ae.nextSibling)!==null)break;ae=K,K=ae.parentNode}ae=W}o=x===-1||M===-1?null:{start:x,end:M}}else o=null}o=o||{start:0,end:0}}else o=null;for(qo={focusedElem:e,selectionRange:o},Ls=!1,Ye=r;Ye!==null;)if(r=Ye,e=r.child,(r.subtreeFlags&1024)!==0&&e!==null)e.return=r,Ye=e;else for(;Ye!==null;){switch(r=Ye,p=r.alternate,e=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&p!==null){e=void 0,o=r,f=p.memoizedProps,p=p.memoizedState,u=o.stateNode;try{var ye=jn(o.type,f,o.elementType===o.type);e=u.getSnapshotBeforeUpdate(ye,p),u.__reactInternalSnapshotBeforeUpdate=e}catch(de){$e(o,o.return,de)}}break;case 3:if((e&1024)!==0){if(e=r.stateNode.containerInfo,o=e.nodeType,o===9)Po(e);else if(o===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Po(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(a(163))}if(e=r.sibling,e!==null){e.return=r.return,Ye=e;break}Ye=r.return}}function Hc(e,r,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:fn(e,o),u&4&&ar(5,o);break;case 1:if(fn(e,o),u&4)if(e=o.stateNode,r===null)try{e.componentDidMount()}catch(E){$e(o,o.return,E)}else{var f=jn(o.type,r.memoizedProps);r=r.memoizedState;try{e.componentDidUpdate(f,r,e.__reactInternalSnapshotBeforeUpdate)}catch(E){$e(o,o.return,E)}}u&64&&$c(o),u&512&&or(o,o.return);break;case 3:if(fn(e,o),u&64&&(e=o.updateQueue,e!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{Eu(e,r)}catch(E){$e(o,o.return,E)}}break;case 27:r===null&&u&4&&Dc(o);case 26:case 5:fn(e,o),r===null&&u&4&&Lc(o),u&512&&or(o,o.return);break;case 12:fn(e,o);break;case 13:fn(e,o),u&4&&Vc(e,o),u&64&&(e=o.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(o=ep.bind(null,o),bp(e,o))));break;case 22:if(u=o.memoizedState!==null||Zt,!u){r=r!==null&&r.memoizedState!==null||ze,f=Zt;var p=ze;Zt=u,(ze=r)&&!p?hn(e,o,(o.subtreeFlags&8772)!==0):fn(e,o),Zt=f,ze=p}break;case 30:break;default:fn(e,o)}}function zc(e){var r=e.alternate;r!==null&&(e.alternate=null,zc(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&Ys(r)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Le=null,st=!1;function Xt(e,r,o){for(o=o.child;o!==null;)qc(e,r,o),o=o.sibling}function qc(e,r,o){if(lt&&typeof lt.onCommitFiberUnmount=="function")try{lt.onCommitFiberUnmount(Ai,o)}catch{}switch(o.tag){case 26:ze||Mt(o,r),Xt(e,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:ze||Mt(o,r);var u=Le,f=st;bn(o.type)&&(Le=o.stateNode,st=!1),Xt(e,r,o),gr(o.stateNode),Le=u,st=f;break;case 5:ze||Mt(o,r);case 6:if(u=Le,f=st,Le=null,Xt(e,r,o),Le=u,st=f,Le!==null)if(st)try{(Le.nodeType===9?Le.body:Le.nodeName==="HTML"?Le.ownerDocument.body:Le).removeChild(o.stateNode)}catch(p){$e(o,r,p)}else try{Le.removeChild(o.stateNode)}catch(p){$e(o,r,p)}break;case 18:Le!==null&&(st?(e=Le,Bf(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,o.stateNode),Sr(e)):Bf(Le,o.stateNode));break;case 4:u=Le,f=st,Le=o.stateNode.containerInfo,st=!0,Xt(e,r,o),Le=u,st=f;break;case 0:case 11:case 14:case 15:ze||cn(2,o,r),ze||cn(4,o,r),Xt(e,r,o);break;case 1:ze||(Mt(o,r),u=o.stateNode,typeof u.componentWillUnmount=="function"&&Mc(o,r,u)),Xt(e,r,o);break;case 21:Xt(e,r,o);break;case 22:ze=(u=ze)||o.memoizedState!==null,Xt(e,r,o),ze=u;break;default:Xt(e,r,o)}}function Vc(e,r){if(r.memoizedState===null&&(e=r.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Sr(e)}catch(o){$e(r,r.return,o)}}function Gd(e){switch(e.tag){case 13:case 19:var r=e.stateNode;return r===null&&(r=e.stateNode=new jc),r;case 22:return e=e.stateNode,r=e._retryCache,r===null&&(r=e._retryCache=new jc),r;default:throw Error(a(435,e.tag))}}function mo(e,r){var o=Gd(e);r.forEach(function(u){var f=tp.bind(null,e,u);o.has(u)||(o.add(u),u.then(f,f))})}function dt(e,r){var o=r.deletions;if(o!==null)for(var u=0;u<o.length;u++){var f=o[u],p=e,E=r,x=E;e:for(;x!==null;){switch(x.tag){case 27:if(bn(x.type)){Le=x.stateNode,st=!1;break e}break;case 5:Le=x.stateNode,st=!1;break e;case 3:case 4:Le=x.stateNode.containerInfo,st=!0;break e}x=x.return}if(Le===null)throw Error(a(160));qc(p,E,f),Le=null,st=!1,p=f.alternate,p!==null&&(p.return=null),f.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)Ic(r,e),r=r.sibling}var Ct=null;function Ic(e,r){var o=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:dt(r,e),pt(e),u&4&&(cn(3,e,e.return),ar(3,e),cn(5,e,e.return));break;case 1:dt(r,e),pt(e),u&512&&(ze||o===null||Mt(o,o.return)),u&64&&Zt&&(e=e.updateQueue,e!==null&&(u=e.callbacks,u!==null&&(o=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var f=Ct;if(dt(r,e),pt(e),u&512&&(ze||o===null||Mt(o,o.return)),u&4){var p=o!==null?o.memoizedState:null;if(u=e.memoizedState,o===null)if(u===null)if(e.stateNode===null){e:{u=e.type,o=e.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":p=f.getElementsByTagName("title")[0],(!p||p[Ni]||p[Je]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=f.createElement(u),f.head.insertBefore(p,f.querySelector("head > title"))),We(p,u,o),p[Je]=e,Fe(p),u=p;break e;case"link":var E=jf("link","href",f).get(u+(o.href||""));if(E){for(var x=0;x<E.length;x++)if(p=E[x],p.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&p.getAttribute("rel")===(o.rel==null?null:o.rel)&&p.getAttribute("title")===(o.title==null?null:o.title)&&p.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(x,1);break t}}p=f.createElement(u),We(p,u,o),f.head.appendChild(p);break;case"meta":if(E=jf("meta","content",f).get(u+(o.content||""))){for(x=0;x<E.length;x++)if(p=E[x],p.getAttribute("content")===(o.content==null?null:""+o.content)&&p.getAttribute("name")===(o.name==null?null:o.name)&&p.getAttribute("property")===(o.property==null?null:o.property)&&p.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&p.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(x,1);break t}}p=f.createElement(u),We(p,u,o),f.head.appendChild(p);break;default:throw Error(a(468,u))}p[Je]=e,Fe(p),u=p}e.stateNode=u}else Hf(f,e.type,e.stateNode);else e.stateNode=Df(f,u,e.memoizedProps);else p!==u?(p===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):p.count--,u===null?Hf(f,e.type,e.stateNode):Df(f,u,e.memoizedProps)):u===null&&e.stateNode!==null&&ho(e,e.memoizedProps,o.memoizedProps)}break;case 27:dt(r,e),pt(e),u&512&&(ze||o===null||Mt(o,o.return)),o!==null&&u&4&&ho(e,e.memoizedProps,o.memoizedProps);break;case 5:if(dt(r,e),pt(e),u&512&&(ze||o===null||Mt(o,o.return)),e.flags&32){f=e.stateNode;try{Qn(f,"")}catch(W){$e(e,e.return,W)}}u&4&&e.stateNode!=null&&(f=e.memoizedProps,ho(e,f,o!==null?o.memoizedProps:f)),u&1024&&(go=!0);break;case 6:if(dt(r,e),pt(e),u&4){if(e.stateNode===null)throw Error(a(162));u=e.memoizedProps,o=e.stateNode;try{o.nodeValue=u}catch(W){$e(e,e.return,W)}}break;case 3:if(Us=null,f=Ct,Ct=Bs(r.containerInfo),dt(r,e),Ct=f,pt(e),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Sr(r.containerInfo)}catch(W){$e(e,e.return,W)}go&&(go=!1,Pc(e));break;case 4:u=Ct,Ct=Bs(e.stateNode.containerInfo),dt(r,e),pt(e),Ct=u;break;case 12:dt(r,e),pt(e);break;case 13:dt(r,e),pt(e),e.child.flags&8192&&e.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Ro=Nt()),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,mo(e,u)));break;case 22:f=e.memoizedState!==null;var M=o!==null&&o.memoizedState!==null,Z=Zt,ne=ze;if(Zt=Z||f,ze=ne||M,dt(r,e),ze=ne,Zt=Z,pt(e),u&8192)e:for(r=e.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||M||Zt||ze||Hn(e)),o=null,r=e;;){if(r.tag===5||r.tag===26){if(o===null){M=o=r;try{if(p=M.stateNode,f)E=p.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{x=M.stateNode;var ae=M.memoizedProps.style,K=ae!=null&&ae.hasOwnProperty("display")?ae.display:null;x.style.display=K==null||typeof K=="boolean"?"":(""+K).trim()}}catch(W){$e(M,M.return,W)}}}else if(r.tag===6){if(o===null){M=r;try{M.stateNode.nodeValue=f?"":M.memoizedProps}catch(W){$e(M,M.return,W)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===e)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=e.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,mo(e,o))));break;case 19:dt(r,e),pt(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,mo(e,u)));break;case 30:break;case 21:break;default:dt(r,e),pt(e)}}function pt(e){var r=e.flags;if(r&2){try{for(var o,u=e.return;u!==null;){if(Oc(u)){o=u;break}u=u.return}if(o==null)throw Error(a(160));switch(o.tag){case 27:var f=o.stateNode,p=po(e);gs(e,p,f);break;case 5:var E=o.stateNode;o.flags&32&&(Qn(E,""),o.flags&=-33);var x=po(e);gs(e,x,E);break;case 3:case 4:var M=o.stateNode.containerInfo,Z=po(e);yo(e,Z,M);break;default:throw Error(a(161))}}catch(ne){$e(e,e.return,ne)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function Pc(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var r=e;Pc(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),e=e.sibling}}function fn(e,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Hc(e,r.alternate,r),r=r.sibling}function Hn(e){for(e=e.child;e!==null;){var r=e;switch(r.tag){case 0:case 11:case 14:case 15:cn(4,r,r.return),Hn(r);break;case 1:Mt(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&Mc(r,r.return,o),Hn(r);break;case 27:gr(r.stateNode);case 26:case 5:Mt(r,r.return),Hn(r);break;case 22:r.memoizedState===null&&Hn(r);break;case 30:Hn(r);break;default:Hn(r)}e=e.sibling}}function hn(e,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,f=e,p=r,E=p.flags;switch(p.tag){case 0:case 11:case 15:hn(f,p,o),ar(4,p);break;case 1:if(hn(f,p,o),u=p,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Z){$e(u,u.return,Z)}if(u=p,f=u.updateQueue,f!==null){var x=u.stateNode;try{var M=f.shared.hiddenCallbacks;if(M!==null)for(f.shared.hiddenCallbacks=null,f=0;f<M.length;f++)vu(M[f],x)}catch(Z){$e(u,u.return,Z)}}o&&E&64&&$c(p),or(p,p.return);break;case 27:Dc(p);case 26:case 5:hn(f,p,o),o&&u===null&&E&4&&Lc(p),or(p,p.return);break;case 12:hn(f,p,o);break;case 13:hn(f,p,o),o&&E&4&&Vc(f,p);break;case 22:p.memoizedState===null&&hn(f,p,o),or(p,p.return);break;case 30:break;default:hn(f,p,o)}r=r.sibling}}function bo(e,r){var o=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(o=e.memoizedState.cachePool.pool),e=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(e=r.memoizedState.cachePool.pool),e!==o&&(e!=null&&e.refCount++,o!=null&&Gi(o))}function vo(e,r){e=null,r.alternate!==null&&(e=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==e&&(r.refCount++,e!=null&&Gi(e))}function Lt(e,r,o,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Fc(e,r,o,u),r=r.sibling}function Fc(e,r,o,u){var f=r.flags;switch(r.tag){case 0:case 11:case 15:Lt(e,r,o,u),f&2048&&ar(9,r);break;case 1:Lt(e,r,o,u);break;case 3:Lt(e,r,o,u),f&2048&&(e=null,r.alternate!==null&&(e=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==e&&(r.refCount++,e!=null&&Gi(e)));break;case 12:if(f&2048){Lt(e,r,o,u),e=r.stateNode;try{var p=r.memoizedProps,E=p.id,x=p.onPostCommit;typeof x=="function"&&x(E,r.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(M){$e(r,r.return,M)}}else Lt(e,r,o,u);break;case 13:Lt(e,r,o,u);break;case 23:break;case 22:p=r.stateNode,E=r.alternate,r.memoizedState!==null?p._visibility&2?Lt(e,r,o,u):lr(e,r):p._visibility&2?Lt(e,r,o,u):(p._visibility|=2,yi(e,r,o,u,(r.subtreeFlags&10256)!==0)),f&2048&&bo(E,r);break;case 24:Lt(e,r,o,u),f&2048&&vo(r.alternate,r);break;default:Lt(e,r,o,u)}}function yi(e,r,o,u,f){for(f=f&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var p=e,E=r,x=o,M=u,Z=E.flags;switch(E.tag){case 0:case 11:case 15:yi(p,E,x,M,f),ar(8,E);break;case 23:break;case 22:var ne=E.stateNode;E.memoizedState!==null?ne._visibility&2?yi(p,E,x,M,f):lr(p,E):(ne._visibility|=2,yi(p,E,x,M,f)),f&&Z&2048&&bo(E.alternate,E);break;case 24:yi(p,E,x,M,f),f&&Z&2048&&vo(E.alternate,E);break;default:yi(p,E,x,M,f)}r=r.sibling}}function lr(e,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=e,u=r,f=u.flags;switch(u.tag){case 22:lr(o,u),f&2048&&bo(u.alternate,u);break;case 24:lr(o,u),f&2048&&vo(u.alternate,u);break;default:lr(o,u)}r=r.sibling}}var ur=8192;function gi(e){if(e.subtreeFlags&ur)for(e=e.child;e!==null;)Gc(e),e=e.sibling}function Gc(e){switch(e.tag){case 26:gi(e),e.flags&ur&&e.memoizedState!==null&&Np(Ct,e.memoizedState,e.memoizedProps);break;case 5:gi(e);break;case 3:case 4:var r=Ct;Ct=Bs(e.stateNode.containerInfo),gi(e),Ct=r;break;case 22:e.memoizedState===null&&(r=e.alternate,r!==null&&r.memoizedState!==null?(r=ur,ur=16777216,gi(e),ur=r):gi(e));break;default:gi(e)}}function Yc(e){var r=e.alternate;if(r!==null&&(e=r.child,e!==null)){r.child=null;do r=e.sibling,e.sibling=null,e=r;while(e!==null)}}function cr(e){var r=e.deletions;if((e.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Ye=u,Xc(u,e)}Yc(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Zc(e),e=e.sibling}function Zc(e){switch(e.tag){case 0:case 11:case 15:cr(e),e.flags&2048&&cn(9,e,e.return);break;case 3:cr(e);break;case 12:cr(e);break;case 22:var r=e.stateNode;e.memoizedState!==null&&r._visibility&2&&(e.return===null||e.return.tag!==13)?(r._visibility&=-3,bs(e)):cr(e);break;default:cr(e)}}function bs(e){var r=e.deletions;if((e.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Ye=u,Xc(u,e)}Yc(e)}for(e=e.child;e!==null;){switch(r=e,r.tag){case 0:case 11:case 15:cn(8,r,r.return),bs(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,bs(r));break;default:bs(r)}e=e.sibling}}function Xc(e,r){for(;Ye!==null;){var o=Ye;switch(o.tag){case 0:case 11:case 15:cn(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Gi(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Ye=u;else e:for(o=e;Ye!==null;){u=Ye;var f=u.sibling,p=u.return;if(zc(u),u===o){Ye=null;break e}if(f!==null){f.return=p,Ye=f;break e}Ye=p}}}var Yd={getCacheForType:function(e){var r=et(Ie),o=r.data.get(e);return o===void 0&&(o=e(),r.data.set(e,o)),o}},Zd=typeof WeakMap=="function"?WeakMap:Map,Te=0,Me=null,xe=null,Se=0,Ae=0,yt=null,dn=!1,mi=!1,Eo=!1,Qt=0,je=0,pn=0,zn=0,wo=0,kt=0,bi=0,fr=null,at=null,xo=!1,Ro=0,vs=1/0,Es=null,yn=null,Ke=0,gn=null,vi=null,Ei=0,So=0,_o=null,Qc=null,hr=0,ko=null;function gt(){if((Te&2)!==0&&Se!==0)return Se&-Se;if(R.T!==null){var e=oi;return e!==0?e:$o()}return hl()}function Kc(){kt===0&&(kt=(Se&536870912)===0||ke?ll():536870912);var e=_t.current;return e!==null&&(e.flags|=32),kt}function mt(e,r,o){(e===Me&&(Ae===2||Ae===9)||e.cancelPendingCommit!==null)&&(wi(e,0),mn(e,Se,kt,!1)),Bi(e,o),((Te&2)===0||e!==Me)&&(e===Me&&((Te&2)===0&&(zn|=o),je===4&&mn(e,Se,kt,!1)),Ot(e))}function Wc(e,r,o){if((Te&6)!==0)throw Error(a(327));var u=!o&&(r&124)===0&&(r&e.expiredLanes)===0||Ci(e,r),f=u?Kd(e,r):Co(e,r,!0),p=u;do{if(f===0){mi&&!u&&mn(e,r,0,!1);break}else{if(o=e.current.alternate,p&&!Xd(o)){f=Co(e,r,!1),p=!1;continue}if(f===2){if(p=r,e.errorRecoveryDisabledLanes&p)var E=0;else E=e.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){r=E;e:{var x=e;f=fr;var M=x.current.memoizedState.isDehydrated;if(M&&(wi(x,E).flags|=256),E=Co(x,E,!1),E!==2){if(Eo&&!M){x.errorRecoveryDisabledLanes|=p,zn|=p,f=4;break e}p=at,at=f,p!==null&&(at===null?at=p:at.push.apply(at,p))}f=E}if(p=!1,f!==2)continue}}if(f===1){wi(e,0),mn(e,r,0,!0);break}e:{switch(u=e,p=f,p){case 0:case 1:throw Error(a(345));case 4:if((r&4194048)!==r)break;case 6:mn(u,r,kt,!dn);break e;case 2:at=null;break;case 3:case 5:break;default:throw Error(a(329))}if((r&62914560)===r&&(f=Ro+300-Nt(),10<f)){if(mn(u,r,kt,!dn),Br(u,0,!0)!==0)break e;u.timeoutHandle=Af(Jc.bind(null,u,o,at,Es,xo,r,kt,zn,bi,dn,p,2,-0,0),f);break e}Jc(u,o,at,Es,xo,r,kt,zn,bi,dn,p,0,-0,0)}}break}while(!0);Ot(e)}function Jc(e,r,o,u,f,p,E,x,M,Z,ne,ae,K,W){if(e.timeoutHandle=-1,ae=r.subtreeFlags,(ae&8192||(ae&16785408)===16785408)&&(vr={stylesheets:null,count:0,unsuspend:Bp},Gc(r),ae=Up(),ae!==null)){e.cancelPendingCommit=ae(of.bind(null,e,r,p,o,u,f,E,x,M,ne,1,K,W)),mn(e,p,E,!Z);return}of(e,r,p,o,u,f,E,x,M)}function Xd(e){for(var r=e;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var f=o[u],p=f.getSnapshot;f=f.value;try{if(!ft(p(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function mn(e,r,o,u){r&=~wo,r&=~zn,e.suspendedLanes|=r,e.pingedLanes&=~r,u&&(e.warmLanes|=r),u=e.expirationTimes;for(var f=r;0<f;){var p=31-ct(f),E=1<<p;u[p]=-1,f&=~E}o!==0&&cl(e,o,r)}function ws(){return(Te&6)===0?(dr(0),!1):!0}function To(){if(xe!==null){if(Ae===0)var e=xe.return;else e=xe,Vt=Mn=null,Ia(e),di=null,ir=0,e=xe;for(;e!==null;)Uc(e.alternate,e),e=e.return;xe=null}}function wi(e,r){var o=e.timeoutHandle;o!==-1&&(e.timeoutHandle=-1,dp(o)),o=e.cancelPendingCommit,o!==null&&(e.cancelPendingCommit=null,o()),To(),Me=e,xe=o=Ht(e.current,null),Se=r,Ae=0,yt=null,dn=!1,mi=Ci(e,r),Eo=!1,bi=kt=wo=zn=pn=je=0,at=fr=null,xo=!1,(r&8)!==0&&(r|=r&32);var u=e.entangledLanes;if(u!==0)for(e=e.entanglements,u&=r;0<u;){var f=31-ct(u),p=1<<f;r|=e[f],u&=~p}return Qt=r,Vr(),o}function ef(e,r){Ee=null,R.H=os,r===Zi||r===Kr?(r=mu(),Ae=3):r===pu?(r=mu(),Ae=4):Ae=r===bc?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,yt=r,xe===null&&(je=1,hs(e,wt(r,e.current)))}function tf(){var e=R.H;return R.H=os,e===null?os:e}function nf(){var e=R.A;return R.A=Yd,e}function Ao(){je=4,dn||(Se&4194048)!==Se&&_t.current!==null||(mi=!0),(pn&134217727)===0&&(zn&134217727)===0||Me===null||mn(Me,Se,kt,!1)}function Co(e,r,o){var u=Te;Te|=2;var f=tf(),p=nf();(Me!==e||Se!==r)&&(Es=null,wi(e,r)),r=!1;var E=je;e:do try{if(Ae!==0&&xe!==null){var x=xe,M=yt;switch(Ae){case 8:To(),E=6;break e;case 3:case 2:case 9:case 6:_t.current===null&&(r=!0);var Z=Ae;if(Ae=0,yt=null,xi(e,x,M,Z),o&&mi){E=0;break e}break;default:Z=Ae,Ae=0,yt=null,xi(e,x,M,Z)}}Qd(),E=je;break}catch(ne){ef(e,ne)}while(!0);return r&&e.shellSuspendCounter++,Vt=Mn=null,Te=u,R.H=f,R.A=p,xe===null&&(Me=null,Se=0,Vr()),E}function Qd(){for(;xe!==null;)rf(xe)}function Kd(e,r){var o=Te;Te|=2;var u=tf(),f=nf();Me!==e||Se!==r?(Es=null,vs=Nt()+500,wi(e,r)):mi=Ci(e,r);e:do try{if(Ae!==0&&xe!==null){r=xe;var p=yt;t:switch(Ae){case 1:Ae=0,yt=null,xi(e,r,p,1);break;case 2:case 9:if(yu(p)){Ae=0,yt=null,sf(r);break}r=function(){Ae!==2&&Ae!==9||Me!==e||(Ae=7),Ot(e)},p.then(r,r);break e;case 3:Ae=7;break e;case 4:Ae=5;break e;case 7:yu(p)?(Ae=0,yt=null,sf(r)):(Ae=0,yt=null,xi(e,r,p,7));break;case 5:var E=null;switch(xe.tag){case 26:E=xe.memoizedState;case 5:case 27:var x=xe;if(!E||zf(E)){Ae=0,yt=null;var M=x.sibling;if(M!==null)xe=M;else{var Z=x.return;Z!==null?(xe=Z,xs(Z)):xe=null}break t}}Ae=0,yt=null,xi(e,r,p,5);break;case 6:Ae=0,yt=null,xi(e,r,p,6);break;case 8:To(),je=6;break e;default:throw Error(a(462))}}Wd();break}catch(ne){ef(e,ne)}while(!0);return Vt=Mn=null,R.H=u,R.A=f,Te=o,xe!==null?0:(Me=null,Se=0,Vr(),je)}function Wd(){for(;xe!==null&&!_r();)rf(xe)}function rf(e){var r=Bc(e.alternate,e,Qt);e.memoizedProps=e.pendingProps,r===null?xs(e):xe=r}function sf(e){var r=e,o=r.alternate;switch(r.tag){case 15:case 0:r=Sc(o,r,r.pendingProps,r.type,void 0,Se);break;case 11:r=Sc(o,r,r.pendingProps,r.type.render,r.ref,Se);break;case 5:Ia(r);default:Uc(o,r),r=xe=su(r,Qt),r=Bc(o,r,Qt)}e.memoizedProps=e.pendingProps,r===null?xs(e):xe=r}function xi(e,r,o,u){Vt=Mn=null,Ia(r),di=null,ir=0;var f=r.return;try{if(qd(e,f,r,o,Se)){je=1,hs(e,wt(o,e.current)),xe=null;return}}catch(p){if(f!==null)throw xe=f,p;je=1,hs(e,wt(o,e.current)),xe=null;return}r.flags&32768?(ke||u===1?e=!0:mi||(Se&536870912)!==0?e=!1:(dn=e=!0,(u===2||u===9||u===3||u===6)&&(u=_t.current,u!==null&&u.tag===13&&(u.flags|=16384))),af(r,e)):xs(r)}function xs(e){var r=e;do{if((r.flags&32768)!==0){af(r,dn);return}e=r.return;var o=Id(r.alternate,r,Qt);if(o!==null){xe=o;return}if(r=r.sibling,r!==null){xe=r;return}xe=r=e}while(r!==null);je===0&&(je=5)}function af(e,r){do{var o=Pd(e.alternate,e);if(o!==null){o.flags&=32767,xe=o;return}if(o=e.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(e=e.sibling,e!==null)){xe=e;return}xe=e=o}while(e!==null);je=6,xe=null}function of(e,r,o,u,f,p,E,x,M){e.cancelPendingCommit=null;do Rs();while(Ke!==0);if((Te&6)!==0)throw Error(a(327));if(r!==null){if(r===e.current)throw Error(a(177));if(p=r.lanes|r.childLanes,p|=ma,Bh(e,o,p,E,x,M),e===Me&&(xe=Me=null,Se=0),vi=r,gn=e,Ei=o,So=p,_o=f,Qc=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,np(Tr,function(){return hf(),null})):(e.callbackNode=null,e.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=R.T,R.T=null,f=U.p,U.p=2,E=Te,Te|=4;try{Fd(e,r,o)}finally{Te=E,U.p=f,R.T=u}}Ke=1,lf(),uf(),cf()}}function lf(){if(Ke===1){Ke=0;var e=gn,r=vi,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=R.T,R.T=null;var u=U.p;U.p=2;var f=Te;Te|=4;try{Ic(r,e);var p=qo,E=Xl(e.containerInfo),x=p.focusedElem,M=p.selectionRange;if(E!==x&&x&&x.ownerDocument&&Zl(x.ownerDocument.documentElement,x)){if(M!==null&&ha(x)){var Z=M.start,ne=M.end;if(ne===void 0&&(ne=Z),"selectionStart"in x)x.selectionStart=Z,x.selectionEnd=Math.min(ne,x.value.length);else{var ae=x.ownerDocument||document,K=ae&&ae.defaultView||window;if(K.getSelection){var W=K.getSelection(),ye=x.textContent.length,de=Math.min(M.start,ye),Ne=M.end===void 0?de:Math.min(M.end,ye);!W.extend&&de>Ne&&(E=Ne,Ne=de,de=E);var P=Yl(x,de),q=Yl(x,Ne);if(P&&q&&(W.rangeCount!==1||W.anchorNode!==P.node||W.anchorOffset!==P.offset||W.focusNode!==q.node||W.focusOffset!==q.offset)){var F=ae.createRange();F.setStart(P.node,P.offset),W.removeAllRanges(),de>Ne?(W.addRange(F),W.extend(q.node,q.offset)):(F.setEnd(q.node,q.offset),W.addRange(F))}}}}for(ae=[],W=x;W=W.parentNode;)W.nodeType===1&&ae.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<ae.length;x++){var se=ae[x];se.element.scrollLeft=se.left,se.element.scrollTop=se.top}}Ls=!!zo,qo=zo=null}finally{Te=f,U.p=u,R.T=o}}e.current=r,Ke=2}}function uf(){if(Ke===2){Ke=0;var e=gn,r=vi,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=R.T,R.T=null;var u=U.p;U.p=2;var f=Te;Te|=4;try{Hc(e,r.alternate,r)}finally{Te=f,U.p=u,R.T=o}}Ke=3}}function cf(){if(Ke===4||Ke===3){Ke=0,kr();var e=gn,r=vi,o=Ei,u=Qc;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ke=5:(Ke=0,vi=gn=null,ff(e,e.pendingLanes));var f=e.pendingLanes;if(f===0&&(yn=null),Fs(o),r=r.stateNode,lt&&typeof lt.onCommitFiberRoot=="function")try{lt.onCommitFiberRoot(Ai,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=R.T,f=U.p,U.p=2,R.T=null;try{for(var p=e.onRecoverableError,E=0;E<u.length;E++){var x=u[E];p(x.value,{componentStack:x.stack})}}finally{R.T=r,U.p=f}}(Ei&3)!==0&&Rs(),Ot(e),f=e.pendingLanes,(o&4194090)!==0&&(f&42)!==0?e===ko?hr++:(hr=0,ko=e):hr=0,dr(0)}}function ff(e,r){(e.pooledCacheLanes&=r)===0&&(r=e.pooledCache,r!=null&&(e.pooledCache=null,Gi(r)))}function Rs(e){return lf(),uf(),cf(),hf()}function hf(){if(Ke!==5)return!1;var e=gn,r=So;So=0;var o=Fs(Ei),u=R.T,f=U.p;try{U.p=32>o?32:o,R.T=null,o=_o,_o=null;var p=gn,E=Ei;if(Ke=0,vi=gn=null,Ei=0,(Te&6)!==0)throw Error(a(331));var x=Te;if(Te|=4,Zc(p.current),Fc(p,p.current,E,o),Te=x,dr(0,!1),lt&&typeof lt.onPostCommitFiberRoot=="function")try{lt.onPostCommitFiberRoot(Ai,p)}catch{}return!0}finally{U.p=f,R.T=u,ff(e,r)}}function df(e,r,o){r=wt(o,r),r=io(e.stateNode,r,2),e=an(e,r,2),e!==null&&(Bi(e,2),Ot(e))}function $e(e,r,o){if(e.tag===3)df(e,e,o);else for(;r!==null;){if(r.tag===3){df(r,e,o);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(yn===null||!yn.has(u))){e=wt(o,e),o=gc(2),u=an(r,o,2),u!==null&&(mc(o,u,r,e),Bi(u,2),Ot(u));break}}r=r.return}}function Bo(e,r,o){var u=e.pingCache;if(u===null){u=e.pingCache=new Zd;var f=new Set;u.set(r,f)}else f=u.get(r),f===void 0&&(f=new Set,u.set(r,f));f.has(o)||(Eo=!0,f.add(o),e=Jd.bind(null,e,r,o),r.then(e,e))}function Jd(e,r,o){var u=e.pingCache;u!==null&&u.delete(r),e.pingedLanes|=e.suspendedLanes&o,e.warmLanes&=~o,Me===e&&(Se&o)===o&&(je===4||je===3&&(Se&62914560)===Se&&300>Nt()-Ro?(Te&2)===0&&wi(e,0):wo|=o,bi===Se&&(bi=0)),Ot(e)}function pf(e,r){r===0&&(r=ul()),e=ii(e,r),e!==null&&(Bi(e,r),Ot(e))}function ep(e){var r=e.memoizedState,o=0;r!==null&&(o=r.retryLane),pf(e,o)}function tp(e,r){var o=0;switch(e.tag){case 13:var u=e.stateNode,f=e.memoizedState;f!==null&&(o=f.retryLane);break;case 19:u=e.stateNode;break;case 22:u=e.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(r),pf(e,o)}function np(e,r){return ot(e,r)}var Ss=null,Ri=null,No=!1,_s=!1,Uo=!1,qn=0;function Ot(e){e!==Ri&&e.next===null&&(Ri===null?Ss=Ri=e:Ri=Ri.next=e),_s=!0,No||(No=!0,rp())}function dr(e,r){if(!Uo&&_s){Uo=!0;do for(var o=!1,u=Ss;u!==null;){if(e!==0){var f=u.pendingLanes;if(f===0)var p=0;else{var E=u.suspendedLanes,x=u.pingedLanes;p=(1<<31-ct(42|e)+1)-1,p&=f&~(E&~x),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(o=!0,bf(u,p))}else p=Se,p=Br(u,u===Me?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(p&3)===0||Ci(u,p)||(o=!0,bf(u,p));u=u.next}while(o);Uo=!1}}function ip(){yf()}function yf(){_s=No=!1;var e=0;qn!==0&&(hp()&&(e=qn),qn=0);for(var r=Nt(),o=null,u=Ss;u!==null;){var f=u.next,p=gf(u,r);p===0?(u.next=null,o===null?Ss=f:o.next=f,f===null&&(Ri=o)):(o=u,(e!==0||(p&3)!==0)&&(_s=!0)),u=f}dr(e)}function gf(e,r){for(var o=e.suspendedLanes,u=e.pingedLanes,f=e.expirationTimes,p=e.pendingLanes&-62914561;0<p;){var E=31-ct(p),x=1<<E,M=f[E];M===-1?((x&o)===0||(x&u)!==0)&&(f[E]=Ch(x,r)):M<=r&&(e.expiredLanes|=x),p&=~x}if(r=Me,o=Se,o=Br(e,e===r?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u=e.callbackNode,o===0||e===r&&(Ae===2||Ae===9)||e.cancelPendingCommit!==null)return u!==null&&u!==null&&Wt(u),e.callbackNode=null,e.callbackPriority=0;if((o&3)===0||Ci(e,o)){if(r=o&-o,r===e.callbackPriority)return r;switch(u!==null&&Wt(u),Fs(o)){case 2:case 8:o=al;break;case 32:o=Tr;break;case 268435456:o=ol;break;default:o=Tr}return u=mf.bind(null,e),o=ot(o,u),e.callbackPriority=r,e.callbackNode=o,r}return u!==null&&u!==null&&Wt(u),e.callbackPriority=2,e.callbackNode=null,2}function mf(e,r){if(Ke!==0&&Ke!==5)return e.callbackNode=null,e.callbackPriority=0,null;var o=e.callbackNode;if(Rs()&&e.callbackNode!==o)return null;var u=Se;return u=Br(e,e===Me?u:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u===0?null:(Wc(e,u,r),gf(e,Nt()),e.callbackNode!=null&&e.callbackNode===o?mf.bind(null,e):null)}function bf(e,r){if(Rs())return null;Wc(e,r,!0)}function rp(){pp(function(){(Te&6)!==0?ot(sl,ip):yf()})}function $o(){return qn===0&&(qn=ll()),qn}function vf(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Lr(""+e)}function Ef(e,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,e.id&&o.setAttribute("form",e.id),r.parentNode.insertBefore(o,r),e=new FormData(e),o.parentNode.removeChild(o),e}function sp(e,r,o,u,f){if(r==="submit"&&o&&o.stateNode===f){var p=vf((f[nt]||null).action),E=u.submitter;E&&(r=(r=E[nt]||null)?vf(r.formAction):E.getAttribute("formAction"),r!==null&&(p=r,E=null));var x=new Hr("action","action",null,u,f);e.push({event:x,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(qn!==0){var M=E?Ef(f,E):new FormData(f);Wa(o,{pending:!0,data:M,method:f.method,action:p},null,M)}}else typeof p=="function"&&(x.preventDefault(),M=E?Ef(f,E):new FormData(f),Wa(o,{pending:!0,data:M,method:f.method,action:p},p,M))},currentTarget:f}]})}}for(var Mo=0;Mo<ga.length;Mo++){var Lo=ga[Mo],ap=Lo.toLowerCase(),op=Lo[0].toUpperCase()+Lo.slice(1);At(ap,"on"+op)}At(Wl,"onAnimationEnd"),At(Jl,"onAnimationIteration"),At(eu,"onAnimationStart"),At("dblclick","onDoubleClick"),At("focusin","onFocus"),At("focusout","onBlur"),At(Sd,"onTransitionRun"),At(_d,"onTransitionStart"),At(kd,"onTransitionCancel"),At(tu,"onTransitionEnd"),Yn("onMouseEnter",["mouseout","mouseover"]),Yn("onMouseLeave",["mouseout","mouseover"]),Yn("onPointerEnter",["pointerout","pointerover"]),Yn("onPointerLeave",["pointerout","pointerover"]),_n("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_n("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_n("onBeforeInput",["compositionend","keypress","textInput","paste"]),_n("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_n("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_n("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lp=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pr));function wf(e,r){r=(r&4)!==0;for(var o=0;o<e.length;o++){var u=e[o],f=u.event;u=u.listeners;e:{var p=void 0;if(r)for(var E=u.length-1;0<=E;E--){var x=u[E],M=x.instance,Z=x.currentTarget;if(x=x.listener,M!==p&&f.isPropagationStopped())break e;p=x,f.currentTarget=Z;try{p(f)}catch(ne){fs(ne)}f.currentTarget=null,p=M}else for(E=0;E<u.length;E++){if(x=u[E],M=x.instance,Z=x.currentTarget,x=x.listener,M!==p&&f.isPropagationStopped())break e;p=x,f.currentTarget=Z;try{p(f)}catch(ne){fs(ne)}f.currentTarget=null,p=M}}}}function Re(e,r){var o=r[Gs];o===void 0&&(o=r[Gs]=new Set);var u=e+"__bubble";o.has(u)||(xf(r,e,2,!1),o.add(u))}function Oo(e,r,o){var u=0;r&&(u|=4),xf(o,e,u,r)}var ks="_reactListening"+Math.random().toString(36).slice(2);function Do(e){if(!e[ks]){e[ks]=!0,pl.forEach(function(o){o!=="selectionchange"&&(lp.has(o)||Oo(o,!1,e),Oo(o,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[ks]||(r[ks]=!0,Oo("selectionchange",!1,r))}}function xf(e,r,o,u){switch(Gf(r)){case 2:var f=Lp;break;case 8:f=Op;break;default:f=Ko}o=f.bind(null,r,o,e),f=void 0,!ia||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),u?f!==void 0?e.addEventListener(r,o,{capture:!0,passive:f}):e.addEventListener(r,o,!0):f!==void 0?e.addEventListener(r,o,{passive:f}):e.addEventListener(r,o,!1)}function jo(e,r,o,u,f){var p=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var E=u.tag;if(E===3||E===4){var x=u.stateNode.containerInfo;if(x===f)break;if(E===4)for(E=u.return;E!==null;){var M=E.tag;if((M===3||M===4)&&E.stateNode.containerInfo===f)return;E=E.return}for(;x!==null;){if(E=Pn(x),E===null)return;if(M=E.tag,M===5||M===6||M===26||M===27){u=p=E;continue e}x=x.parentNode}}u=u.return}Al(function(){var Z=p,ne=ta(o),ae=[];e:{var K=nu.get(e);if(K!==void 0){var W=Hr,ye=e;switch(e){case"keypress":if(Dr(o)===0)break e;case"keydown":case"keyup":W=nd;break;case"focusin":ye="focus",W=oa;break;case"focusout":ye="blur",W=oa;break;case"beforeblur":case"afterblur":W=oa;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=Nl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=Ph;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=sd;break;case Wl:case Jl:case eu:W=Yh;break;case tu:W=od;break;case"scroll":case"scrollend":W=Vh;break;case"wheel":W=ud;break;case"copy":case"cut":case"paste":W=Xh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=$l;break;case"toggle":case"beforetoggle":W=fd}var de=(r&4)!==0,Ne=!de&&(e==="scroll"||e==="scrollend"),P=de?K!==null?K+"Capture":null:K;de=[];for(var q=Z,F;q!==null;){var se=q;if(F=se.stateNode,se=se.tag,se!==5&&se!==26&&se!==27||F===null||P===null||(se=$i(q,P),se!=null&&de.push(yr(q,se,F))),Ne)break;q=q.return}0<de.length&&(K=new W(K,ye,null,o,ne),ae.push({event:K,listeners:de}))}}if((r&7)===0){e:{if(K=e==="mouseover"||e==="pointerover",W=e==="mouseout"||e==="pointerout",K&&o!==ea&&(ye=o.relatedTarget||o.fromElement)&&(Pn(ye)||ye[In]))break e;if((W||K)&&(K=ne.window===ne?ne:(K=ne.ownerDocument)?K.defaultView||K.parentWindow:window,W?(ye=o.relatedTarget||o.toElement,W=Z,ye=ye?Pn(ye):null,ye!==null&&(Ne=c(ye),de=ye.tag,ye!==Ne||de!==5&&de!==27&&de!==6)&&(ye=null)):(W=null,ye=Z),W!==ye)){if(de=Nl,se="onMouseLeave",P="onMouseEnter",q="mouse",(e==="pointerout"||e==="pointerover")&&(de=$l,se="onPointerLeave",P="onPointerEnter",q="pointer"),Ne=W==null?K:Ui(W),F=ye==null?K:Ui(ye),K=new de(se,q+"leave",W,o,ne),K.target=Ne,K.relatedTarget=F,se=null,Pn(ne)===Z&&(de=new de(P,q+"enter",ye,o,ne),de.target=F,de.relatedTarget=Ne,se=de),Ne=se,W&&ye)t:{for(de=W,P=ye,q=0,F=de;F;F=Si(F))q++;for(F=0,se=P;se;se=Si(se))F++;for(;0<q-F;)de=Si(de),q--;for(;0<F-q;)P=Si(P),F--;for(;q--;){if(de===P||P!==null&&de===P.alternate)break t;de=Si(de),P=Si(P)}de=null}else de=null;W!==null&&Rf(ae,K,W,de,!1),ye!==null&&Ne!==null&&Rf(ae,Ne,ye,de,!0)}}e:{if(K=Z?Ui(Z):window,W=K.nodeName&&K.nodeName.toLowerCase(),W==="select"||W==="input"&&K.type==="file")var ce=ql;else if(Hl(K))if(Vl)ce=wd;else{ce=vd;var we=bd}else W=K.nodeName,!W||W.toLowerCase()!=="input"||K.type!=="checkbox"&&K.type!=="radio"?Z&&Js(Z.elementType)&&(ce=ql):ce=Ed;if(ce&&(ce=ce(e,Z))){zl(ae,ce,o,ne);break e}we&&we(e,K,Z),e==="focusout"&&Z&&K.type==="number"&&Z.memoizedProps.value!=null&&Ws(K,"number",K.value)}switch(we=Z?Ui(Z):window,e){case"focusin":(Hl(we)||we.contentEditable==="true")&&(ei=we,da=Z,qi=null);break;case"focusout":qi=da=ei=null;break;case"mousedown":pa=!0;break;case"contextmenu":case"mouseup":case"dragend":pa=!1,Ql(ae,o,ne);break;case"selectionchange":if(Rd)break;case"keydown":case"keyup":Ql(ae,o,ne)}var he;if(ua)e:{switch(e){case"compositionstart":var pe="onCompositionStart";break e;case"compositionend":pe="onCompositionEnd";break e;case"compositionupdate":pe="onCompositionUpdate";break e}pe=void 0}else Jn?Dl(e,o)&&(pe="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(pe="onCompositionStart");pe&&(Ml&&o.locale!=="ko"&&(Jn||pe!=="onCompositionStart"?pe==="onCompositionEnd"&&Jn&&(he=Cl()):(tn=ne,ra="value"in tn?tn.value:tn.textContent,Jn=!0)),we=Ts(Z,pe),0<we.length&&(pe=new Ul(pe,e,null,o,ne),ae.push({event:pe,listeners:we}),he?pe.data=he:(he=jl(o),he!==null&&(pe.data=he)))),(he=dd?pd(e,o):yd(e,o))&&(pe=Ts(Z,"onBeforeInput"),0<pe.length&&(we=new Ul("onBeforeInput","beforeinput",null,o,ne),ae.push({event:we,listeners:pe}),we.data=he)),sp(ae,e,Z,o,ne)}wf(ae,r)})}function yr(e,r,o){return{instance:e,listener:r,currentTarget:o}}function Ts(e,r){for(var o=r+"Capture",u=[];e!==null;){var f=e,p=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||p===null||(f=$i(e,o),f!=null&&u.unshift(yr(e,f,p)),f=$i(e,r),f!=null&&u.push(yr(e,f,p))),e.tag===3)return u;e=e.return}return[]}function Si(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Rf(e,r,o,u,f){for(var p=r._reactName,E=[];o!==null&&o!==u;){var x=o,M=x.alternate,Z=x.stateNode;if(x=x.tag,M!==null&&M===u)break;x!==5&&x!==26&&x!==27||Z===null||(M=Z,f?(Z=$i(o,p),Z!=null&&E.unshift(yr(o,Z,M))):f||(Z=$i(o,p),Z!=null&&E.push(yr(o,Z,M)))),o=o.return}E.length!==0&&e.push({event:r,listeners:E})}var up=/\r\n?/g,cp=/\u0000|\uFFFD/g;function Sf(e){return(typeof e=="string"?e:""+e).replace(up,`
`).replace(cp,"")}function _f(e,r){return r=Sf(r),Sf(e)===r}function As(){}function Be(e,r,o,u,f,p){switch(o){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||Qn(e,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&Qn(e,""+u);break;case"className":Ur(e,"class",u);break;case"tabIndex":Ur(e,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ur(e,o,u);break;case"style":kl(e,u,p);break;case"data":if(r!=="object"){Ur(e,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||o!=="href")){e.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(o);break}u=Lr(""+u),e.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){e.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(o==="formAction"?(r!=="input"&&Be(e,r,"name",f.name,f,null),Be(e,r,"formEncType",f.formEncType,f,null),Be(e,r,"formMethod",f.formMethod,f,null),Be(e,r,"formTarget",f.formTarget,f,null)):(Be(e,r,"encType",f.encType,f,null),Be(e,r,"method",f.method,f,null),Be(e,r,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(o);break}u=Lr(""+u),e.setAttribute(o,u);break;case"onClick":u!=null&&(e.onclick=As);break;case"onScroll":u!=null&&Re("scroll",e);break;case"onScrollEnd":u!=null&&Re("scrollend",e);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(o=u.__html,o!=null){if(f.children!=null)throw Error(a(60));e.innerHTML=o}}break;case"multiple":e.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":e.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){e.removeAttribute("xlink:href");break}o=Lr(""+u),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(o,""+u):e.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(o,""):e.removeAttribute(o);break;case"capture":case"download":u===!0?e.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(o,u):e.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?e.setAttribute(o,u):e.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?e.removeAttribute(o):e.setAttribute(o,u);break;case"popover":Re("beforetoggle",e),Re("toggle",e),Nr(e,"popover",u);break;case"xlinkActuate":Dt(e,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Dt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Dt(e,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Dt(e,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Dt(e,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Dt(e,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Dt(e,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Dt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Dt(e,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Nr(e,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=zh.get(o)||o,Nr(e,o,u))}}function Ho(e,r,o,u,f,p){switch(o){case"style":kl(e,u,p);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(o=u.__html,o!=null){if(f.children!=null)throw Error(a(60));e.innerHTML=o}}break;case"children":typeof u=="string"?Qn(e,u):(typeof u=="number"||typeof u=="bigint")&&Qn(e,""+u);break;case"onScroll":u!=null&&Re("scroll",e);break;case"onScrollEnd":u!=null&&Re("scrollend",e);break;case"onClick":u!=null&&(e.onclick=As);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!yl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),p=e[nt]||null,p=p!=null?p[o]:null,typeof p=="function"&&e.removeEventListener(r,p,f),typeof u=="function")){typeof p!="function"&&p!==null&&(o in e?e[o]=null:e.hasAttribute(o)&&e.removeAttribute(o)),e.addEventListener(r,u,f);break e}o in e?e[o]=u:u===!0?e.setAttribute(o,""):Nr(e,o,u)}}}function We(e,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Re("error",e),Re("load",e);var u=!1,f=!1,p;for(p in o)if(o.hasOwnProperty(p)){var E=o[p];if(E!=null)switch(p){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Be(e,r,p,E,o,null)}}f&&Be(e,r,"srcSet",o.srcSet,o,null),u&&Be(e,r,"src",o.src,o,null);return;case"input":Re("invalid",e);var x=p=E=f=null,M=null,Z=null;for(u in o)if(o.hasOwnProperty(u)){var ne=o[u];if(ne!=null)switch(u){case"name":f=ne;break;case"type":E=ne;break;case"checked":M=ne;break;case"defaultChecked":Z=ne;break;case"value":p=ne;break;case"defaultValue":x=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(a(137,r));break;default:Be(e,r,u,ne,o,null)}}xl(e,p,x,M,Z,E,f,!1),$r(e);return;case"select":Re("invalid",e),u=E=p=null;for(f in o)if(o.hasOwnProperty(f)&&(x=o[f],x!=null))switch(f){case"value":p=x;break;case"defaultValue":E=x;break;case"multiple":u=x;default:Be(e,r,f,x,o,null)}r=p,o=E,e.multiple=!!u,r!=null?Xn(e,!!u,r,!1):o!=null&&Xn(e,!!u,o,!0);return;case"textarea":Re("invalid",e),p=f=u=null;for(E in o)if(o.hasOwnProperty(E)&&(x=o[E],x!=null))switch(E){case"value":u=x;break;case"defaultValue":f=x;break;case"children":p=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(a(91));break;default:Be(e,r,E,x,o,null)}Sl(e,u,f,p),$r(e);return;case"option":for(M in o)if(o.hasOwnProperty(M)&&(u=o[M],u!=null))switch(M){case"selected":e.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Be(e,r,M,u,o,null)}return;case"dialog":Re("beforetoggle",e),Re("toggle",e),Re("cancel",e),Re("close",e);break;case"iframe":case"object":Re("load",e);break;case"video":case"audio":for(u=0;u<pr.length;u++)Re(pr[u],e);break;case"image":Re("error",e),Re("load",e);break;case"details":Re("toggle",e);break;case"embed":case"source":case"link":Re("error",e),Re("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in o)if(o.hasOwnProperty(Z)&&(u=o[Z],u!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Be(e,r,Z,u,o,null)}return;default:if(Js(r)){for(ne in o)o.hasOwnProperty(ne)&&(u=o[ne],u!==void 0&&Ho(e,r,ne,u,o,void 0));return}}for(x in o)o.hasOwnProperty(x)&&(u=o[x],u!=null&&Be(e,r,x,u,o,null))}function fp(e,r,o,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,p=null,E=null,x=null,M=null,Z=null,ne=null;for(W in o){var ae=o[W];if(o.hasOwnProperty(W)&&ae!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":M=ae;default:u.hasOwnProperty(W)||Be(e,r,W,null,u,ae)}}for(var K in u){var W=u[K];if(ae=o[K],u.hasOwnProperty(K)&&(W!=null||ae!=null))switch(K){case"type":p=W;break;case"name":f=W;break;case"checked":Z=W;break;case"defaultChecked":ne=W;break;case"value":E=W;break;case"defaultValue":x=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(a(137,r));break;default:W!==ae&&Be(e,r,K,W,u,ae)}}Ks(e,E,x,M,Z,ne,p,f);return;case"select":W=E=x=K=null;for(p in o)if(M=o[p],o.hasOwnProperty(p)&&M!=null)switch(p){case"value":break;case"multiple":W=M;default:u.hasOwnProperty(p)||Be(e,r,p,null,u,M)}for(f in u)if(p=u[f],M=o[f],u.hasOwnProperty(f)&&(p!=null||M!=null))switch(f){case"value":K=p;break;case"defaultValue":x=p;break;case"multiple":E=p;default:p!==M&&Be(e,r,f,p,u,M)}r=x,o=E,u=W,K!=null?Xn(e,!!o,K,!1):!!u!=!!o&&(r!=null?Xn(e,!!o,r,!0):Xn(e,!!o,o?[]:"",!1));return;case"textarea":W=K=null;for(x in o)if(f=o[x],o.hasOwnProperty(x)&&f!=null&&!u.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:Be(e,r,x,null,u,f)}for(E in u)if(f=u[E],p=o[E],u.hasOwnProperty(E)&&(f!=null||p!=null))switch(E){case"value":K=f;break;case"defaultValue":W=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==p&&Be(e,r,E,f,u,p)}Rl(e,K,W);return;case"option":for(var ye in o)if(K=o[ye],o.hasOwnProperty(ye)&&K!=null&&!u.hasOwnProperty(ye))switch(ye){case"selected":e.selected=!1;break;default:Be(e,r,ye,null,u,K)}for(M in u)if(K=u[M],W=o[M],u.hasOwnProperty(M)&&K!==W&&(K!=null||W!=null))switch(M){case"selected":e.selected=K&&typeof K!="function"&&typeof K!="symbol";break;default:Be(e,r,M,K,u,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var de in o)K=o[de],o.hasOwnProperty(de)&&K!=null&&!u.hasOwnProperty(de)&&Be(e,r,de,null,u,K);for(Z in u)if(K=u[Z],W=o[Z],u.hasOwnProperty(Z)&&K!==W&&(K!=null||W!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(a(137,r));break;default:Be(e,r,Z,K,u,W)}return;default:if(Js(r)){for(var Ne in o)K=o[Ne],o.hasOwnProperty(Ne)&&K!==void 0&&!u.hasOwnProperty(Ne)&&Ho(e,r,Ne,void 0,u,K);for(ne in u)K=u[ne],W=o[ne],!u.hasOwnProperty(ne)||K===W||K===void 0&&W===void 0||Ho(e,r,ne,K,u,W);return}}for(var P in o)K=o[P],o.hasOwnProperty(P)&&K!=null&&!u.hasOwnProperty(P)&&Be(e,r,P,null,u,K);for(ae in u)K=u[ae],W=o[ae],!u.hasOwnProperty(ae)||K===W||K==null&&W==null||Be(e,r,ae,K,u,W)}var zo=null,qo=null;function Cs(e){return e.nodeType===9?e:e.ownerDocument}function kf(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Tf(e,r){if(e===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&r==="foreignObject"?0:e}function Vo(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Io=null;function hp(){var e=window.event;return e&&e.type==="popstate"?e===Io?!1:(Io=e,!0):(Io=null,!1)}var Af=typeof setTimeout=="function"?setTimeout:void 0,dp=typeof clearTimeout=="function"?clearTimeout:void 0,Cf=typeof Promise=="function"?Promise:void 0,pp=typeof queueMicrotask=="function"?queueMicrotask:typeof Cf<"u"?function(e){return Cf.resolve(null).then(e).catch(yp)}:Af;function yp(e){setTimeout(function(){throw e})}function bn(e){return e==="head"}function Bf(e,r){var o=r,u=0,f=0;do{var p=o.nextSibling;if(e.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"){if(0<u&&8>u){o=u;var E=e.ownerDocument;if(o&1&&gr(E.documentElement),o&2&&gr(E.body),o&4)for(o=E.head,gr(o),E=o.firstChild;E;){var x=E.nextSibling,M=E.nodeName;E[Ni]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&E.rel.toLowerCase()==="stylesheet"||o.removeChild(E),E=x}}if(f===0){e.removeChild(p),Sr(r);return}f--}else o==="$"||o==="$?"||o==="$!"?f++:u=o.charCodeAt(0)-48;else u=0;o=p}while(o);Sr(r)}function Po(e){var r=e.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Po(o),Ys(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}e.removeChild(o)}}function gp(e,r,o,u){for(;e.nodeType===1;){var f=o;if(e.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(u){if(!e[Ni])switch(r){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(p=e.getAttribute("rel"),p==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(p!==f.rel||e.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||e.getAttribute("title")!==(f.title==null?null:f.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(p=e.getAttribute("src"),(p!==(f.src==null?null:f.src)||e.getAttribute("type")!==(f.type==null?null:f.type)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&p&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(r==="input"&&e.type==="hidden"){var p=f.name==null?null:""+f.name;if(f.type==="hidden"&&e.getAttribute("name")===p)return e}else return e;if(e=Bt(e.nextSibling),e===null)break}return null}function mp(e,r,o){if(r==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!o||(e=Bt(e.nextSibling),e===null))return null;return e}function Fo(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function bp(e,r){var o=e.ownerDocument;if(e.data!=="$?"||o.readyState==="complete")r();else{var u=function(){r(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),e._reactRetry=u}}function Bt(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return e}var Go=null;function Nf(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(r===0)return e;r--}else o==="/$"&&r++}e=e.previousSibling}return null}function Uf(e,r,o){switch(r=Cs(o),e){case"html":if(e=r.documentElement,!e)throw Error(a(452));return e;case"head":if(e=r.head,!e)throw Error(a(453));return e;case"body":if(e=r.body,!e)throw Error(a(454));return e;default:throw Error(a(451))}}function gr(e){for(var r=e.attributes;r.length;)e.removeAttributeNode(r[0]);Ys(e)}var Tt=new Map,$f=new Set;function Bs(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Kt=U.d;U.d={f:vp,r:Ep,D:wp,C:xp,L:Rp,m:Sp,X:kp,S:_p,M:Tp};function vp(){var e=Kt.f(),r=ws();return e||r}function Ep(e){var r=Fn(e);r!==null&&r.tag===5&&r.type==="form"?Wu(r):Kt.r(e)}var _i=typeof document>"u"?null:document;function Mf(e,r,o){var u=_i;if(u&&typeof r=="string"&&r){var f=Et(r);f='link[rel="'+e+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),$f.has(f)||($f.add(f),e={rel:e,crossOrigin:o,href:r},u.querySelector(f)===null&&(r=u.createElement("link"),We(r,"link",e),Fe(r),u.head.appendChild(r)))}}function wp(e){Kt.D(e),Mf("dns-prefetch",e,null)}function xp(e,r){Kt.C(e,r),Mf("preconnect",e,r)}function Rp(e,r,o){Kt.L(e,r,o);var u=_i;if(u&&e&&r){var f='link[rel="preload"][as="'+Et(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Et(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Et(o.imageSizes)+'"]')):f+='[href="'+Et(e)+'"]';var p=f;switch(r){case"style":p=ki(e);break;case"script":p=Ti(e)}Tt.has(p)||(e=b({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:e,as:r},o),Tt.set(p,e),u.querySelector(f)!==null||r==="style"&&u.querySelector(mr(p))||r==="script"&&u.querySelector(br(p))||(r=u.createElement("link"),We(r,"link",e),Fe(r),u.head.appendChild(r)))}}function Sp(e,r){Kt.m(e,r);var o=_i;if(o&&e){var u=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+Et(u)+'"][href="'+Et(e)+'"]',p=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=Ti(e)}if(!Tt.has(p)&&(e=b({rel:"modulepreload",href:e},r),Tt.set(p,e),o.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(br(p)))return}u=o.createElement("link"),We(u,"link",e),Fe(u),o.head.appendChild(u)}}}function _p(e,r,o){Kt.S(e,r,o);var u=_i;if(u&&e){var f=Gn(u).hoistableStyles,p=ki(e);r=r||"default";var E=f.get(p);if(!E){var x={loading:0,preload:null};if(E=u.querySelector(mr(p)))x.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":r},o),(o=Tt.get(p))&&Yo(e,o);var M=E=u.createElement("link");Fe(M),We(M,"link",e),M._p=new Promise(function(Z,ne){M.onload=Z,M.onerror=ne}),M.addEventListener("load",function(){x.loading|=1}),M.addEventListener("error",function(){x.loading|=2}),x.loading|=4,Ns(E,r,u)}E={type:"stylesheet",instance:E,count:1,state:x},f.set(p,E)}}}function kp(e,r){Kt.X(e,r);var o=_i;if(o&&e){var u=Gn(o).hoistableScripts,f=Ti(e),p=u.get(f);p||(p=o.querySelector(br(f)),p||(e=b({src:e,async:!0},r),(r=Tt.get(f))&&Zo(e,r),p=o.createElement("script"),Fe(p),We(p,"link",e),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function Tp(e,r){Kt.M(e,r);var o=_i;if(o&&e){var u=Gn(o).hoistableScripts,f=Ti(e),p=u.get(f);p||(p=o.querySelector(br(f)),p||(e=b({src:e,async:!0,type:"module"},r),(r=Tt.get(f))&&Zo(e,r),p=o.createElement("script"),Fe(p),We(p,"link",e),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function Lf(e,r,o,u){var f=(f=ue.current)?Bs(f):null;if(!f)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=ki(o.href),o=Gn(f).hoistableStyles,u=o.get(r),u||(u={type:"style",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){e=ki(o.href);var p=Gn(f).hoistableStyles,E=p.get(e);if(E||(f=f.ownerDocument||f,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(e,E),(p=f.querySelector(mr(e)))&&!p._p&&(E.instance=p,E.state.loading=5),Tt.has(e)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Tt.set(e,o),p||Ap(f,e,o,E.state))),r&&u===null)throw Error(a(528,""));return E}if(r&&u!==null)throw Error(a(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Ti(o),o=Gn(f).hoistableScripts,u=o.get(r),u||(u={type:"script",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function ki(e){return'href="'+Et(e)+'"'}function mr(e){return'link[rel="stylesheet"]['+e+"]"}function Of(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function Ap(e,r,o,u){e.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=e.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),We(r,"link",o),Fe(r),e.head.appendChild(r))}function Ti(e){return'[src="'+Et(e)+'"]'}function br(e){return"script[async]"+e}function Df(e,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var u=e.querySelector('style[data-href~="'+Et(o.href)+'"]');if(u)return r.instance=u,Fe(u),u;var f=b({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(e.ownerDocument||e).createElement("style"),Fe(u),We(u,"style",f),Ns(u,o.precedence,e),r.instance=u;case"stylesheet":f=ki(o.href);var p=e.querySelector(mr(f));if(p)return r.state.loading|=4,r.instance=p,Fe(p),p;u=Of(o),(f=Tt.get(f))&&Yo(u,f),p=(e.ownerDocument||e).createElement("link"),Fe(p);var E=p;return E._p=new Promise(function(x,M){E.onload=x,E.onerror=M}),We(p,"link",u),r.state.loading|=4,Ns(p,o.precedence,e),r.instance=p;case"script":return p=Ti(o.src),(f=e.querySelector(br(p)))?(r.instance=f,Fe(f),f):(u=o,(f=Tt.get(p))&&(u=b({},o),Zo(u,f)),e=e.ownerDocument||e,f=e.createElement("script"),Fe(f),We(f,"link",u),e.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(a(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Ns(u,o.precedence,e));return r.instance}function Ns(e,r,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,p=f,E=0;E<u.length;E++){var x=u[E];if(x.dataset.precedence===r)p=x;else if(p!==f)break}p?p.parentNode.insertBefore(e,p.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(e,r.firstChild))}function Yo(e,r){e.crossOrigin==null&&(e.crossOrigin=r.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=r.referrerPolicy),e.title==null&&(e.title=r.title)}function Zo(e,r){e.crossOrigin==null&&(e.crossOrigin=r.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=r.referrerPolicy),e.integrity==null&&(e.integrity=r.integrity)}var Us=null;function jf(e,r,o){if(Us===null){var u=new Map,f=Us=new Map;f.set(o,u)}else f=Us,u=f.get(o),u||(u=new Map,f.set(o,u));if(u.has(e))return u;for(u.set(e,null),o=o.getElementsByTagName(e),f=0;f<o.length;f++){var p=o[f];if(!(p[Ni]||p[Je]||e==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var E=p.getAttribute(r)||"";E=e+E;var x=u.get(E);x?x.push(p):u.set(E,[p])}}return u}function Hf(e,r,o){e=e.ownerDocument||e,e.head.insertBefore(o,r==="title"?e.querySelector("head > title"):null)}function Cp(e,r,o){if(o===1||r.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return e=r.disabled,typeof r.precedence=="string"&&e==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function zf(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var vr=null;function Bp(){}function Np(e,r,o){if(vr===null)throw Error(a(475));var u=vr;if(r.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var f=ki(o.href),p=e.querySelector(mr(f));if(p){e=p._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(u.count++,u=$s.bind(u),e.then(u,u)),r.state.loading|=4,r.instance=p,Fe(p);return}p=e.ownerDocument||e,o=Of(o),(f=Tt.get(f))&&Yo(o,f),p=p.createElement("link"),Fe(p);var E=p;E._p=new Promise(function(x,M){E.onload=x,E.onerror=M}),We(p,"link",o),r.instance=p}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(r,e),(e=r.state.preload)&&(r.state.loading&3)===0&&(u.count++,r=$s.bind(u),e.addEventListener("load",r),e.addEventListener("error",r))}}function Up(){if(vr===null)throw Error(a(475));var e=vr;return e.stylesheets&&e.count===0&&Xo(e,e.stylesheets),0<e.count?function(r){var o=setTimeout(function(){if(e.stylesheets&&Xo(e,e.stylesheets),e.unsuspend){var u=e.unsuspend;e.unsuspend=null,u()}},6e4);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(o)}}:null}function $s(){if(this.count--,this.count===0){if(this.stylesheets)Xo(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Ms=null;function Xo(e,r){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Ms=new Map,r.forEach($p,e),Ms=null,$s.call(e))}function $p(e,r){if(!(r.state.loading&4)){var o=Ms.get(e);if(o)var u=o.get(null);else{o=new Map,Ms.set(e,o);for(var f=e.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<f.length;p++){var E=f[p];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),u=E)}u&&o.set(null,u)}f=r.instance,E=f.getAttribute("data-precedence"),p=o.get(E)||u,p===u&&o.set(null,f),o.set(E,f),this.count++,u=$s.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),p?p.parentNode.insertBefore(f,p.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(f,e.firstChild)),r.state.loading|=4}}var Er={$$typeof:V,Provider:null,Consumer:null,_currentValue:Y,_currentValue2:Y,_threadCount:0};function Mp(e,r,o,u,f,p,E,x){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Is(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Is(0),this.hiddenUpdates=Is(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=p,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=x,this.incompleteTransitions=new Map}function qf(e,r,o,u,f,p,E,x,M,Z,ne,ae){return e=new Mp(e,r,o,E,x,M,Z,ae),r=1,p===!0&&(r|=24),p=ht(3,null,null,r),e.current=p,p.stateNode=e,r=Ca(),r.refCount++,e.pooledCache=r,r.refCount++,p.memoizedState={element:u,isDehydrated:o,cache:r},$a(p),e}function Vf(e){return e?(e=ri,e):ri}function If(e,r,o,u,f,p){f=Vf(f),u.context===null?u.context=f:u.pendingContext=f,u=sn(r),u.payload={element:o},p=p===void 0?null:p,p!==null&&(u.callback=p),o=an(e,u,r),o!==null&&(mt(o,e,r),Qi(o,e,r))}function Pf(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<r?o:r}}function Qo(e,r){Pf(e,r),(e=e.alternate)&&Pf(e,r)}function Ff(e){if(e.tag===13){var r=ii(e,67108864);r!==null&&mt(r,e,67108864),Qo(e,67108864)}}var Ls=!0;function Lp(e,r,o,u){var f=R.T;R.T=null;var p=U.p;try{U.p=2,Ko(e,r,o,u)}finally{U.p=p,R.T=f}}function Op(e,r,o,u){var f=R.T;R.T=null;var p=U.p;try{U.p=8,Ko(e,r,o,u)}finally{U.p=p,R.T=f}}function Ko(e,r,o,u){if(Ls){var f=Wo(u);if(f===null)jo(e,r,u,Os,o),Yf(e,u);else if(jp(f,e,r,o,u))u.stopPropagation();else if(Yf(e,u),r&4&&-1<Dp.indexOf(e)){for(;f!==null;){var p=Fn(f);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var E=Sn(p.pendingLanes);if(E!==0){var x=p;for(x.pendingLanes|=2,x.entangledLanes|=2;E;){var M=1<<31-ct(E);x.entanglements[1]|=M,E&=~M}Ot(p),(Te&6)===0&&(vs=Nt()+500,dr(0))}}break;case 13:x=ii(p,2),x!==null&&mt(x,p,2),ws(),Qo(p,2)}if(p=Wo(u),p===null&&jo(e,r,u,Os,o),p===f)break;f=p}f!==null&&u.stopPropagation()}else jo(e,r,u,null,o)}}function Wo(e){return e=ta(e),Jo(e)}var Os=null;function Jo(e){if(Os=null,e=Pn(e),e!==null){var r=c(e);if(r===null)e=null;else{var o=r.tag;if(o===13){if(e=h(r),e!==null)return e;e=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null)}}return Os=e,null}function Gf(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xh()){case sl:return 2;case al:return 8;case Tr:case Rh:return 32;case ol:return 268435456;default:return 32}default:return 32}}var el=!1,vn=null,En=null,wn=null,wr=new Map,xr=new Map,xn=[],Dp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Yf(e,r){switch(e){case"focusin":case"focusout":vn=null;break;case"dragenter":case"dragleave":En=null;break;case"mouseover":case"mouseout":wn=null;break;case"pointerover":case"pointerout":wr.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":xr.delete(r.pointerId)}}function Rr(e,r,o,u,f,p){return e===null||e.nativeEvent!==p?(e={blockedOn:r,domEventName:o,eventSystemFlags:u,nativeEvent:p,targetContainers:[f]},r!==null&&(r=Fn(r),r!==null&&Ff(r)),e):(e.eventSystemFlags|=u,r=e.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),e)}function jp(e,r,o,u,f){switch(r){case"focusin":return vn=Rr(vn,e,r,o,u,f),!0;case"dragenter":return En=Rr(En,e,r,o,u,f),!0;case"mouseover":return wn=Rr(wn,e,r,o,u,f),!0;case"pointerover":var p=f.pointerId;return wr.set(p,Rr(wr.get(p)||null,e,r,o,u,f)),!0;case"gotpointercapture":return p=f.pointerId,xr.set(p,Rr(xr.get(p)||null,e,r,o,u,f)),!0}return!1}function Zf(e){var r=Pn(e.target);if(r!==null){var o=c(r);if(o!==null){if(r=o.tag,r===13){if(r=h(o),r!==null){e.blockedOn=r,Nh(e.priority,function(){if(o.tag===13){var u=gt();u=Ps(u);var f=ii(o,u);f!==null&&mt(f,o,u),Qo(o,u)}});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ds(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var o=Wo(e.nativeEvent);if(o===null){o=e.nativeEvent;var u=new o.constructor(o.type,o);ea=u,o.target.dispatchEvent(u),ea=null}else return r=Fn(o),r!==null&&Ff(r),e.blockedOn=o,!1;r.shift()}return!0}function Xf(e,r,o){Ds(e)&&o.delete(r)}function Hp(){el=!1,vn!==null&&Ds(vn)&&(vn=null),En!==null&&Ds(En)&&(En=null),wn!==null&&Ds(wn)&&(wn=null),wr.forEach(Xf),xr.forEach(Xf)}function js(e,r){e.blockedOn===r&&(e.blockedOn=null,el||(el=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Hp)))}var Hs=null;function Qf(e){Hs!==e&&(Hs=e,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Hs===e&&(Hs=null);for(var r=0;r<e.length;r+=3){var o=e[r],u=e[r+1],f=e[r+2];if(typeof u!="function"){if(Jo(u||o)===null)continue;break}var p=Fn(o);p!==null&&(e.splice(r,3),r-=3,Wa(p,{pending:!0,data:f,method:o.method,action:u},u,f))}}))}function Sr(e){function r(M){return js(M,e)}vn!==null&&js(vn,e),En!==null&&js(En,e),wn!==null&&js(wn,e),wr.forEach(r),xr.forEach(r);for(var o=0;o<xn.length;o++){var u=xn[o];u.blockedOn===e&&(u.blockedOn=null)}for(;0<xn.length&&(o=xn[0],o.blockedOn===null);)Zf(o),o.blockedOn===null&&xn.shift();if(o=(e.ownerDocument||e).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var f=o[u],p=o[u+1],E=f[nt]||null;if(typeof p=="function")E||Qf(o);else if(E){var x=null;if(p&&p.hasAttribute("formAction")){if(f=p,E=p[nt]||null)x=E.formAction;else if(Jo(f)!==null)continue}else x=E.action;typeof x=="function"?o[u+1]=x:(o.splice(u,3),u-=3),Qf(o)}}}function tl(e){this._internalRoot=e}zs.prototype.render=tl.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(a(409));var o=r.current,u=gt();If(o,u,e,r,null,null)},zs.prototype.unmount=tl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;If(e.current,2,null,e,null,null),ws(),r[In]=null}};function zs(e){this._internalRoot=e}zs.prototype.unstable_scheduleHydration=function(e){if(e){var r=hl();e={blockedOn:null,target:e,priority:r};for(var o=0;o<xn.length&&r!==0&&r<xn[o].priority;o++);xn.splice(o,0,e),o===0&&Zf(e)}};var Kf=n.version;if(Kf!=="19.1.1")throw Error(a(527,Kf,"19.1.1"));U.findDOMNode=function(e){var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=g(r),e=e!==null?m(e):null,e=e===null?null:e.stateNode,e};var zp={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qs.isDisabled&&qs.supportsFiber)try{Ai=qs.inject(zp),lt=qs}catch{}}return reactDomClient_production.createRoot=function(e,r){if(!l(e))throw Error(a(299));var o=!1,u="",f=hc,p=dc,E=pc,x=null;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(p=r.onCaughtError),r.onRecoverableError!==void 0&&(E=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(x=r.unstable_transitionCallbacks)),r=qf(e,1,!1,null,null,o,u,f,p,E,x,null),e[In]=r.current,Do(e),new tl(r)},reactDomClient_production.hydrateRoot=function(e,r,o){if(!l(e))throw Error(a(299));var u=!1,f="",p=hc,E=dc,x=pc,M=null,Z=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(x=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(M=o.unstable_transitionCallbacks),o.formState!==void 0&&(Z=o.formState)),r=qf(e,1,!0,r,o??null,u,f,p,E,x,M,Z),r.context=Vf(null),o=r.current,u=gt(),u=Ps(u),f=sn(u),f.callback=null,an(o,f,u),o=u,r.current.lanes=o,Bi(r,o),Ot(r),e[In]=r.current,Do(e),new zs(r)},reactDomClient_production.version="19.1.1",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}return t(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);var lib$1={},types={},hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0})),types}var ee={},taskCollection$1={},taskCollection={},utils$1={},hasRequiredUtils$1;function requireUtils$1(){if(hasRequiredUtils$1)return utils$1;hasRequiredUtils$1=1,Object.defineProperty(utils$1,"__esModule",{value:!0}),utils$1._fast_remove_single=void 0;function t(n,s){s!==-1&&(s===0?n.shift():s===n.length-1?n.length=n.length-1:n.splice(s,1))}return utils$1._fast_remove_single=t,utils$1}var bakeCollection={},hasRequiredBakeCollection;function requireBakeCollection(){return hasRequiredBakeCollection||(hasRequiredBakeCollection=1,(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.bakeCollectionVariadic=exports.bakeCollectionAwait=exports.bakeCollection=exports.BAKED_EMPTY_FUNC=void 0,exports.BAKED_EMPTY_FUNC=(function(){});var FORLOOP_FALLBACK=1500;function generateArgsDefCode(t){var n="";if(t===0)return n;for(var s=0;s<t-1;++s)n+="arg"+String(s)+", ";return n+="arg"+String(t-1),n}function generateBodyPartsCode(t,n){for(var s="",a="",l=0;l<n;++l)s+="var f".concat(l," = collection[").concat(l,`];
`),a+="f".concat(l,"(").concat(t,`)
`);return{funcDefCode:s,funcCallCode:a}}function generateBodyPartsVariadicCode(t){for(var n="",s="",a=0;a<t;++a)n+="var f".concat(a," = collection[").concat(a,`];
`),s+="f".concat(a,`.apply(undefined, arguments)
`);return{funcDefCode:n,funcCallCode:s}}function bakeCollection(collection,fixedArgsNum){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                `).concat(funcCallCode,`
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);collection.length%10===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 10) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                        collection[i+4](`).concat(argsDefCode,`);
                        collection[i+5](`).concat(argsDefCode,`);
                        collection[i+6](`).concat(argsDefCode,`);
                        collection[i+7](`).concat(argsDefCode,`);
                        collection[i+8](`).concat(argsDefCode,`);
                        collection[i+9](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%4===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 4) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%3===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 3) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                    }
                });
            })`):funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; ++i) {
                        collection[i](`).concat(argsDefCode,`);
                    }
                });
            })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollection=bakeCollection;function bakeCollectionAwait(collection,fixedArgsNum){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                return Promise.all([ `).concat(funcCallCode,` ]);
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);funcFactoryCode=`(function(collection) {
            return (function(`.concat(argsDefCode,`) {
                var promises = Array(collection.length);
                for (var i = 0; i < collection.length; ++i) {
                    promises[i] = collection[i](`).concat(argsDefCode,`);
                }
                return Promise.all(promises);
            });
        })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollectionAwait=bakeCollectionAwait;function bakeCollectionVariadic(collection){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var _a=generateBodyPartsVariadicCode(collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function() {
                `).concat(funcCallCode,`
            });
        })`)}else funcFactoryCode=`(function(collection) {
            return (function() {
                for (var i = 0; i < collection.length; ++i) {
                    collection[i].apply(undefined, arguments);
                }
            });
        })`;{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollectionVariadic=bakeCollectionVariadic})(bakeCollection)),bakeCollection}var hasRequiredTaskCollection$1;function requireTaskCollection$1(){if(hasRequiredTaskCollection$1)return taskCollection;hasRequiredTaskCollection$1=1;var t=taskCollection&&taskCollection.__spreadArray||function(V,ie,k){if(k||arguments.length===2)for(var $=0,j=ie.length,I;$<j;$++)(I||!($ in ie))&&(I||(I=Array.prototype.slice.call(ie,0,$)),I[$]=ie[$]);return V.concat(I||Array.prototype.slice.call(ie))};Object.defineProperty(taskCollection,"__esModule",{value:!0}),taskCollection.TaskCollection=void 0;var n=requireUtils$1(),s=requireBakeCollection();function a(V,ie){var k=this.length;if(k>1)if(ie){var $;($=this._tasks).push.apply($,arguments),this.length+=arguments.length}else this._tasks.push(V),this.length++;else if(ie){if(k===1){var j=Array(1+arguments.length);j.push(j),j.push.apply(j,arguments),this._tasks=j}else{var j=Array(arguments.length);j.push.apply(j,arguments),this._tasks=j}this.length+=arguments.length}else k===1?this._tasks=[this._tasks,V]:this._tasks=V,this.length++}function l(V,ie){var k=this.length;if(k>1)if(ie){var $;($=this._tasks).push.apply($,arguments),this.length+=arguments.length}else this._tasks.push(V),this.length++;else if(ie){if(k===1){var j=Array(1+arguments.length);j.push(j),j.push.apply(j,arguments),this._tasks=j}else{var j=Array(arguments.length);j.push.apply(j,arguments),this._tasks=j}this.length+=arguments.length}else k===1?this._tasks=[this._tasks,V]:this._tasks=V,this.length++;this.firstEmitBuildStrategy?this.call=v:this.rebuild()}function c(V){this.length!==0&&(this.length===1?this._tasks===V&&(this.length=0):((0,n._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(V)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length))}function h(V){if(this.length!==0){if(this.length===1)if(this._tasks===V&&(this.length=0),this.firstEmitBuildStrategy){this.call=s.BAKED_EMPTY_FUNC;return}else{this.rebuild();return}else(0,n._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(V)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length;this.firstEmitBuildStrategy?this.call=v:this.rebuild()}}function y(V){for(var ie,k=[],$=1;$<arguments.length;$++)k[$-1]=arguments[$];this.length===0?(this._tasks=k,this.length=1):this.length===1?(k.unshift(this._tasks),this._tasks=k,this.length=this._tasks.length):((ie=this._tasks).splice.apply(ie,t([V,0],k,!1)),this.length=this._tasks.length)}function g(V){for(var ie,k=[],$=1;$<arguments.length;$++)k[$-1]=arguments[$];this.length===0?(this._tasks=k,this.length=1):this.length===1?(k.unshift(this._tasks),this._tasks=k,this.length=this._tasks.length):((ie=this._tasks).splice.apply(ie,t([V,0],k,!1)),this.length=this._tasks.length),this.firstEmitBuildStrategy?this.call=v:this.rebuild()}function m(){this.length===0?this.call=s.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,s.bakeCollection)(this._tasks,this.argsNum)}function b(){this.length===0?this.call=s.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,s.bakeCollectionAwait)(this._tasks,this.argsNum)}function v(){this.rebuild(),this.call.apply(void 0,arguments)}var w=(function(){function V(ie,k,$,j){k===void 0&&(k=!0),$===void 0&&($=null),j===void 0&&(j=!1),this.awaitTasks=j,this.call=s.BAKED_EMPTY_FUNC,this.argsNum=ie,this.firstEmitBuildStrategy=!0,j?this.rebuild=b.bind(this):this.rebuild=m.bind(this),this.setAutoRebuild(k),$?typeof $=="function"?(this._tasks=$,this.length=1):(this._tasks=$,this.length=$.length):(this._tasks=null,this.length=0),k&&this.rebuild()}return V})();taskCollection.TaskCollection=w;function S(){this._tasks=null,this.length=0,this.call=s.BAKED_EMPTY_FUNC}function A(){this._tasks=null,this.length=0,this.call=s.BAKED_EMPTY_FUNC}function B(V){this.argsNum<V&&(this.argsNum=V,this.firstEmitBuildStrategy?this.call=v:this.rebuild())}function N(V){V?(this.push=l.bind(this),this.insert=g.bind(this),this.removeLast=h.bind(this)):(this.push=a.bind(this),this.insert=y.bind(this),this.removeLast=c.bind(this))}function L(){return this.length===0?[]:this.length===1?[this._tasks]:this._tasks}function G(V){V.length===0?(this.length=0,this.call=s.BAKED_EMPTY_FUNC):V.length===1?(this.length=1,this.call=V[0],this._tasks=V[0]):(this.length=V.length,this._tasks=V,this.firstEmitBuildStrategy?this.call=v:this.rebuild())}return w.prototype.fastClear=S,w.prototype.clear=A,w.prototype.growArgsNum=B,w.prototype.setAutoRebuild=N,w.prototype.tasksAsArray=L,w.prototype.setTasks=G,taskCollection}var hasRequiredTaskCollection;function requireTaskCollection(){return hasRequiredTaskCollection||(hasRequiredTaskCollection=1,(function(t){var n=taskCollection$1&&taskCollection$1.__createBinding||(Object.create?(function(a,l,c,h){h===void 0&&(h=c);var y=Object.getOwnPropertyDescriptor(l,c);(!y||("get"in y?!l.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return l[c]}}),Object.defineProperty(a,h,y)}):(function(a,l,c,h){h===void 0&&(h=c),a[h]=l[c]})),s=taskCollection$1&&taskCollection$1.__exportStar||function(a,l){for(var c in a)c!=="default"&&!Object.prototype.hasOwnProperty.call(l,c)&&n(l,a,c)};Object.defineProperty(t,"__esModule",{value:!0}),s(requireTaskCollection$1(),t)})(taskCollection$1)),taskCollection$1}var utils={},hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1,Object.defineProperty(utils,"__esModule",{value:!0}),utils.nullObj=void 0;function t(){var n={};return n.__proto__=null,n}return utils.nullObj=t,utils}var hasRequiredEe;function requireEe(){if(hasRequiredEe)return ee;hasRequiredEe=1;var t=ee&&ee.__spreadArray||function(k,$,j){if(j||arguments.length===2)for(var I=0,X=$.length,te;I<X;I++)(te||!(I in $))&&(te||(te=Array.prototype.slice.call($,0,I)),te[I]=$[I]);return k.concat(te||Array.prototype.slice.call($))};Object.defineProperty(ee,"__esModule",{value:!0}),ee.EventEmitter=void 0;var n=requireTaskCollection(),s=requireUtils$1(),a=requireUtils();function l(k,$,j,I,X,te){var H=this.events[k];if(H){if(H.length===0)return!1;if(H.argsNum<6)H.call($,j,I,X,te);else{for(var z=new Array(H.argsNum),C=0,O=z.length;C<O;++C)z[C]=arguments[C+1];H.call.apply(void 0,z)}return!0}return!1}function c(k,$,j,I,X,te){var H=this.events[k],z;if(H!==void 0){if(H.length===0)return!1;if(H.argsNum<6)H.call($,j,I,X,te);else{z=new Array(H.argsNum);for(var C=0,O=z.length;C<O;++C)z[C]=arguments[C+1];H.call.apply(void 0,z)}}var _=this.onceEvents[k];if(_){if(typeof _=="function")if(this.onceEvents[k]=void 0,arguments.length<6)_($,j,I,X,te);else{if(z===void 0){z=new Array(arguments.length-1);for(var C=0,O=z.length;C<O;++C)z[C]=arguments[C+1]}_.apply(void 0,z)}else{var R=_;if(this.onceEvents[k]=void 0,arguments.length<6)for(var C=0;C<R.length;++C)R[C]($,j,I,X,te);else{if(z===void 0){z=new Array(arguments.length-1);for(var C=0,O=z.length;C<O;++C)z[C]=arguments[C+1]}for(var C=0;C<R.length;++C)R[C].apply(void 0,z)}}return!0}return H!==void 0}var h=(function(){function k(){this.events=(0,a.nullObj)(),this.onceEvents=(0,a.nullObj)(),this._symbolKeys=new Set,this.maxListeners=1/0}return Object.defineProperty(k.prototype,"_eventsCount",{get:function(){return this.eventNames().length},enumerable:!1,configurable:!0}),k})();ee.EventEmitter=h;function y(k,$){switch(this.emit===l&&(this.emit=c),typeof this.onceEvents[k]){case"undefined":this.onceEvents[k]=$,typeof k=="symbol"&&this._symbolKeys.add(k);break;case"function":this.onceEvents[k]=[this.onceEvents[k],$];break;case"object":this.onceEvents[k].push($)}return this}function g(k,$,j){if(j===void 0&&(j=$.length),typeof $!="function")throw new TypeError("The listener must be a function");var I=this.events[k];return I?(I.push($),I.growArgsNum(j),this.maxListeners!==1/0&&this.maxListeners<=I.length&&console.warn('Maximum event listeners for "'.concat(String(k),'" event!'))):(this.events[k]=new n.TaskCollection(j,!0,$,!1),typeof k=="symbol"&&this._symbolKeys.add(k)),this}function m(k,$){var j=this.events[k];j&&j.removeLast($);var I=this.onceEvents[k];return I&&(typeof I=="function"?this.onceEvents[k]=void 0:typeof I=="object"&&(I.length===1&&I[0]===$?this.onceEvents[k]=void 0:(0,s._fast_remove_single)(I,I.lastIndexOf($)))),this}function b(k,$,j,I){j===void 0&&(j=this),I===void 0&&(I=$.length),this.boundFuncs||(this.boundFuncs=new Map);var X=$.bind(j);return this.boundFuncs.set($,X),this.addListener(k,X,I)}function v(k,$){var j,I,X=(j=this.boundFuncs)===null||j===void 0?void 0:j.get($);return(I=this.boundFuncs)===null||I===void 0||I.delete($),this.removeListener(k,X)}function w(k){return this.events[k]&&!!this.events[k].length}function S(k,$,j){if(j===void 0&&(j=$.length),typeof $!="function")throw new TypeError("The listener must be a function");var I=this.events[k];return!I||!(I instanceof n.TaskCollection)?(I=this.events[k]=new n.TaskCollection(j,!0,$,!1),typeof k=="symbol"&&this._symbolKeys.add(k)):(I.insert(0,$),I.growArgsNum(j),this.maxListeners!==1/0&&this.maxListeners<=I.length&&console.warn('Maximum event listeners for "'.concat(String(k),'" event!'))),this}function A(k,$){this.emit===l&&(this.emit=c);var j=this.onceEvents[k];return j?typeof j!="object"?(this.onceEvents[k]=[$,j],typeof k=="symbol"&&this._symbolKeys.add(k)):(j.unshift($),this.maxListeners!==1/0&&this.maxListeners<=j.length&&console.warn('Maximum event listeners for "'.concat(String(k),'" once event!'))):(this.onceEvents[k]=[$],typeof k=="symbol"&&this._symbolKeys.add(k)),this}function B(k){return k===void 0?(this.events=(0,a.nullObj)(),this.onceEvents=(0,a.nullObj)(),this._symbolKeys=new Set):(this.events[k]=void 0,this.onceEvents[k]=void 0,typeof k=="symbol"&&this._symbolKeys.delete(k)),this}function N(k){return this.maxListeners=k,this}function L(){return this.maxListeners}function G(k){return this.emit===l?this.events[k]?this.events[k].tasksAsArray().slice():[]:this.events[k]&&this.onceEvents[k]?t(t([],this.events[k].tasksAsArray(),!0),typeof this.onceEvents[k]=="function"?[this.onceEvents[k]]:this.onceEvents[k],!0):this.events[k]?this.events[k].tasksAsArray():this.onceEvents[k]?typeof this.onceEvents[k]=="function"?[this.onceEvents[k]]:this.onceEvents[k]:[]}function V(){var k=this;if(this.emit===l){var $=Object.keys(this.events);return t(t([],$,!0),Array.from(this._symbolKeys),!0).filter(function(I){return I in k.events&&k.events[I]&&k.events[I].length})}else{var $=Object.keys(this.events).filter(function(X){return k.events[X]&&k.events[X].length}),j=Object.keys(this.onceEvents).filter(function(X){return k.onceEvents[X]&&k.onceEvents[X].length});return t(t(t([],$,!0),j,!0),Array.from(this._symbolKeys).filter(function(X){return X in k.events&&k.events[X]&&k.events[X].length||X in k.onceEvents&&k.onceEvents[X]&&k.onceEvents[X].length}),!0)}}function ie(k){return this.emit===l?this.events[k]&&this.events[k].length||0:(this.events[k]&&this.events[k].length||0)+(this.onceEvents[k]&&this.onceEvents[k].length||0)}return h.prototype.emit=l,h.prototype.on=g,h.prototype.once=y,h.prototype.addListener=g,h.prototype.removeListener=m,h.prototype.addListenerBound=b,h.prototype.removeListenerBound=v,h.prototype.hasListeners=w,h.prototype.prependListener=S,h.prototype.prependOnceListener=A,h.prototype.off=m,h.prototype.removeAllListeners=B,h.prototype.setMaxListeners=N,h.prototype.getMaxListeners=L,h.prototype.listeners=G,h.prototype.eventNames=V,h.prototype.listenerCount=ie,ee}var hasRequiredLib$1;function requireLib$1(){return hasRequiredLib$1||(hasRequiredLib$1=1,(function(t){var n=lib$1&&lib$1.__createBinding||(Object.create?(function(a,l,c,h){h===void 0&&(h=c);var y=Object.getOwnPropertyDescriptor(l,c);(!y||("get"in y?!l.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return l[c]}}),Object.defineProperty(a,h,y)}):(function(a,l,c,h){h===void 0&&(h=c),a[h]=l[c]})),s=lib$1&&lib$1.__exportStar||function(a,l){for(var c in a)c!=="default"&&!Object.prototype.hasOwnProperty.call(l,c)&&n(l,a,c)};Object.defineProperty(t,"__esModule",{value:!0}),s(requireTypes(),t),s(requireEe(),t)})(lib$1)),lib$1}var libExports=requireLib$1(),browser={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var t=1e3,n=t*60,s=n*60,a=s*24,l=a*7,c=a*365.25;ms=function(b,v){v=v||{};var w=typeof b;if(w==="string"&&b.length>0)return h(b);if(w==="number"&&isFinite(b))return v.long?g(b):y(b);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(b))};function h(b){if(b=String(b),!(b.length>100)){var v=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(b);if(v){var w=parseFloat(v[1]),S=(v[2]||"ms").toLowerCase();switch(S){case"years":case"year":case"yrs":case"yr":case"y":return w*c;case"weeks":case"week":case"w":return w*l;case"days":case"day":case"d":return w*a;case"hours":case"hour":case"hrs":case"hr":case"h":return w*s;case"minutes":case"minute":case"mins":case"min":case"m":return w*n;case"seconds":case"second":case"secs":case"sec":case"s":return w*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return w;default:return}}}}function y(b){var v=Math.abs(b);return v>=a?Math.round(b/a)+"d":v>=s?Math.round(b/s)+"h":v>=n?Math.round(b/n)+"m":v>=t?Math.round(b/t)+"s":b+"ms"}function g(b){var v=Math.abs(b);return v>=a?m(b,v,a,"day"):v>=s?m(b,v,s,"hour"):v>=n?m(b,v,n,"minute"):v>=t?m(b,v,t,"second"):b+" ms"}function m(b,v,w,S){var A=v>=w*1.5;return Math.round(b/w)+" "+S+(A?"s":"")}return ms}var common,hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;hasRequiredCommon=1;function t(n){a.debug=a,a.default=a,a.coerce=m,a.disable=y,a.enable=c,a.enabled=g,a.humanize=requireMs(),a.destroy=b,Object.keys(n).forEach(v=>{a[v]=n[v]}),a.names=[],a.skips=[],a.formatters={};function s(v){let w=0;for(let S=0;S<v.length;S++)w=(w<<5)-w+v.charCodeAt(S),w|=0;return a.colors[Math.abs(w)%a.colors.length]}a.selectColor=s;function a(v){let w,S=null,A,B;function N(...L){if(!N.enabled)return;const G=N,V=Number(new Date),ie=V-(w||V);G.diff=ie,G.prev=w,G.curr=V,w=V,L[0]=a.coerce(L[0]),typeof L[0]!="string"&&L.unshift("%O");let k=0;L[0]=L[0].replace(/%([a-zA-Z%])/g,(j,I)=>{if(j==="%%")return"%";k++;const X=a.formatters[I];if(typeof X=="function"){const te=L[k];j=X.call(G,te),L.splice(k,1),k--}return j}),a.formatArgs.call(G,L),(G.log||a.log).apply(G,L)}return N.namespace=v,N.useColors=a.useColors(),N.color=a.selectColor(v),N.extend=l,N.destroy=a.destroy,Object.defineProperty(N,"enabled",{enumerable:!0,configurable:!1,get:()=>S!==null?S:(A!==a.namespaces&&(A=a.namespaces,B=a.enabled(v)),B),set:L=>{S=L}}),typeof a.init=="function"&&a.init(N),N}function l(v,w){const S=a(this.namespace+(typeof w>"u"?":":w)+v);return S.log=this.log,S}function c(v){a.save(v),a.namespaces=v,a.names=[],a.skips=[];const w=(typeof v=="string"?v:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const S of w)S[0]==="-"?a.skips.push(S.slice(1)):a.names.push(S)}function h(v,w){let S=0,A=0,B=-1,N=0;for(;S<v.length;)if(A<w.length&&(w[A]===v[S]||w[A]==="*"))w[A]==="*"?(B=A,N=S,A++):(S++,A++);else if(B!==-1)A=B+1,N++,S=N;else return!1;for(;A<w.length&&w[A]==="*";)A++;return A===w.length}function y(){const v=[...a.names,...a.skips.map(w=>"-"+w)].join(",");return a.enable(""),v}function g(v){for(const w of a.skips)if(h(v,w))return!1;for(const w of a.names)if(h(v,w))return!0;return!1}function m(v){return v instanceof Error?v.stack||v.message:v}function b(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return a.enable(a.load()),a}return common=t,common}var hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,(function(t,n){var s={};n.formatArgs=l,n.save=c,n.load=h,n.useColors=a,n.storage=y(),n.destroy=(()=>{let m=!1;return()=>{m||(m=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function a(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let m;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(m=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(m[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function l(m){if(m[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+m[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const b="color: "+this.color;m.splice(1,0,b,"color: inherit");let v=0,w=0;m[0].replace(/%[a-zA-Z%]/g,S=>{S!=="%%"&&(v++,S==="%c"&&(w=v))}),m.splice(w,0,b)}n.log=console.debug||console.log||(()=>{});function c(m){try{m?n.storage.setItem("debug",m):n.storage.removeItem("debug")}catch{}}function h(){let m;try{m=n.storage.getItem("debug")||n.storage.getItem("DEBUG")}catch{}return!m&&typeof process<"u"&&"env"in process&&(m=s.DEBUG),m}function y(){try{return localStorage}catch{}}t.exports=requireCommon()(n);const{formatters:g}=t.exports;g.j=function(m){try{return JSON.stringify(m)}catch(b){return"[UnexpectedJSONParseError]: "+b.message}}})(browser,browser.exports)),browser.exports}var browserExports=requireBrowser();const createDebug5=getDefaultExportFromCjs(browserExports);function number$2(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function bytes$2(t,...n){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(n.length>0&&!n.includes(t.length))throw new Error(`Expected Uint8Array of length ${n}, not of length=${t.length}`)}function hash$1(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$2(t.outputLen),number$2(t.blockLen)}function exists$1(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")}function output$1(t,n){bytes$2(t);const s=n.outputLen;if(t.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}const crypto$3=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const u8a$2=t=>t instanceof Uint8Array,createView$2=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),rotr$2=(t,n)=>t<<32-n|t>>>n,isLE$2=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$2)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$3(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function toBytes$2(t){if(typeof t=="string"&&(t=utf8ToBytes$3(t)),!u8a$2(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function concatBytes$3(...t){const n=new Uint8Array(t.reduce((a,l)=>a+l.length,0));let s=0;return t.forEach(a=>{if(!u8a$2(a))throw new Error("Uint8Array expected");n.set(a,s),s+=a.length}),n}let Hash$2=class{clone(){return this._cloneInto()}};function wrapConstructor$1(t){const n=a=>t().update(toBytes$2(a)).digest(),s=t();return n.outputLen=s.outputLen,n.blockLen=s.blockLen,n.create=()=>t(),n}function randomBytes$2(t=32){if(crypto$3&&typeof crypto$3.getRandomValues=="function")return crypto$3.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$2(t,n,s,a){if(typeof t.setBigUint64=="function")return t.setBigUint64(n,s,a);const l=BigInt(32),c=BigInt(4294967295),h=Number(s>>l&c),y=Number(s&c),g=a?4:0,m=a?0:4;t.setUint32(n+g,h,a),t.setUint32(n+m,y,a)}let SHA2$1=class extends Hash$2{constructor(n,s,a,l){super(),this.blockLen=n,this.outputLen=s,this.padOffset=a,this.isLE=l,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(n),this.view=createView$2(this.buffer)}update(n){exists$1(this);const{view:s,buffer:a,blockLen:l}=this;n=toBytes$2(n);const c=n.length;for(let h=0;h<c;){const y=Math.min(l-this.pos,c-h);if(y===l){const g=createView$2(n);for(;l<=c-h;h+=l)this.process(g,h);continue}a.set(n.subarray(h,h+y),this.pos),this.pos+=y,h+=y,this.pos===l&&(this.process(s,0),this.pos=0)}return this.length+=n.length,this.roundClean(),this}digestInto(n){exists$1(this),output$1(n,this),this.finished=!0;const{buffer:s,view:a,blockLen:l,isLE:c}=this;let{pos:h}=this;s[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>l-h&&(this.process(a,0),h=0);for(let v=h;v<l;v++)s[v]=0;setBigUint64$2(a,l-8,BigInt(this.length*8),c),this.process(a,0);const y=createView$2(n),g=this.outputLen;if(g%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=g/4,b=this.get();if(m>b.length)throw new Error("_sha2: outputLen bigger than state");for(let v=0;v<m;v++)y.setUint32(4*v,b[v],c)}digest(){const{buffer:n,outputLen:s}=this;this.digestInto(n);const a=n.slice(0,s);return this.destroy(),a}_cloneInto(n){n||(n=new this.constructor),n.set(...this.get());const{blockLen:s,buffer:a,length:l,finished:c,destroyed:h,pos:y}=this;return n.length=l,n.pos=y,n.finished=c,n.destroyed=h,l%s&&n.buffer.set(a),n}};const Chi$2=(t,n,s)=>t&n^~t&s,Maj$2=(t,n,s)=>t&n^t&s^n&s,SHA256_K$2=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV$1=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$2=new Uint32Array(64);let SHA256$2=class extends SHA2$1{constructor(){super(64,32,8,!1),this.A=IV$1[0]|0,this.B=IV$1[1]|0,this.C=IV$1[2]|0,this.D=IV$1[3]|0,this.E=IV$1[4]|0,this.F=IV$1[5]|0,this.G=IV$1[6]|0,this.H=IV$1[7]|0}get(){const{A:n,B:s,C:a,D:l,E:c,F:h,G:y,H:g}=this;return[n,s,a,l,c,h,y,g]}set(n,s,a,l,c,h,y,g){this.A=n|0,this.B=s|0,this.C=a|0,this.D=l|0,this.E=c|0,this.F=h|0,this.G=y|0,this.H=g|0}process(n,s){for(let v=0;v<16;v++,s+=4)SHA256_W$2[v]=n.getUint32(s,!1);for(let v=16;v<64;v++){const w=SHA256_W$2[v-15],S=SHA256_W$2[v-2],A=rotr$2(w,7)^rotr$2(w,18)^w>>>3,B=rotr$2(S,17)^rotr$2(S,19)^S>>>10;SHA256_W$2[v]=B+SHA256_W$2[v-7]+A+SHA256_W$2[v-16]|0}let{A:a,B:l,C:c,D:h,E:y,F:g,G:m,H:b}=this;for(let v=0;v<64;v++){const w=rotr$2(y,6)^rotr$2(y,11)^rotr$2(y,25),S=b+w+Chi$2(y,g,m)+SHA256_K$2[v]+SHA256_W$2[v]|0,B=(rotr$2(a,2)^rotr$2(a,13)^rotr$2(a,22))+Maj$2(a,l,c)|0;b=m,m=g,g=y,y=h+S|0,h=c,c=l,l=a,a=S+B|0}a=a+this.A|0,l=l+this.B|0,c=c+this.C|0,h=h+this.D|0,y=y+this.E|0,g=g+this.F|0,m=m+this.G|0,b=b+this.H|0,this.set(a,l,c,h,y,g,m,b)}roundClean(){SHA256_W$2.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const sha256$3=wrapConstructor$1(()=>new SHA256$2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$9=BigInt(0),_1n$9=BigInt(1),_2n$5=BigInt(2),u8a$1=t=>t instanceof Uint8Array,hexes$2=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function bytesToHex$2(t){if(!u8a$1(t))throw new Error("Uint8Array expected");let n="";for(let s=0;s<t.length;s++)n+=hexes$2[t[s]];return n}function numberToHexUnpadded$1(t){const n=t.toString(16);return n.length&1?`0${n}`:n}function hexToNumber$1(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function hexToBytes$2(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const n=t.length;if(n%2)throw new Error("padded hex string expected, got unpadded hex of length "+n);const s=new Uint8Array(n/2);for(let a=0;a<s.length;a++){const l=a*2,c=t.slice(l,l+2),h=Number.parseInt(c,16);if(Number.isNaN(h)||h<0)throw new Error("Invalid byte sequence");s[a]=h}return s}function bytesToNumberBE$1(t){return hexToNumber$1(bytesToHex$2(t))}function bytesToNumberLE$1(t){if(!u8a$1(t))throw new Error("Uint8Array expected");return hexToNumber$1(bytesToHex$2(Uint8Array.from(t).reverse()))}function numberToBytesBE$1(t,n){return hexToBytes$2(t.toString(16).padStart(n*2,"0"))}function numberToBytesLE$1(t,n){return numberToBytesBE$1(t,n).reverse()}function numberToVarBytesBE(t){return hexToBytes$2(numberToHexUnpadded$1(t))}function ensureBytes$1(t,n,s){let a;if(typeof n=="string")try{a=hexToBytes$2(n)}catch(c){throw new Error(`${t} must be valid hex string, got "${n}". Cause: ${c}`)}else if(u8a$1(n))a=Uint8Array.from(n);else throw new Error(`${t} must be hex string or Uint8Array`);const l=a.length;if(typeof s=="number"&&l!==s)throw new Error(`${t} expected ${s} bytes, got ${l}`);return a}function concatBytes$2(...t){const n=new Uint8Array(t.reduce((a,l)=>a+l.length,0));let s=0;return t.forEach(a=>{if(!u8a$1(a))throw new Error("Uint8Array expected");n.set(a,s),s+=a.length}),n}function equalBytes$1(t,n){if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==n[s])return!1;return!0}function utf8ToBytes$2(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function bitLen$1(t){let n;for(n=0;t>_0n$9;t>>=_1n$9,n+=1);return n}function bitGet(t,n){return t>>BigInt(n)&_1n$9}const bitSet=(t,n,s)=>t|(s?_1n$9:_0n$9)<<BigInt(n),bitMask$1=t=>(_2n$5<<BigInt(t-1))-_1n$9,u8n=t=>new Uint8Array(t),u8fr=t=>Uint8Array.from(t);function createHmacDrbg$1(t,n,s){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof n!="number"||n<2)throw new Error("qByteLen must be a number");if(typeof s!="function")throw new Error("hmacFn must be a function");let a=u8n(t),l=u8n(t),c=0;const h=()=>{a.fill(1),l.fill(0),c=0},y=(...v)=>s(l,a,...v),g=(v=u8n())=>{l=y(u8fr([0]),v),a=y(),v.length!==0&&(l=y(u8fr([1]),v),a=y())},m=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let v=0;const w=[];for(;v<n;){a=y();const S=a.slice();w.push(S),v+=a.length}return concatBytes$2(...w)};return(v,w)=>{h(),g(v);let S;for(;!(S=w(m()));)g();return h(),S}}const validatorFns={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,n)=>n.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function validateObject(t,n,s={}){const a=(l,c,h)=>{const y=validatorFns[c];if(typeof y!="function")throw new Error(`Invalid validator "${c}", expected function`);const g=t[l];if(!(h&&g===void 0)&&!y(g,t))throw new Error(`Invalid param ${String(l)}=${g} (${typeof g}), expected ${c}`)};for(const[l,c]of Object.entries(n))a(l,c,!1);for(const[l,c]of Object.entries(s))a(l,c,!0);return t}const ut=Object.freeze(Object.defineProperty({__proto__:null,bitGet,bitLen:bitLen$1,bitMask:bitMask$1,bitSet,bytesToHex:bytesToHex$2,bytesToNumberBE:bytesToNumberBE$1,bytesToNumberLE:bytesToNumberLE$1,concatBytes:concatBytes$2,createHmacDrbg:createHmacDrbg$1,ensureBytes:ensureBytes$1,equalBytes:equalBytes$1,hexToBytes:hexToBytes$2,hexToNumber:hexToNumber$1,numberToBytesBE:numberToBytesBE$1,numberToBytesLE:numberToBytesLE$1,numberToHexUnpadded:numberToHexUnpadded$1,numberToVarBytesBE,utf8ToBytes:utf8ToBytes$2,validateObject},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$8=BigInt(0),_1n$8=BigInt(1),_2n$4=BigInt(2),_3n$3=BigInt(3),_4n$2=BigInt(4),_5n$1=BigInt(5),_8n$1=BigInt(8);BigInt(9);BigInt(16);function mod$1(t,n){const s=t%n;return s>=_0n$8?s:n+s}function pow(t,n,s){if(s<=_0n$8||n<_0n$8)throw new Error("Expected power/modulo > 0");if(s===_1n$8)return _0n$8;let a=_1n$8;for(;n>_0n$8;)n&_1n$8&&(a=a*t%s),t=t*t%s,n>>=_1n$8;return a}function pow2$1(t,n,s){let a=t;for(;n-- >_0n$8;)a*=a,a%=s;return a}function invert$1(t,n){if(t===_0n$8||n<=_0n$8)throw new Error(`invert: expected positive integers, got n=${t} mod=${n}`);let s=mod$1(t,n),a=n,l=_0n$8,c=_1n$8;for(;s!==_0n$8;){const y=a/s,g=a%s,m=l-c*y;a=s,s=g,l=c,c=m}if(a!==_1n$8)throw new Error("invert: does not exist");return mod$1(l,n)}function tonelliShanks$1(t){const n=(t-_1n$8)/_2n$4;let s,a,l;for(s=t-_1n$8,a=0;s%_2n$4===_0n$8;s/=_2n$4,a++);for(l=_2n$4;l<t&&pow(l,n,t)!==t-_1n$8;l++);if(a===1){const h=(t+_1n$8)/_4n$2;return function(g,m){const b=g.pow(m,h);if(!g.eql(g.sqr(b),m))throw new Error("Cannot find square root");return b}}const c=(s+_1n$8)/_2n$4;return function(y,g){if(y.pow(g,n)===y.neg(y.ONE))throw new Error("Cannot find square root");let m=a,b=y.pow(y.mul(y.ONE,l),s),v=y.pow(g,c),w=y.pow(g,s);for(;!y.eql(w,y.ONE);){if(y.eql(w,y.ZERO))return y.ZERO;let S=1;for(let B=y.sqr(w);S<m&&!y.eql(B,y.ONE);S++)B=y.sqr(B);const A=y.pow(b,_1n$8<<BigInt(m-S-1));b=y.sqr(A),v=y.mul(v,A),w=y.mul(w,b),m=S}return v}}function FpSqrt$1(t){if(t%_4n$2===_3n$3){const n=(t+_1n$8)/_4n$2;return function(a,l){const c=a.pow(l,n);if(!a.eql(a.sqr(c),l))throw new Error("Cannot find square root");return c}}if(t%_8n$1===_5n$1){const n=(t-_5n$1)/_8n$1;return function(a,l){const c=a.mul(l,_2n$4),h=a.pow(c,n),y=a.mul(l,h),g=a.mul(a.mul(y,_2n$4),h),m=a.mul(y,a.sub(g,a.ONE));if(!a.eql(a.sqr(m),l))throw new Error("Cannot find square root");return m}}return tonelliShanks$1(t)}const FIELD_FIELDS$1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$1(t){const n={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},s=FIELD_FIELDS$1.reduce((a,l)=>(a[l]="function",a),n);return validateObject(t,s)}function FpPow$1(t,n,s){if(s<_0n$8)throw new Error("Expected power > 0");if(s===_0n$8)return t.ONE;if(s===_1n$8)return n;let a=t.ONE,l=n;for(;s>_0n$8;)s&_1n$8&&(a=t.mul(a,l)),l=t.sqr(l),s>>=_1n$8;return a}function FpInvertBatch$1(t,n){const s=new Array(n.length),a=n.reduce((c,h,y)=>t.is0(h)?c:(s[y]=c,t.mul(c,h)),t.ONE),l=t.inv(a);return n.reduceRight((c,h,y)=>t.is0(h)?c:(s[y]=t.mul(c,s[y]),t.mul(c,h)),l),s}function nLength$1(t,n){const s=n!==void 0?n:t.toString(2).length,a=Math.ceil(s/8);return{nBitLength:s,nByteLength:a}}function Field$1(t,n,s=!1,a={}){if(t<=_0n$8)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:l,nByteLength:c}=nLength$1(t,n);if(c>2048)throw new Error("Field lengths over 2048 bytes are not supported");const h=FpSqrt$1(t),y=Object.freeze({ORDER:t,BITS:l,BYTES:c,MASK:bitMask$1(l),ZERO:_0n$8,ONE:_1n$8,create:g=>mod$1(g,t),isValid:g=>{if(typeof g!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof g}`);return _0n$8<=g&&g<t},is0:g=>g===_0n$8,isOdd:g=>(g&_1n$8)===_1n$8,neg:g=>mod$1(-g,t),eql:(g,m)=>g===m,sqr:g=>mod$1(g*g,t),add:(g,m)=>mod$1(g+m,t),sub:(g,m)=>mod$1(g-m,t),mul:(g,m)=>mod$1(g*m,t),pow:(g,m)=>FpPow$1(y,g,m),div:(g,m)=>mod$1(g*invert$1(m,t),t),sqrN:g=>g*g,addN:(g,m)=>g+m,subN:(g,m)=>g-m,mulN:(g,m)=>g*m,inv:g=>invert$1(g,t),sqrt:a.sqrt||(g=>h(y,g)),invertBatch:g=>FpInvertBatch$1(y,g),cmov:(g,m,b)=>b?m:g,toBytes:g=>s?numberToBytesLE$1(g,c):numberToBytesBE$1(g,c),fromBytes:g=>{if(g.length!==c)throw new Error(`Fp.fromBytes: expected ${c}, got ${g.length}`);return s?bytesToNumberLE$1(g):bytesToNumberBE$1(g)}});return Object.freeze(y)}function getFieldBytesLength$1(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const n=t.toString(2).length;return Math.ceil(n/8)}function getMinHashLength$1(t){const n=getFieldBytesLength$1(t);return n+Math.ceil(n/2)}function mapHashToField$1(t,n,s=!1){const a=t.length,l=getFieldBytesLength$1(n),c=getMinHashLength$1(n);if(a<16||a<c||a>1024)throw new Error(`expected ${c}-1024 bytes of input, got ${a}`);const h=s?bytesToNumberBE$1(t):bytesToNumberLE$1(t),y=mod$1(h,n-_1n$8)+_1n$8;return s?numberToBytesLE$1(y,l):numberToBytesBE$1(y,l)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$7=BigInt(0),_1n$7=BigInt(1);function wNAF$1(t,n){const s=(l,c)=>{const h=c.negate();return l?h:c},a=l=>{const c=Math.ceil(n/l)+1,h=2**(l-1);return{windows:c,windowSize:h}};return{constTimeNegate:s,unsafeLadder(l,c){let h=t.ZERO,y=l;for(;c>_0n$7;)c&_1n$7&&(h=h.add(y)),y=y.double(),c>>=_1n$7;return h},precomputeWindow(l,c){const{windows:h,windowSize:y}=a(c),g=[];let m=l,b=m;for(let v=0;v<h;v++){b=m,g.push(b);for(let w=1;w<y;w++)b=b.add(m),g.push(b);m=b.double()}return g},wNAF(l,c,h){const{windows:y,windowSize:g}=a(l);let m=t.ZERO,b=t.BASE;const v=BigInt(2**l-1),w=2**l,S=BigInt(l);for(let A=0;A<y;A++){const B=A*g;let N=Number(h&v);h>>=S,N>g&&(N-=w,h+=_1n$7);const L=B,G=B+Math.abs(N)-1,V=A%2!==0,ie=N<0;N===0?b=b.add(s(V,c[L])):m=m.add(s(ie,c[G]))}return{p:m,f:b}},wNAFCached(l,c,h,y){const g=l._WINDOW_SIZE||1;let m=c.get(l);return m||(m=this.precomputeWindow(l,g),g!==1&&c.set(l,y(m))),this.wNAF(g,m,h)}}}function validateBasic(t){return validateField$1(t.Fp),validateObject(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength$1(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validatePointOpts(t){const n=validateBasic(t);validateObject(n,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:s,Fp:a,a:l}=n;if(s){if(!a.eql(l,a.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof s!="object"||typeof s.beta!="bigint"||typeof s.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...n})}const{bytesToNumberBE:b2n,hexToBytes:h2b}=ut,DER$1={Err:class extends Error{constructor(n=""){super(n)}},_parseInt(t){const{Err:n}=DER$1;if(t.length<2||t[0]!==2)throw new n("Invalid signature integer tag");const s=t[1],a=t.subarray(2,s+2);if(!s||a.length!==s)throw new n("Invalid signature integer: wrong length");if(a[0]&128)throw new n("Invalid signature integer: negative");if(a[0]===0&&!(a[1]&128))throw new n("Invalid signature integer: unnecessary leading zero");return{d:b2n(a),l:t.subarray(s+2)}},toSig(t){const{Err:n}=DER$1,s=typeof t=="string"?h2b(t):t;if(!(s instanceof Uint8Array))throw new Error("ui8a expected");let a=s.length;if(a<2||s[0]!=48)throw new n("Invalid signature tag");if(s[1]!==a-2)throw new n("Invalid signature: incorrect length");const{d:l,l:c}=DER$1._parseInt(s.subarray(2)),{d:h,l:y}=DER$1._parseInt(c);if(y.length)throw new n("Invalid signature: left bytes after parsing");return{r:l,s:h}},hexFromSig(t){const n=m=>Number.parseInt(m[0],16)&8?"00"+m:m,s=m=>{const b=m.toString(16);return b.length&1?`0${b}`:b},a=n(s(t.s)),l=n(s(t.r)),c=a.length/2,h=l.length/2,y=s(c),g=s(h);return`30${s(h+c+4)}02${g}${l}02${y}${a}`}},_0n$6=BigInt(0),_1n$6=BigInt(1);BigInt(2);const _3n$2=BigInt(3);BigInt(4);function weierstrassPoints(t){const n=validatePointOpts(t),{Fp:s}=n,a=n.toBytes||((A,B,N)=>{const L=B.toAffine();return concatBytes$2(Uint8Array.from([4]),s.toBytes(L.x),s.toBytes(L.y))}),l=n.fromBytes||(A=>{const B=A.subarray(1),N=s.fromBytes(B.subarray(0,s.BYTES)),L=s.fromBytes(B.subarray(s.BYTES,2*s.BYTES));return{x:N,y:L}});function c(A){const{a:B,b:N}=n,L=s.sqr(A),G=s.mul(L,A);return s.add(s.add(G,s.mul(A,B)),N)}if(!s.eql(s.sqr(n.Gy),c(n.Gx)))throw new Error("bad generator point: equation left != right");function h(A){return typeof A=="bigint"&&_0n$6<A&&A<n.n}function y(A){if(!h(A))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function g(A){const{allowedPrivateKeyLengths:B,nByteLength:N,wrapPrivateKey:L,n:G}=n;if(B&&typeof A!="bigint"){if(A instanceof Uint8Array&&(A=bytesToHex$2(A)),typeof A!="string"||!B.includes(A.length))throw new Error("Invalid key");A=A.padStart(N*2,"0")}let V;try{V=typeof A=="bigint"?A:bytesToNumberBE$1(ensureBytes$1("private key",A,N))}catch{throw new Error(`private key must be ${N} bytes, hex or bigint, not ${typeof A}`)}return L&&(V=mod$1(V,G)),y(V),V}const m=new Map;function b(A){if(!(A instanceof v))throw new Error("ProjectivePoint expected")}class v{constructor(B,N,L){if(this.px=B,this.py=N,this.pz=L,B==null||!s.isValid(B))throw new Error("x required");if(N==null||!s.isValid(N))throw new Error("y required");if(L==null||!s.isValid(L))throw new Error("z required")}static fromAffine(B){const{x:N,y:L}=B||{};if(!B||!s.isValid(N)||!s.isValid(L))throw new Error("invalid affine point");if(B instanceof v)throw new Error("projective point not allowed");const G=V=>s.eql(V,s.ZERO);return G(N)&&G(L)?v.ZERO:new v(N,L,s.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(B){const N=s.invertBatch(B.map(L=>L.pz));return B.map((L,G)=>L.toAffine(N[G])).map(v.fromAffine)}static fromHex(B){const N=v.fromAffine(l(ensureBytes$1("pointHex",B)));return N.assertValidity(),N}static fromPrivateKey(B){return v.BASE.multiply(g(B))}_setWindowSize(B){this._WINDOW_SIZE=B,m.delete(this)}assertValidity(){if(this.is0()){if(n.allowInfinityPoint&&!s.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:B,y:N}=this.toAffine();if(!s.isValid(B)||!s.isValid(N))throw new Error("bad point: x or y not FE");const L=s.sqr(N),G=c(B);if(!s.eql(L,G))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:B}=this.toAffine();if(s.isOdd)return!s.isOdd(B);throw new Error("Field doesn't support isOdd")}equals(B){b(B);const{px:N,py:L,pz:G}=this,{px:V,py:ie,pz:k}=B,$=s.eql(s.mul(N,k),s.mul(V,G)),j=s.eql(s.mul(L,k),s.mul(ie,G));return $&&j}negate(){return new v(this.px,s.neg(this.py),this.pz)}double(){const{a:B,b:N}=n,L=s.mul(N,_3n$2),{px:G,py:V,pz:ie}=this;let k=s.ZERO,$=s.ZERO,j=s.ZERO,I=s.mul(G,G),X=s.mul(V,V),te=s.mul(ie,ie),H=s.mul(G,V);return H=s.add(H,H),j=s.mul(G,ie),j=s.add(j,j),k=s.mul(B,j),$=s.mul(L,te),$=s.add(k,$),k=s.sub(X,$),$=s.add(X,$),$=s.mul(k,$),k=s.mul(H,k),j=s.mul(L,j),te=s.mul(B,te),H=s.sub(I,te),H=s.mul(B,H),H=s.add(H,j),j=s.add(I,I),I=s.add(j,I),I=s.add(I,te),I=s.mul(I,H),$=s.add($,I),te=s.mul(V,ie),te=s.add(te,te),I=s.mul(te,H),k=s.sub(k,I),j=s.mul(te,X),j=s.add(j,j),j=s.add(j,j),new v(k,$,j)}add(B){b(B);const{px:N,py:L,pz:G}=this,{px:V,py:ie,pz:k}=B;let $=s.ZERO,j=s.ZERO,I=s.ZERO;const X=n.a,te=s.mul(n.b,_3n$2);let H=s.mul(N,V),z=s.mul(L,ie),C=s.mul(G,k),O=s.add(N,L),_=s.add(V,ie);O=s.mul(O,_),_=s.add(H,z),O=s.sub(O,_),_=s.add(N,G);let R=s.add(V,k);return _=s.mul(_,R),R=s.add(H,C),_=s.sub(_,R),R=s.add(L,G),$=s.add(ie,k),R=s.mul(R,$),$=s.add(z,C),R=s.sub(R,$),I=s.mul(X,_),$=s.mul(te,C),I=s.add($,I),$=s.sub(z,I),I=s.add(z,I),j=s.mul($,I),z=s.add(H,H),z=s.add(z,H),C=s.mul(X,C),_=s.mul(te,_),z=s.add(z,C),C=s.sub(H,C),C=s.mul(X,C),_=s.add(_,C),H=s.mul(z,_),j=s.add(j,H),H=s.mul(R,_),$=s.mul(O,$),$=s.sub($,H),H=s.mul(O,z),I=s.mul(R,I),I=s.add(I,H),new v($,j,I)}subtract(B){return this.add(B.negate())}is0(){return this.equals(v.ZERO)}wNAF(B){return S.wNAFCached(this,m,B,N=>{const L=s.invertBatch(N.map(G=>G.pz));return N.map((G,V)=>G.toAffine(L[V])).map(v.fromAffine)})}multiplyUnsafe(B){const N=v.ZERO;if(B===_0n$6)return N;if(y(B),B===_1n$6)return this;const{endo:L}=n;if(!L)return S.unsafeLadder(this,B);let{k1neg:G,k1:V,k2neg:ie,k2:k}=L.splitScalar(B),$=N,j=N,I=this;for(;V>_0n$6||k>_0n$6;)V&_1n$6&&($=$.add(I)),k&_1n$6&&(j=j.add(I)),I=I.double(),V>>=_1n$6,k>>=_1n$6;return G&&($=$.negate()),ie&&(j=j.negate()),j=new v(s.mul(j.px,L.beta),j.py,j.pz),$.add(j)}multiply(B){y(B);let N=B,L,G;const{endo:V}=n;if(V){const{k1neg:ie,k1:k,k2neg:$,k2:j}=V.splitScalar(N);let{p:I,f:X}=this.wNAF(k),{p:te,f:H}=this.wNAF(j);I=S.constTimeNegate(ie,I),te=S.constTimeNegate($,te),te=new v(s.mul(te.px,V.beta),te.py,te.pz),L=I.add(te),G=X.add(H)}else{const{p:ie,f:k}=this.wNAF(N);L=ie,G=k}return v.normalizeZ([L,G])[0]}multiplyAndAddUnsafe(B,N,L){const G=v.BASE,V=(k,$)=>$===_0n$6||$===_1n$6||!k.equals(G)?k.multiplyUnsafe($):k.multiply($),ie=V(this,N).add(V(B,L));return ie.is0()?void 0:ie}toAffine(B){const{px:N,py:L,pz:G}=this,V=this.is0();B==null&&(B=V?s.ONE:s.inv(G));const ie=s.mul(N,B),k=s.mul(L,B),$=s.mul(G,B);if(V)return{x:s.ZERO,y:s.ZERO};if(!s.eql($,s.ONE))throw new Error("invZ was invalid");return{x:ie,y:k}}isTorsionFree(){const{h:B,isTorsionFree:N}=n;if(B===_1n$6)return!0;if(N)return N(v,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:B,clearCofactor:N}=n;return B===_1n$6?this:N?N(v,this):this.multiplyUnsafe(n.h)}toRawBytes(B=!0){return this.assertValidity(),a(v,this,B)}toHex(B=!0){return bytesToHex$2(this.toRawBytes(B))}}v.BASE=new v(n.Gx,n.Gy,s.ONE),v.ZERO=new v(s.ZERO,s.ONE,s.ZERO);const w=n.nBitLength,S=wNAF$1(v,n.endo?Math.ceil(w/2):w);return{CURVE:n,ProjectivePoint:v,normPrivateKeyToScalar:g,weierstrassEquation:c,isWithinCurveOrder:h}}function validateOpts(t){const n=validateBasic(t);return validateObject(n,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...n})}function weierstrass$1(t){const n=validateOpts(t),{Fp:s,n:a}=n,l=s.BYTES+1,c=2*s.BYTES+1;function h(_){return _0n$6<_&&_<s.ORDER}function y(_){return mod$1(_,a)}function g(_){return invert$1(_,a)}const{ProjectivePoint:m,normPrivateKeyToScalar:b,weierstrassEquation:v,isWithinCurveOrder:w}=weierstrassPoints({...n,toBytes(_,R,U){const Y=R.toAffine(),J=s.toBytes(Y.x),T=concatBytes$2;return U?T(Uint8Array.from([R.hasEvenY()?2:3]),J):T(Uint8Array.from([4]),J,s.toBytes(Y.y))},fromBytes(_){const R=_.length,U=_[0],Y=_.subarray(1);if(R===l&&(U===2||U===3)){const J=bytesToNumberBE$1(Y);if(!h(J))throw new Error("Point is not on curve");const T=v(J);let D=s.sqrt(T);const Q=(D&_1n$6)===_1n$6;return(U&1)===1!==Q&&(D=s.neg(D)),{x:J,y:D}}else if(R===c&&U===4){const J=s.fromBytes(Y.subarray(0,s.BYTES)),T=s.fromBytes(Y.subarray(s.BYTES,2*s.BYTES));return{x:J,y:T}}else throw new Error(`Point of length ${R} was invalid. Expected ${l} compressed bytes or ${c} uncompressed bytes`)}}),S=_=>bytesToHex$2(numberToBytesBE$1(_,n.nByteLength));function A(_){const R=a>>_1n$6;return _>R}function B(_){return A(_)?y(-_):_}const N=(_,R,U)=>bytesToNumberBE$1(_.slice(R,U));class L{constructor(R,U,Y){this.r=R,this.s=U,this.recovery=Y,this.assertValidity()}static fromCompact(R){const U=n.nByteLength;return R=ensureBytes$1("compactSignature",R,U*2),new L(N(R,0,U),N(R,U,2*U))}static fromDER(R){const{r:U,s:Y}=DER$1.toSig(ensureBytes$1("DER",R));return new L(U,Y)}assertValidity(){if(!w(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!w(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(R){return new L(this.r,this.s,R)}recoverPublicKey(R){const{r:U,s:Y,recovery:J}=this,T=j(ensureBytes$1("msgHash",R));if(J==null||![0,1,2,3].includes(J))throw new Error("recovery id invalid");const D=J===2||J===3?U+n.n:U;if(D>=s.ORDER)throw new Error("recovery id 2 or 3 invalid");const Q=(J&1)===0?"02":"03",re=m.fromHex(Q+S(D)),oe=g(D),le=y(-T*oe),ue=y(Y*oe),me=m.BASE.multiplyAndAddUnsafe(re,le,ue);if(!me)throw new Error("point at infinify");return me.assertValidity(),me}hasHighS(){return A(this.s)}normalizeS(){return this.hasHighS()?new L(this.r,y(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$2(this.toDERHex())}toDERHex(){return DER$1.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$2(this.toCompactHex())}toCompactHex(){return S(this.r)+S(this.s)}}const G={isValidPrivateKey(_){try{return b(_),!0}catch{return!1}},normPrivateKeyToScalar:b,randomPrivateKey:()=>{const _=getMinHashLength$1(n.n);return mapHashToField$1(n.randomBytes(_),n.n)},precompute(_=8,R=m.BASE){return R._setWindowSize(_),R.multiply(BigInt(3)),R}};function V(_,R=!0){return m.fromPrivateKey(_).toRawBytes(R)}function ie(_){const R=_ instanceof Uint8Array,U=typeof _=="string",Y=(R||U)&&_.length;return R?Y===l||Y===c:U?Y===2*l||Y===2*c:_ instanceof m}function k(_,R,U=!0){if(ie(_))throw new Error("first arg must be private key");if(!ie(R))throw new Error("second arg must be public key");return m.fromHex(R).multiply(b(_)).toRawBytes(U)}const $=n.bits2int||function(_){const R=bytesToNumberBE$1(_),U=_.length*8-n.nBitLength;return U>0?R>>BigInt(U):R},j=n.bits2int_modN||function(_){return y($(_))},I=bitMask$1(n.nBitLength);function X(_){if(typeof _!="bigint")throw new Error("bigint expected");if(!(_0n$6<=_&&_<I))throw new Error(`bigint expected < 2^${n.nBitLength}`);return numberToBytesBE$1(_,n.nByteLength)}function te(_,R,U=H){if(["recovered","canonical"].some(ve=>ve in U))throw new Error("sign() legacy options not supported");const{hash:Y,randomBytes:J}=n;let{lowS:T,prehash:D,extraEntropy:Q}=U;T==null&&(T=!0),_=ensureBytes$1("msgHash",_),D&&(_=ensureBytes$1("prehashed msgHash",Y(_)));const re=j(_),oe=b(R),le=[X(oe),X(re)];if(Q!=null){const ve=Q===!0?J(s.BYTES):Q;le.push(ensureBytes$1("extraEntropy",ve))}const ue=concatBytes$2(...le),me=re;function be(ve){const Ue=$(ve);if(!w(Ue))return;const bt=g(Ue),Xe=m.BASE.multiply(Ue).toAffine(),ot=y(Xe.x);if(ot===_0n$6)return;const Wt=y(bt*y(me+ot*oe));if(Wt===_0n$6)return;let _r=(Xe.x===ot?0:2)|Number(Xe.y&_1n$6),kr=Wt;return T&&A(Wt)&&(kr=B(Wt),_r^=1),new L(ot,kr,_r)}return{seed:ue,k2sig:be}}const H={lowS:n.lowS,prehash:!1},z={lowS:n.lowS,prehash:!1};function C(_,R,U=H){const{seed:Y,k2sig:J}=te(_,R,U),T=n;return createHmacDrbg$1(T.hash.outputLen,T.nByteLength,T.hmac)(Y,J)}m.BASE._setWindowSize(8);function O(_,R,U,Y=z){const J=_;if(R=ensureBytes$1("msgHash",R),U=ensureBytes$1("publicKey",U),"strict"in Y)throw new Error("options.strict was renamed to lowS");const{lowS:T,prehash:D}=Y;let Q,re;try{if(typeof J=="string"||J instanceof Uint8Array)try{Q=L.fromDER(J)}catch(Xe){if(!(Xe instanceof DER$1.Err))throw Xe;Q=L.fromCompact(J)}else if(typeof J=="object"&&typeof J.r=="bigint"&&typeof J.s=="bigint"){const{r:Xe,s:ot}=J;Q=new L(Xe,ot)}else throw new Error("PARSE");re=m.fromHex(U)}catch(Xe){if(Xe.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(T&&Q.hasHighS())return!1;D&&(R=n.hash(R));const{r:oe,s:le}=Q,ue=j(R),me=g(le),be=y(ue*me),ve=y(oe*me),Ue=m.BASE.multiplyAndAddUnsafe(re,be,ve)?.toAffine();return Ue?y(Ue.x)===oe:!1}return{CURVE:n,getPublicKey:V,getSharedSecret:k,sign:C,verify:O,ProjectivePoint:m,Signature:L,utils:G}}let HMAC$2=class extends Hash$2{constructor(n,s){super(),this.finished=!1,this.destroyed=!1,hash$1(n);const a=toBytes$2(s);if(this.iHash=n.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const l=this.blockLen,c=new Uint8Array(l);c.set(a.length>l?n.create().update(a).digest():a);for(let h=0;h<c.length;h++)c[h]^=54;this.iHash.update(c),this.oHash=n.create();for(let h=0;h<c.length;h++)c[h]^=106;this.oHash.update(c),c.fill(0)}update(n){return exists$1(this),this.iHash.update(n),this}digestInto(n){exists$1(this),bytes$2(n,this.outputLen),this.finished=!0,this.iHash.digestInto(n),this.oHash.update(n),this.oHash.digestInto(n),this.destroy()}digest(){const n=new Uint8Array(this.oHash.outputLen);return this.digestInto(n),n}_cloneInto(n){n||(n=Object.create(Object.getPrototypeOf(this),{}));const{oHash:s,iHash:a,finished:l,destroyed:c,blockLen:h,outputLen:y}=this;return n=n,n.finished=l,n.destroyed=c,n.blockLen=h,n.outputLen=y,n.oHash=s._cloneInto(n.oHash),n.iHash=a._cloneInto(n.iHash),n}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$2=(t,n,s)=>new HMAC$2(t,n).update(s).digest();hmac$2.create=(t,n)=>new HMAC$2(t,n);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function getHash(t){return{hash:t,hmac:(n,...s)=>hmac$2(t,n,concatBytes$3(...s)),randomBytes:randomBytes$2}}function createCurve$1(t,n){const s=a=>weierstrass$1({...t,...getHash(a)});return Object.freeze({...s(n),create:s})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n$5=BigInt(1),_2n$3=BigInt(2),divNearest$1=(t,n)=>(t+n/_2n$3)/n;function sqrtMod$1(t){const n=secp256k1P,s=BigInt(3),a=BigInt(6),l=BigInt(11),c=BigInt(22),h=BigInt(23),y=BigInt(44),g=BigInt(88),m=t*t*t%n,b=m*m*t%n,v=pow2$1(b,s,n)*b%n,w=pow2$1(v,s,n)*b%n,S=pow2$1(w,_2n$3,n)*m%n,A=pow2$1(S,l,n)*S%n,B=pow2$1(A,c,n)*A%n,N=pow2$1(B,y,n)*B%n,L=pow2$1(N,g,n)*N%n,G=pow2$1(L,y,n)*B%n,V=pow2$1(G,s,n)*b%n,ie=pow2$1(V,h,n)*A%n,k=pow2$1(ie,a,n)*m%n,$=pow2$1(k,_2n$3,n);if(!Fp.eql(Fp.sqr($),t))throw new Error("Cannot find square root");return $}const Fp=Field$1(secp256k1P,void 0,void 0,{sqrt:sqrtMod$1}),secp256k1$1=createCurve$1({a:BigInt(0),b:BigInt(7),Fp,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const n=secp256k1N,s=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),a=-_1n$5*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),l=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),c=s,h=BigInt("0x100000000000000000000000000000000"),y=divNearest$1(c*t,n),g=divNearest$1(-a*t,n);let m=mod$1(t-y*s-g*l,n),b=mod$1(-y*a-g*c,n);const v=m>h,w=b>h;if(v&&(m=n-m),w&&(b=n-b),m>h||b>h)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:v,k1:m,k2neg:w,k2:b}}}},sha256$3),_0n$5=BigInt(0),fe=t=>typeof t=="bigint"&&_0n$5<t&&t<secp256k1P,ge=t=>typeof t=="bigint"&&_0n$5<t&&t<secp256k1N,TAGGED_HASH_PREFIXES$1={};function taggedHash$1(t,...n){let s=TAGGED_HASH_PREFIXES$1[t];if(s===void 0){const a=sha256$3(Uint8Array.from(t,l=>l.charCodeAt(0)));s=concatBytes$2(a,a),TAGGED_HASH_PREFIXES$1[t]=s}return sha256$3(concatBytes$2(s,...n))}const pointToBytes$1=t=>t.toRawBytes(!0).slice(1),numTo32b=t=>numberToBytesBE$1(t,32),modP=t=>mod$1(t,secp256k1P),modN=t=>mod$1(t,secp256k1N),Point=secp256k1$1.ProjectivePoint,GmulAdd=(t,n,s)=>Point.BASE.multiplyAndAddUnsafe(t,n,s);function schnorrGetExtPubKey$1(t){let n=secp256k1$1.utils.normPrivateKeyToScalar(t),s=Point.fromPrivateKey(n);return{scalar:s.hasEvenY()?n:modN(-n),bytes:pointToBytes$1(s)}}function lift_x$1(t){if(!fe(t))throw new Error("bad x: need 0 < x < p");const n=modP(t*t),s=modP(n*t+BigInt(7));let a=sqrtMod$1(s);a%_2n$3!==_0n$5&&(a=modP(-a));const l=new Point(t,a,_1n$5);return l.assertValidity(),l}function challenge$1(...t){return modN(bytesToNumberBE$1(taggedHash$1("BIP0340/challenge",...t)))}function schnorrGetPublicKey$1(t){return schnorrGetExtPubKey$1(t).bytes}function schnorrSign$1(t,n,s=randomBytes$2(32)){const a=ensureBytes$1("message",t),{bytes:l,scalar:c}=schnorrGetExtPubKey$1(n),h=ensureBytes$1("auxRand",s,32),y=numTo32b(c^bytesToNumberBE$1(taggedHash$1("BIP0340/aux",h))),g=taggedHash$1("BIP0340/nonce",y,l,a),m=modN(bytesToNumberBE$1(g));if(m===_0n$5)throw new Error("sign failed: k is zero");const{bytes:b,scalar:v}=schnorrGetExtPubKey$1(m),w=challenge$1(b,l,a),S=new Uint8Array(64);if(S.set(b,0),S.set(numTo32b(modN(v+w*c)),32),!schnorrVerify$1(S,a,l))throw new Error("sign: Invalid signature produced");return S}function schnorrVerify$1(t,n,s){const a=ensureBytes$1("signature",t,64),l=ensureBytes$1("message",n),c=ensureBytes$1("publicKey",s,32);try{const h=lift_x$1(bytesToNumberBE$1(c)),y=bytesToNumberBE$1(a.subarray(0,32));if(!fe(y))return!1;const g=bytesToNumberBE$1(a.subarray(32,64));if(!ge(g))return!1;const m=challenge$1(numTo32b(y),pointToBytes$1(h),l),b=GmulAdd(h,g,modN(-m));return!(!b||!b.hasEvenY()||b.toAffine().x!==y)}catch{return!1}}const schnorr$1={getPublicKey:schnorrGetPublicKey$1,sign:schnorrSign$1,verify:schnorrVerify$1,utils:{randomPrivateKey:secp256k1$1.utils.randomPrivateKey,lift_x:lift_x$1,pointToBytes:pointToBytes$1,numberToBytesBE:numberToBytesBE$1,bytesToNumberBE:bytesToNumberBE$1,taggedHash:taggedHash$1,mod:mod$1}},crypto$2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const u8a=t=>t instanceof Uint8Array,createView$1=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),rotr$1=(t,n)=>t<<32-n|t>>>n,isLE$1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$1)throw new Error("Non little-endian hardware is not supported");const hexes$1=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function bytesToHex$1(t){if(!u8a(t))throw new Error("Uint8Array expected");let n="";for(let s=0;s<t.length;s++)n+=hexes$1[t[s]];return n}function hexToBytes$1(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const n=t.length;if(n%2)throw new Error("padded hex string expected, got unpadded hex of length "+n);const s=new Uint8Array(n/2);for(let a=0;a<s.length;a++){const l=a*2,c=t.slice(l,l+2),h=Number.parseInt(c,16);if(Number.isNaN(h)||h<0)throw new Error("Invalid byte sequence");s[a]=h}return s}function utf8ToBytes$1(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function toBytes$1(t){if(typeof t=="string"&&(t=utf8ToBytes$1(t)),!u8a(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function concatBytes$1(...t){const n=new Uint8Array(t.reduce((a,l)=>a+l.length,0));let s=0;return t.forEach(a=>{if(!u8a(a))throw new Error("Uint8Array expected");n.set(a,s),s+=a.length}),n}let Hash$1=class{clone(){return this._cloneInto()}};function wrapConstructor(t){const n=a=>t().update(toBytes$1(a)).digest(),s=t();return n.outputLen=s.outputLen,n.blockLen=s.blockLen,n.create=()=>t(),n}function randomBytes$1(t=32){if(crypto$2&&typeof crypto$2.getRandomValues=="function")return crypto$2.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function number$1(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function bool$1(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function bytes$1(t,...n){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(n.length>0&&!n.includes(t.length))throw new Error(`Expected Uint8Array of length ${n}, not of length=${t.length}`)}function hash(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$1(t.outputLen),number$1(t.blockLen)}function exists(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")}function output(t,n){bytes$1(t);const s=n.outputLen;if(t.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}const assert={number:number$1,bool:bool$1,bytes:bytes$1,hash,exists,output};function setBigUint64$1(t,n,s,a){if(typeof t.setBigUint64=="function")return t.setBigUint64(n,s,a);const l=BigInt(32),c=BigInt(4294967295),h=Number(s>>l&c),y=Number(s&c),g=a?4:0,m=a?0:4;t.setUint32(n+g,h,a),t.setUint32(n+m,y,a)}class SHA2 extends Hash$1{constructor(n,s,a,l){super(),this.blockLen=n,this.outputLen=s,this.padOffset=a,this.isLE=l,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(n),this.view=createView$1(this.buffer)}update(n){assert.exists(this);const{view:s,buffer:a,blockLen:l}=this;n=toBytes$1(n);const c=n.length;for(let h=0;h<c;){const y=Math.min(l-this.pos,c-h);if(y===l){const g=createView$1(n);for(;l<=c-h;h+=l)this.process(g,h);continue}a.set(n.subarray(h,h+y),this.pos),this.pos+=y,h+=y,this.pos===l&&(this.process(s,0),this.pos=0)}return this.length+=n.length,this.roundClean(),this}digestInto(n){assert.exists(this),assert.output(n,this),this.finished=!0;const{buffer:s,view:a,blockLen:l,isLE:c}=this;let{pos:h}=this;s[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>l-h&&(this.process(a,0),h=0);for(let v=h;v<l;v++)s[v]=0;setBigUint64$1(a,l-8,BigInt(this.length*8),c),this.process(a,0);const y=createView$1(n),g=this.outputLen;if(g%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=g/4,b=this.get();if(m>b.length)throw new Error("_sha2: outputLen bigger than state");for(let v=0;v<m;v++)y.setUint32(4*v,b[v],c)}digest(){const{buffer:n,outputLen:s}=this;this.digestInto(n);const a=n.slice(0,s);return this.destroy(),a}_cloneInto(n){n||(n=new this.constructor),n.set(...this.get());const{blockLen:s,buffer:a,length:l,finished:c,destroyed:h,pos:y}=this;return n.length=l,n.pos=y,n.finished=c,n.destroyed=h,l%s&&n.buffer.set(a),n}}const Chi$1=(t,n,s)=>t&n^~t&s,Maj$1=(t,n,s)=>t&n^t&s^n&s,SHA256_K$1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$1=new Uint32Array(64);let SHA256$1=class extends SHA2{constructor(){super(64,32,8,!1),this.A=IV[0]|0,this.B=IV[1]|0,this.C=IV[2]|0,this.D=IV[3]|0,this.E=IV[4]|0,this.F=IV[5]|0,this.G=IV[6]|0,this.H=IV[7]|0}get(){const{A:n,B:s,C:a,D:l,E:c,F:h,G:y,H:g}=this;return[n,s,a,l,c,h,y,g]}set(n,s,a,l,c,h,y,g){this.A=n|0,this.B=s|0,this.C=a|0,this.D=l|0,this.E=c|0,this.F=h|0,this.G=y|0,this.H=g|0}process(n,s){for(let v=0;v<16;v++,s+=4)SHA256_W$1[v]=n.getUint32(s,!1);for(let v=16;v<64;v++){const w=SHA256_W$1[v-15],S=SHA256_W$1[v-2],A=rotr$1(w,7)^rotr$1(w,18)^w>>>3,B=rotr$1(S,17)^rotr$1(S,19)^S>>>10;SHA256_W$1[v]=B+SHA256_W$1[v-7]+A+SHA256_W$1[v-16]|0}let{A:a,B:l,C:c,D:h,E:y,F:g,G:m,H:b}=this;for(let v=0;v<64;v++){const w=rotr$1(y,6)^rotr$1(y,11)^rotr$1(y,25),S=b+w+Chi$1(y,g,m)+SHA256_K$1[v]+SHA256_W$1[v]|0,B=(rotr$1(a,2)^rotr$1(a,13)^rotr$1(a,22))+Maj$1(a,l,c)|0;b=m,m=g,g=y,y=h+S|0,h=c,c=l,l=a,a=S+B|0}a=a+this.A|0,l=l+this.B|0,c=c+this.C|0,h=h+this.D|0,y=y+this.E|0,g=g+this.F|0,m=m+this.G|0,b=b+this.H|0,this.set(a,l,c,h,y,g,m,b)}roundClean(){SHA256_W$1.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};class SHA224 extends SHA256$1{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const sha256$2=wrapConstructor(()=>new SHA256$1);wrapConstructor(()=>new SHA224);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function assertNumber(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function chain(...t){const n=(l,c)=>h=>l(c(h)),s=Array.from(t).reverse().reduce((l,c)=>l?n(l,c.encode):c.encode,void 0),a=t.reduce((l,c)=>l?n(l,c.decode):c.decode,void 0);return{encode:s,decode:a}}function alphabet(t){return{encode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return n.map(s=>{if(assertNumber(s),s<0||s>=t.length)throw new Error(`Digit index outside alphabet: ${s} (alphabet: ${t.length})`);return t[s]})},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("alphabet.decode input should be array of strings");return n.map(s=>{if(typeof s!="string")throw new Error(`alphabet.decode: not string element=${s}`);const a=t.indexOf(s);if(a===-1)throw new Error(`Unknown letter: "${s}". Allowed: ${t}`);return a})}}}function join(t=""){if(typeof t!="string")throw new Error("join separator should be string");return{encode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("join.encode input should be array of strings");for(let s of n)if(typeof s!="string")throw new Error(`join.encode: non-string input=${s}`);return n.join(t)},decode:n=>{if(typeof n!="string")throw new Error("join.decode input should be string");return n.split(t)}}}function padding(t,n="="){if(assertNumber(t),typeof n!="string")throw new Error("padding chr should be string");return{encode(s){if(!Array.isArray(s)||s.length&&typeof s[0]!="string")throw new Error("padding.encode input should be array of strings");for(let a of s)if(typeof a!="string")throw new Error(`padding.encode: non-string input=${a}`);for(;s.length*t%8;)s.push(n);return s},decode(s){if(!Array.isArray(s)||s.length&&typeof s[0]!="string")throw new Error("padding.encode input should be array of strings");for(let l of s)if(typeof l!="string")throw new Error(`padding.decode: non-string input=${l}`);let a=s.length;if(a*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;a>0&&s[a-1]===n;a--)if(!((a-1)*t%8))throw new Error("Invalid padding: string has too much padding");return s.slice(0,a)}}}function normalize$1(t){if(typeof t!="function")throw new Error("normalize fn should be function");return{encode:n=>n,decode:n=>t(n)}}function convertRadix(t,n,s){if(n<2)throw new Error(`convertRadix: wrong from=${n}, base cannot be less than 2`);if(s<2)throw new Error(`convertRadix: wrong to=${s}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let a=0;const l=[],c=Array.from(t);for(c.forEach(h=>{if(assertNumber(h),h<0||h>=n)throw new Error(`Wrong integer: ${h}`)});;){let h=0,y=!0;for(let g=a;g<c.length;g++){const m=c[g],b=n*h+m;if(!Number.isSafeInteger(b)||n*h/n!==h||b-m!==n*h)throw new Error("convertRadix: carry overflow");if(h=b%s,c[g]=Math.floor(b/s),!Number.isSafeInteger(c[g])||c[g]*s+h!==b)throw new Error("convertRadix: carry overflow");if(y)c[g]?y=!1:a=g;else continue}if(l.push(h),y)break}for(let h=0;h<t.length-1&&t[h]===0;h++)l.push(0);return l.reverse()}const gcd=(t,n)=>n?gcd(n,t%n):t,radix2carry=(t,n)=>t+(n-gcd(t,n));function convertRadix2(t,n,s,a){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(n<=0||n>32)throw new Error(`convertRadix2: wrong from=${n}`);if(s<=0||s>32)throw new Error(`convertRadix2: wrong to=${s}`);if(radix2carry(n,s)>32)throw new Error(`convertRadix2: carry overflow from=${n} to=${s} carryBits=${radix2carry(n,s)}`);let l=0,c=0;const h=2**s-1,y=[];for(const g of t){if(assertNumber(g),g>=2**n)throw new Error(`convertRadix2: invalid data word=${g} from=${n}`);if(l=l<<n|g,c+n>32)throw new Error(`convertRadix2: carry overflow pos=${c} from=${n}`);for(c+=n;c>=s;c-=s)y.push((l>>c-s&h)>>>0);l&=2**c-1}if(l=l<<s-c&h,!a&&c>=n)throw new Error("Excess padding");if(!a&&l)throw new Error(`Non-zero padding: ${l}`);return a&&c>0&&y.push(l>>>0),y}function radix(t){return assertNumber(t),{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return convertRadix(Array.from(n),2**8,t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(convertRadix(n,t,2**8))}}}function radix2(t,n=!1){if(assertNumber(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry(8,t)>32||radix2carry(t,8)>32)throw new Error("radix2: carry overflow");return{encode:s=>{if(!(s instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2(Array.from(s),8,t,!n)},decode:s=>{if(!Array.isArray(s)||s.length&&typeof s[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(convertRadix2(s,t,8,n))}}}function unsafeWrapper(t){if(typeof t!="function")throw new Error("unsafeWrapper fn should be function");return function(...n){try{return t.apply(null,n)}catch{}}}const base16=chain(radix2(4),alphabet("0123456789ABCDEF"),join("")),base32=chain(radix2(5),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHIJKLMNOPQRSTUV"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),join(""),normalize$1(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const base64=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),padding(6),join("")),base64url=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),padding(6),join("")),genBase58=t=>chain(radix(58),alphabet(t),join("")),base58=genBase58("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");genBase58("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");genBase58("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const XMR_BLOCK_LEN=[0,2,3,5,6,7,9,10,11],base58xmr={encode(t){let n="";for(let s=0;s<t.length;s+=8){const a=t.subarray(s,s+8);n+=base58.encode(a).padStart(XMR_BLOCK_LEN[a.length],"1")}return n},decode(t){let n=[];for(let s=0;s<t.length;s+=11){const a=t.slice(s,s+11),l=XMR_BLOCK_LEN.indexOf(a.length),c=base58.decode(a);for(let h=0;h<c.length-l;h++)if(c[h]!==0)throw new Error("base58xmr: wrong padding");n=n.concat(Array.from(c.slice(c.length-l)))}return Uint8Array.from(n)}},BECH_ALPHABET=chain(alphabet("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),join("")),POLYMOD_GENERATORS=[996825010,642813549,513874426,1027748829,705979059];function bech32Polymod(t){const n=t>>25;let s=(t&33554431)<<5;for(let a=0;a<POLYMOD_GENERATORS.length;a++)(n>>a&1)===1&&(s^=POLYMOD_GENERATORS[a]);return s}function bechChecksum(t,n,s=1){const a=t.length;let l=1;for(let c=0;c<a;c++){const h=t.charCodeAt(c);if(h<33||h>126)throw new Error(`Invalid prefix (${t})`);l=bech32Polymod(l)^h>>5}l=bech32Polymod(l);for(let c=0;c<a;c++)l=bech32Polymod(l)^t.charCodeAt(c)&31;for(let c of n)l=bech32Polymod(l)^c;for(let c=0;c<6;c++)l=bech32Polymod(l);return l^=s,BECH_ALPHABET.encode(convertRadix2([l%2**30],30,5,!1))}function genBech32(t){const n=t==="bech32"?1:734539939,s=radix2(5),a=s.decode,l=s.encode,c=unsafeWrapper(a);function h(b,v,w=90){if(typeof b!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof b}`);if(!Array.isArray(v)||v.length&&typeof v[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof v}`);const S=b.length+7+v.length;if(w!==!1&&S>w)throw new TypeError(`Length ${S} exceeds limit ${w}`);return b=b.toLowerCase(),`${b}1${BECH_ALPHABET.encode(v)}${bechChecksum(b,v,n)}`}function y(b,v=90){if(typeof b!="string")throw new Error(`bech32.decode input should be string, not ${typeof b}`);if(b.length<8||v!==!1&&b.length>v)throw new TypeError(`Wrong string length: ${b.length} (${b}). Expected (8..${v})`);const w=b.toLowerCase();if(b!==w&&b!==b.toUpperCase())throw new Error("String must be lowercase or uppercase");b=w;const S=b.lastIndexOf("1");if(S===0||S===-1)throw new Error('Letter "1" must be present between prefix and data only');const A=b.slice(0,S),B=b.slice(S+1);if(B.length<6)throw new Error("Data must be at least 6 characters long");const N=BECH_ALPHABET.decode(B).slice(0,-6),L=bechChecksum(A,N,n);if(!B.endsWith(L))throw new Error(`Invalid checksum in ${b}: expected "${L}"`);return{prefix:A,words:N}}const g=unsafeWrapper(y);function m(b){const{prefix:v,words:w}=y(b,!1);return{prefix:v,words:w,bytes:a(w)}}return{encode:h,decode:y,decodeToBytes:m,decodeUnsafe:g,fromWords:a,fromWordsUnsafe:c,toWords:l}}const bech32=genBech32("bech32");genBech32("bech32m");const utf8={encode:t=>new TextDecoder().decode(t),decode:t=>new TextEncoder().encode(t)},hex=chain(radix2(4),alphabet("0123456789abcdef"),join(""),normalize$1(t=>{if(typeof t!="string"||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()})),CODERS={utf8,hex,base16,base32,base64,base64url,base58,base58xmr};`${Object.keys(CODERS).join(", ")}`;function number(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function bool(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function isBytes$1(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function bytes(t,...n){if(!isBytes$1(t))throw new Error("Uint8Array expected");if(n.length>0&&!n.includes(t.length))throw new Error(`Uint8Array expected of length ${n}, not of length=${t.length}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE)throw new Error("Non little-endian hardware is not supported");function checkOpts(t,n){if(n==null||typeof n!="object")throw new Error("options must be defined");return Object.assign(t,n)}function equalBytes(t,n){if(t.length!==n.length)return!1;let s=0;for(let a=0;a<t.length;a++)s|=t[a]^n[a];return s===0}const wrapCipher=(t,n)=>(Object.assign(n,t),n),BLOCK_SIZE=16,POLY=283;function mul2(t){return t<<1^POLY&-(t>>7)}function mul(t,n){let s=0;for(;n>0;n>>=1)s^=t&-(n&1),t=mul2(t);return s}const sbox=(()=>{let t=new Uint8Array(256);for(let s=0,a=1;s<256;s++,a^=mul2(a))t[s]=a;const n=new Uint8Array(256);n[0]=99;for(let s=0;s<255;s++){let a=t[255-s];a|=a<<8,n[t[s]]=(a^a>>4^a>>5^a>>6^a>>7^99)&255}return n})(),invSbox=sbox.map((t,n)=>sbox.indexOf(n)),rotr32_8=t=>t<<24|t>>>8,rotl32_8=t=>t<<8|t>>>24;function genTtable(t,n){if(t.length!==256)throw new Error("Wrong sbox length");const s=new Uint32Array(256).map((m,b)=>n(t[b])),a=s.map(rotl32_8),l=a.map(rotl32_8),c=l.map(rotl32_8),h=new Uint32Array(256*256),y=new Uint32Array(256*256),g=new Uint16Array(256*256);for(let m=0;m<256;m++)for(let b=0;b<256;b++){const v=m*256+b;h[v]=s[m]^a[b],y[v]=l[m]^c[b],g[v]=t[m]<<8|t[b]}return{sbox:t,sbox2:g,T0:s,T1:a,T2:l,T3:c,T01:h,T23:y}}const tableEncoding=genTtable(sbox,t=>mul(t,3)<<24|t<<16|t<<8|mul(t,2)),tableDecoding=genTtable(invSbox,t=>mul(t,11)<<24|mul(t,13)<<16|mul(t,9)<<8|mul(t,14)),xPowers=(()=>{const t=new Uint8Array(16);for(let n=0,s=1;n<16;n++,s=mul2(s))t[n]=s;return t})();function expandKeyLE(t){bytes(t);const n=t.length;if(![16,24,32].includes(n))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${n}`);const{sbox2:s}=tableEncoding,a=u32(t),l=a.length,c=y=>applySbox(s,y,y,y,y),h=new Uint32Array(n+28);h.set(a);for(let y=l;y<h.length;y++){let g=h[y-1];y%l===0?g=c(rotr32_8(g))^xPowers[y/l-1]:l>6&&y%l===4&&(g=c(g)),h[y]=h[y-l]^g}return h}function expandKeyDecLE(t){const n=expandKeyLE(t),s=n.slice(),a=n.length,{sbox2:l}=tableEncoding,{T0:c,T1:h,T2:y,T3:g}=tableDecoding;for(let m=0;m<a;m+=4)for(let b=0;b<4;b++)s[m+b]=n[a-m-4+b];n.fill(0);for(let m=4;m<a-4;m++){const b=s[m],v=applySbox(l,b,b,b,b);s[m]=c[v&255]^h[v>>>8&255]^y[v>>>16&255]^g[v>>>24]}return s}function apply0123(t,n,s,a,l,c){return t[s<<8&65280|a>>>8&255]^n[l>>>8&65280|c>>>24&255]}function applySbox(t,n,s,a,l){return t[n&255|s&65280]|t[a>>>16&255|l>>>16&65280]<<16}function encrypt$2(t,n,s,a,l){const{sbox2:c,T01:h,T23:y}=tableEncoding;let g=0;n^=t[g++],s^=t[g++],a^=t[g++],l^=t[g++];const m=t.length/4-2;for(let A=0;A<m;A++){const B=t[g++]^apply0123(h,y,n,s,a,l),N=t[g++]^apply0123(h,y,s,a,l,n),L=t[g++]^apply0123(h,y,a,l,n,s),G=t[g++]^apply0123(h,y,l,n,s,a);n=B,s=N,a=L,l=G}const b=t[g++]^applySbox(c,n,s,a,l),v=t[g++]^applySbox(c,s,a,l,n),w=t[g++]^applySbox(c,a,l,n,s),S=t[g++]^applySbox(c,l,n,s,a);return{s0:b,s1:v,s2:w,s3:S}}function decrypt$2(t,n,s,a,l){const{sbox2:c,T01:h,T23:y}=tableDecoding;let g=0;n^=t[g++],s^=t[g++],a^=t[g++],l^=t[g++];const m=t.length/4-2;for(let A=0;A<m;A++){const B=t[g++]^apply0123(h,y,n,l,a,s),N=t[g++]^apply0123(h,y,s,n,l,a),L=t[g++]^apply0123(h,y,a,s,n,l),G=t[g++]^apply0123(h,y,l,a,s,n);n=B,s=N,a=L,l=G}const b=t[g++]^applySbox(c,n,l,a,s),v=t[g++]^applySbox(c,s,n,l,a),w=t[g++]^applySbox(c,a,s,n,l),S=t[g++]^applySbox(c,l,a,s,n);return{s0:b,s1:v,s2:w,s3:S}}function getDst(t,n){if(!n)return new Uint8Array(t);if(bytes(n),n.length<t)throw new Error(`aes: wrong destination length, expected at least ${t}, got: ${n.length}`);return n}function validateBlockDecrypt(t){if(bytes(t),t.length%BLOCK_SIZE!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${BLOCK_SIZE}`)}function validateBlockEncrypt(t,n,s){let a=t.length;const l=a%BLOCK_SIZE;if(!n&&l!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const c=u32(t);if(n){let g=BLOCK_SIZE-l;g||(g=BLOCK_SIZE),a=a+g}const h=getDst(a,s),y=u32(h);return{b:c,o:y,out:h}}function validatePCKS(t,n){if(!n)return t;const s=t.length;if(!s)throw new Error("aes/pcks5: empty ciphertext not allowed");const a=t[s-1];if(a<=0||a>16)throw new Error(`aes/pcks5: wrong padding byte: ${a}`);const l=t.subarray(0,-a);for(let c=0;c<a;c++)if(t[s-c-1]!==a)throw new Error("aes/pcks5: wrong padding");return l}function padPCKS(t){const n=new Uint8Array(16),s=u32(n);n.set(t);const a=BLOCK_SIZE-t.length;for(let l=BLOCK_SIZE-a;l<BLOCK_SIZE;l++)n[l]=a;return s}const cbc=wrapCipher({blockSize:16,nonceLength:16},function t(n,s,a={}){bytes(n),bytes(s,16);const l=!a.disablePadding;return{encrypt:(c,h)=>{const y=expandKeyLE(n),{b:g,o:m,out:b}=validateBlockEncrypt(c,l,h),v=u32(s);let w=v[0],S=v[1],A=v[2],B=v[3],N=0;for(;N+4<=g.length;)w^=g[N+0],S^=g[N+1],A^=g[N+2],B^=g[N+3],{s0:w,s1:S,s2:A,s3:B}=encrypt$2(y,w,S,A,B),m[N++]=w,m[N++]=S,m[N++]=A,m[N++]=B;if(l){const L=padPCKS(c.subarray(N*4));w^=L[0],S^=L[1],A^=L[2],B^=L[3],{s0:w,s1:S,s2:A,s3:B}=encrypt$2(y,w,S,A,B),m[N++]=w,m[N++]=S,m[N++]=A,m[N++]=B}return y.fill(0),b},decrypt:(c,h)=>{validateBlockDecrypt(c);const y=expandKeyDecLE(n),g=u32(s),m=getDst(c.length,h),b=u32(c),v=u32(m);let w=g[0],S=g[1],A=g[2],B=g[3];for(let N=0;N+4<=b.length;){const L=w,G=S,V=A,ie=B;w=b[N+0],S=b[N+1],A=b[N+2],B=b[N+3];const{s0:k,s1:$,s2:j,s3:I}=decrypt$2(y,w,S,A,B);v[N++]=k^L,v[N++]=$^G,v[N++]=j^V,v[N++]=I^ie}return y.fill(0),validatePCKS(m,l)}}}),_utf8ToBytes=t=>Uint8Array.from(t.split("").map(n=>n.charCodeAt(0))),sigma16=_utf8ToBytes("expand 16-byte k"),sigma32=_utf8ToBytes("expand 32-byte k"),sigma16_32=u32(sigma16),sigma32_32=u32(sigma32);sigma32_32.slice();function rotl(t,n){return t<<n|t>>>32-n}function isAligned32(t){return t.byteOffset%4===0}const BLOCK_LEN=64,BLOCK_LEN32=16,MAX_COUNTER=2**32-1,U32_EMPTY=new Uint32Array;function runCipher(t,n,s,a,l,c,h,y){const g=l.length,m=new Uint8Array(BLOCK_LEN),b=u32(m),v=isAligned32(l)&&isAligned32(c),w=v?u32(l):U32_EMPTY,S=v?u32(c):U32_EMPTY;for(let A=0;A<g;h++){if(t(n,s,a,b,h,y),h>=MAX_COUNTER)throw new Error("arx: counter overflow");const B=Math.min(BLOCK_LEN,g-A);if(v&&B===BLOCK_LEN){const N=A/4;if(A%4!==0)throw new Error("arx: invalid block position");for(let L=0,G;L<BLOCK_LEN32;L++)G=N+L,S[G]=w[G]^b[L];A+=BLOCK_LEN;continue}for(let N=0,L;N<B;N++)L=A+N,c[L]=l[L]^m[N];A+=B}}function createCipher(t,n){const{allowShortKeys:s,extendNonceFn:a,counterLength:l,counterRight:c,rounds:h}=checkOpts({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},n);if(typeof t!="function")throw new Error("core must be a function");return number(l),number(h),bool(c),bool(s),(y,g,m,b,v=0)=>{bytes(y),bytes(g),bytes(m);const w=m.length;if(b||(b=new Uint8Array(w)),bytes(b),number(v),v<0||v>=MAX_COUNTER)throw new Error("arx: counter overflow");if(b.length<w)throw new Error(`arx: output (${b.length}) is shorter than data (${w})`);const S=[];let A=y.length,B,N;if(A===32)B=y.slice(),S.push(B),N=sigma32_32;else if(A===16&&s)B=new Uint8Array(32),B.set(y),B.set(y,16),N=sigma16_32,S.push(B);else throw new Error(`arx: invalid 32-byte key, got length=${A}`);isAligned32(g)||(g=g.slice(),S.push(g));const L=u32(B);if(a){if(g.length!==24)throw new Error("arx: extended nonce must be 24 bytes");a(N,L,u32(g.subarray(0,16)),L),g=g.subarray(16)}const G=16-l;if(G!==g.length)throw new Error(`arx: nonce must be ${G} or 16 bytes`);if(G!==12){const ie=new Uint8Array(12);ie.set(g,c?0:12-g.length),g=ie,S.push(g)}const V=u32(g);for(runCipher(t,N,L,V,m,b,v,h);S.length>0;)S.pop().fill(0);return b}}function chachaCore(t,n,s,a,l,c=20){let h=t[0],y=t[1],g=t[2],m=t[3],b=n[0],v=n[1],w=n[2],S=n[3],A=n[4],B=n[5],N=n[6],L=n[7],G=l,V=s[0],ie=s[1],k=s[2],$=h,j=y,I=g,X=m,te=b,H=v,z=w,C=S,O=A,_=B,R=N,U=L,Y=G,J=V,T=ie,D=k;for(let re=0;re<c;re+=2)$=$+te|0,Y=rotl(Y^$,16),O=O+Y|0,te=rotl(te^O,12),$=$+te|0,Y=rotl(Y^$,8),O=O+Y|0,te=rotl(te^O,7),j=j+H|0,J=rotl(J^j,16),_=_+J|0,H=rotl(H^_,12),j=j+H|0,J=rotl(J^j,8),_=_+J|0,H=rotl(H^_,7),I=I+z|0,T=rotl(T^I,16),R=R+T|0,z=rotl(z^R,12),I=I+z|0,T=rotl(T^I,8),R=R+T|0,z=rotl(z^R,7),X=X+C|0,D=rotl(D^X,16),U=U+D|0,C=rotl(C^U,12),X=X+C|0,D=rotl(D^X,8),U=U+D|0,C=rotl(C^U,7),$=$+H|0,D=rotl(D^$,16),R=R+D|0,H=rotl(H^R,12),$=$+H|0,D=rotl(D^$,8),R=R+D|0,H=rotl(H^R,7),j=j+z|0,Y=rotl(Y^j,16),U=U+Y|0,z=rotl(z^U,12),j=j+z|0,Y=rotl(Y^j,8),U=U+Y|0,z=rotl(z^U,7),I=I+C|0,J=rotl(J^I,16),O=O+J|0,C=rotl(C^O,12),I=I+C|0,J=rotl(J^I,8),O=O+J|0,C=rotl(C^O,7),X=X+te|0,T=rotl(T^X,16),_=_+T|0,te=rotl(te^_,12),X=X+te|0,T=rotl(T^X,8),_=_+T|0,te=rotl(te^_,7);let Q=0;a[Q++]=h+$|0,a[Q++]=y+j|0,a[Q++]=g+I|0,a[Q++]=m+X|0,a[Q++]=b+te|0,a[Q++]=v+H|0,a[Q++]=w+z|0,a[Q++]=S+C|0,a[Q++]=A+O|0,a[Q++]=B+_|0,a[Q++]=N+R|0,a[Q++]=L+U|0,a[Q++]=G+Y|0,a[Q++]=V+J|0,a[Q++]=ie+T|0,a[Q++]=k+D|0}const chacha20=createCipher(chachaCore,{counterRight:!1,counterLength:4,allowShortKeys:!1});let HMAC$1=class extends Hash$1{constructor(n,s){super(),this.finished=!1,this.destroyed=!1,assert.hash(n);const a=toBytes$1(s);if(this.iHash=n.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const l=this.blockLen,c=new Uint8Array(l);c.set(a.length>l?n.create().update(a).digest():a);for(let h=0;h<c.length;h++)c[h]^=54;this.iHash.update(c),this.oHash=n.create();for(let h=0;h<c.length;h++)c[h]^=106;this.oHash.update(c),c.fill(0)}update(n){return assert.exists(this),this.iHash.update(n),this}digestInto(n){assert.exists(this),assert.bytes(n,this.outputLen),this.finished=!0,this.iHash.digestInto(n),this.oHash.update(n),this.oHash.digestInto(n),this.destroy()}digest(){const n=new Uint8Array(this.oHash.outputLen);return this.digestInto(n),n}_cloneInto(n){n||(n=Object.create(Object.getPrototypeOf(this),{}));const{oHash:s,iHash:a,finished:l,destroyed:c,blockLen:h,outputLen:y}=this;return n=n,n.finished=l,n.destroyed=c,n.blockLen=h,n.outputLen=y,n.oHash=s._cloneInto(n.oHash),n.iHash=a._cloneInto(n.iHash),n}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$1=(t,n,s)=>new HMAC$1(t,n).update(s).digest();hmac$1.create=(t,n)=>new HMAC$1(t,n);function extract(t,n,s){return assert.hash(t),hmac$1(t,toBytes$1(s),toBytes$1(n))}const HKDF_COUNTER=new Uint8Array([0]),EMPTY_BUFFER=new Uint8Array;function expand(t,n,s,a=32){if(assert.hash(t),assert.number(a),a>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const l=Math.ceil(a/t.outputLen);s===void 0&&(s=EMPTY_BUFFER);const c=new Uint8Array(l*t.outputLen),h=hmac$1.create(t,n),y=h._cloneInto(),g=new Uint8Array(h.outputLen);for(let m=0;m<l;m++)HKDF_COUNTER[0]=m+1,y.update(m===0?EMPTY_BUFFER:g).update(s).update(HKDF_COUNTER).digestInto(g),c.set(g,t.outputLen*m),h._cloneInto(y);return h.destroy(),y.destroy(),g.fill(0),HKDF_COUNTER.fill(0),c.slice(0,a)}var __defProp=Object.defineProperty,__export=(t,n)=>{for(var s in n)__defProp(t,s,{get:n[s],enumerable:!0})},verifiedSymbol=Symbol("verified"),isRecord=t=>t instanceof Object;function validateEvent(t){if(!isRecord(t)||typeof t.kind!="number"||typeof t.content!="string"||typeof t.created_at!="number"||typeof t.pubkey!="string"||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let n=0;n<t.tags.length;n++){let s=t.tags[n];if(!Array.isArray(s))return!1;for(let a=0;a<s.length;a++)if(typeof s[a]!="string")return!1}return!0}var utils_exports={};__export(utils_exports,{Queue:()=>Queue$1,QueueNode:()=>QueueNode,binarySearch:()=>binarySearch,bytesToHex:()=>bytesToHex$1,hexToBytes:()=>hexToBytes$1,insertEventIntoAscendingList:()=>insertEventIntoAscendingList,insertEventIntoDescendingList:()=>insertEventIntoDescendingList,normalizeURL:()=>normalizeURL,utf8Decoder:()=>utf8Decoder,utf8Encoder:()=>utf8Encoder});var utf8Decoder=new TextDecoder("utf-8"),utf8Encoder=new TextEncoder;function normalizeURL(t){try{t.indexOf("://")===-1&&(t="wss://"+t);let n=new URL(t);return n.pathname=n.pathname.replace(/\/+/g,"/"),n.pathname.endsWith("/")&&(n.pathname=n.pathname.slice(0,-1)),(n.port==="80"&&n.protocol==="ws:"||n.port==="443"&&n.protocol==="wss:")&&(n.port=""),n.searchParams.sort(),n.hash="",n.toString()}catch{throw new Error(`Invalid URL: ${t}`)}}function insertEventIntoDescendingList(t,n){const[s,a]=binarySearch(t,l=>n.id===l.id?0:n.created_at===l.created_at?-1:l.created_at-n.created_at);return a||t.splice(s,0,n),t}function insertEventIntoAscendingList(t,n){const[s,a]=binarySearch(t,l=>n.id===l.id?0:n.created_at===l.created_at?-1:n.created_at-l.created_at);return a||t.splice(s,0,n),t}function binarySearch(t,n){let s=0,a=t.length-1;for(;s<=a;){const l=Math.floor((s+a)/2),c=n(t[l]);if(c===0)return[l,!0];c<0?a=l-1:s=l+1}return[s,!1]}var QueueNode=class{value;next=null;prev=null;constructor(t){this.value=t}},Queue$1=class{first;last;constructor(){this.first=null,this.last=null}enqueue(n){const s=new QueueNode(n);return this.last?this.last===this.first?(this.last=s,this.last.prev=this.first,this.first.next=s):(s.prev=this.last,this.last.next=s,this.last=s):(this.first=s,this.last=s),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const s=this.first;return this.first=null,this.last=null,s.value}const n=this.first;return this.first=n.next,this.first&&(this.first.prev=null),n.value}},JS=class{generateSecretKey(){return schnorr$1.utils.randomPrivateKey()}getPublicKey(t){return bytesToHex$1(schnorr$1.getPublicKey(t))}finalizeEvent(t,n){const s=t;return s.pubkey=bytesToHex$1(schnorr$1.getPublicKey(n)),s.id=getEventHash$1(s),s.sig=bytesToHex$1(schnorr$1.sign(getEventHash$1(s),n)),s[verifiedSymbol]=!0,s}verifyEvent(t){if(typeof t[verifiedSymbol]=="boolean")return t[verifiedSymbol];const n=getEventHash$1(t);if(n!==t.id)return t[verifiedSymbol]=!1,!1;try{const s=schnorr$1.verify(t.sig,n,t.pubkey);return t[verifiedSymbol]=s,s}catch{return t[verifiedSymbol]=!1,!1}}};function serializeEvent(t){if(!validateEvent(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}function getEventHash$1(t){let n=sha256$2(utf8Encoder.encode(serializeEvent(t)));return bytesToHex$1(n)}var i=new JS,generateSecretKey=i.generateSecretKey,getPublicKey=i.getPublicKey,finalizeEvent=i.finalizeEvent,verifyEvent=i.verifyEvent,kinds_exports={};__export(kinds_exports,{Application:()=>Application,BadgeAward:()=>BadgeAward,BadgeDefinition:()=>BadgeDefinition,BlockedRelaysList:()=>BlockedRelaysList,BookmarkList:()=>BookmarkList,Bookmarksets:()=>Bookmarksets,Calendar:()=>Calendar,CalendarEventRSVP:()=>CalendarEventRSVP,ChannelCreation:()=>ChannelCreation,ChannelHideMessage:()=>ChannelHideMessage,ChannelMessage:()=>ChannelMessage,ChannelMetadata:()=>ChannelMetadata,ChannelMuteUser:()=>ChannelMuteUser,ClassifiedListing:()=>ClassifiedListing,ClientAuth:()=>ClientAuth,CommunitiesList:()=>CommunitiesList,CommunityDefinition:()=>CommunityDefinition,CommunityPostApproval:()=>CommunityPostApproval,Contacts:()=>Contacts,CreateOrUpdateProduct:()=>CreateOrUpdateProduct,CreateOrUpdateStall:()=>CreateOrUpdateStall,Curationsets:()=>Curationsets,Date:()=>Date2,DirectMessageRelaysList:()=>DirectMessageRelaysList,DraftClassifiedListing:()=>DraftClassifiedListing,DraftLong:()=>DraftLong,Emojisets:()=>Emojisets,EncryptedDirectMessage:()=>EncryptedDirectMessage,EventDeletion:()=>EventDeletion,FileMetadata:()=>FileMetadata,FileServerPreference:()=>FileServerPreference,Followsets:()=>Followsets,GenericRepost:()=>GenericRepost,Genericlists:()=>Genericlists,GiftWrap:()=>GiftWrap,HTTPAuth:()=>HTTPAuth,Handlerinformation:()=>Handlerinformation,Handlerrecommendation:()=>Handlerrecommendation,Highlights:()=>Highlights,InterestsList:()=>InterestsList,Interestsets:()=>Interestsets,JobFeedback:()=>JobFeedback,JobRequest:()=>JobRequest,JobResult:()=>JobResult,Label:()=>Label,LightningPubRPC:()=>LightningPubRPC,LiveChatMessage:()=>LiveChatMessage,LiveEvent:()=>LiveEvent,LongFormArticle:()=>LongFormArticle,Metadata:()=>Metadata,Mutelist:()=>Mutelist,NWCWalletInfo:()=>NWCWalletInfo,NWCWalletRequest:()=>NWCWalletRequest,NWCWalletResponse:()=>NWCWalletResponse,NostrConnect:()=>NostrConnect,OpenTimestamps:()=>OpenTimestamps,Pinlist:()=>Pinlist,PrivateDirectMessage:()=>PrivateDirectMessage,ProblemTracker:()=>ProblemTracker,ProfileBadges:()=>ProfileBadges,PublicChatsList:()=>PublicChatsList,Reaction:()=>Reaction,RecommendRelay:()=>RecommendRelay,RelayList:()=>RelayList,Relaysets:()=>Relaysets,Report:()=>Report,Reporting:()=>Reporting,Repost:()=>Repost,Seal:()=>Seal,SearchRelaysList:()=>SearchRelaysList,ShortTextNote:()=>ShortTextNote,Time:()=>Time,UserEmojiList:()=>UserEmojiList,UserStatuses:()=>UserStatuses,Zap:()=>Zap,ZapGoal:()=>ZapGoal,ZapRequest:()=>ZapRequest,classifyKind:()=>classifyKind,isAddressableKind:()=>isAddressableKind,isEphemeralKind:()=>isEphemeralKind,isKind:()=>isKind,isRegularKind:()=>isRegularKind,isReplaceableKind:()=>isReplaceableKind});function isRegularKind(t){return 1e3<=t&&t<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(t)}function isReplaceableKind(t){return[0,3].includes(t)||1e4<=t&&t<2e4}function isEphemeralKind(t){return 2e4<=t&&t<3e4}function isAddressableKind(t){return 3e4<=t&&t<4e4}function classifyKind(t){return isRegularKind(t)?"regular":isReplaceableKind(t)?"replaceable":isEphemeralKind(t)?"ephemeral":isAddressableKind(t)?"parameterized":"unknown"}function isKind(t,n){const s=n instanceof Array?n:[n];return validateEvent(t)&&s.includes(t.kind)||!1}var Metadata=0,ShortTextNote=1,RecommendRelay=2,Contacts=3,EncryptedDirectMessage=4,EventDeletion=5,Repost=6,Reaction=7,BadgeAward=8,Seal=13,PrivateDirectMessage=14,GenericRepost=16,ChannelCreation=40,ChannelMetadata=41,ChannelMessage=42,ChannelHideMessage=43,ChannelMuteUser=44,OpenTimestamps=1040,GiftWrap=1059,FileMetadata=1063,LiveChatMessage=1311,ProblemTracker=1971,Report=1984,Reporting=1984,Label=1985,CommunityPostApproval=4550,JobRequest=5999,JobResult=6999,JobFeedback=7e3,ZapGoal=9041,ZapRequest=9734,Zap=9735,Highlights=9802,Mutelist=1e4,Pinlist=10001,RelayList=10002,BookmarkList=10003,CommunitiesList=10004,PublicChatsList=10005,BlockedRelaysList=10006,SearchRelaysList=10007,InterestsList=10015,UserEmojiList=10030,DirectMessageRelaysList=10050,FileServerPreference=10096,NWCWalletInfo=13194,LightningPubRPC=21e3,ClientAuth=22242,NWCWalletRequest=23194,NWCWalletResponse=23195,NostrConnect=24133,HTTPAuth=27235,Followsets=3e4,Genericlists=30001,Relaysets=30002,Bookmarksets=30003,Curationsets=30004,ProfileBadges=30008,BadgeDefinition=30009,Interestsets=30015,CreateOrUpdateStall=30017,CreateOrUpdateProduct=30018,LongFormArticle=30023,DraftLong=30024,Emojisets=30030,Application=30078,LiveEvent=30311,UserStatuses=30315,ClassifiedListing=30402,DraftClassifiedListing=30403,Date2=31922,Time=31923,Calendar=31924,CalendarEventRSVP=31925,Handlerrecommendation=31989,Handlerinformation=31990,CommunityDefinition=34550;function matchFilter(t,n){if(t.ids&&t.ids.indexOf(n.id)===-1||t.kinds&&t.kinds.indexOf(n.kind)===-1||t.authors&&t.authors.indexOf(n.pubkey)===-1)return!1;for(let s in t)if(s[0]==="#"){let a=s.slice(1),l=t[`#${a}`];if(l&&!n.tags.find(([c,h])=>c===s.slice(1)&&l.indexOf(h)!==-1))return!1}return!(t.since&&n.created_at<t.since||t.until&&n.created_at>t.until)}function matchFilters(t,n){for(let s=0;s<t.length;s++)if(matchFilter(t[s],n))return!0;return!1}var fakejson_exports={};__export(fakejson_exports,{getHex64:()=>getHex64,getInt:()=>getInt,getSubscriptionId:()=>getSubscriptionId,matchEventId:()=>matchEventId,matchEventKind:()=>matchEventKind,matchEventPubkey:()=>matchEventPubkey});function getHex64(t,n){let s=n.length+3,a=t.indexOf(`"${n}":`)+s,l=t.slice(a).indexOf('"')+a+1;return t.slice(l,l+64)}function getInt(t,n){let s=n.length,a=t.indexOf(`"${n}":`)+s+3,l=t.slice(a),c=Math.min(l.indexOf(","),l.indexOf("}"));return parseInt(l.slice(0,c),10)}function getSubscriptionId(t){let n=t.slice(0,22).indexOf('"EVENT"');if(n===-1)return null;let s=t.slice(n+7+1).indexOf('"');if(s===-1)return null;let a=n+7+1+s,l=t.slice(a+1,80).indexOf('"');if(l===-1)return null;let c=a+1+l;return t.slice(a+1,c)}function matchEventId(t,n){return n===getHex64(t,"id")}function matchEventPubkey(t,n){return n===getHex64(t,"pubkey")}function matchEventKind(t,n){return n===getInt(t,"kind")}var nip42_exports={};__export(nip42_exports,{makeAuthEvent:()=>makeAuthEvent});function makeAuthEvent(t,n){return{kind:ClientAuth,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",n]],content:""}}var _WebSocket;try{_WebSocket=WebSocket}catch{}var _WebSocket2;try{_WebSocket2=WebSocket}catch{}var nip19_exports={};__export(nip19_exports,{BECH32_REGEX:()=>BECH32_REGEX$1,Bech32MaxSize:()=>Bech32MaxSize,NostrTypeGuard:()=>NostrTypeGuard,decode:()=>decode,decodeNostrURI:()=>decodeNostrURI,encodeBytes:()=>encodeBytes,naddrEncode:()=>naddrEncode,neventEncode:()=>neventEncode,noteEncode:()=>noteEncode,nprofileEncode:()=>nprofileEncode,npubEncode:()=>npubEncode,nsecEncode:()=>nsecEncode});var NostrTypeGuard={isNProfile:t=>/^nprofile1[a-z\d]+$/.test(t||""),isNEvent:t=>/^nevent1[a-z\d]+$/.test(t||""),isNAddr:t=>/^naddr1[a-z\d]+$/.test(t||""),isNSec:t=>/^nsec1[a-z\d]{58}$/.test(t||""),isNPub:t=>/^npub1[a-z\d]{58}$/.test(t||""),isNote:t=>/^note1[a-z\d]+$/.test(t||""),isNcryptsec:t=>/^ncryptsec1[a-z\d]+$/.test(t||"")},Bech32MaxSize=5e3,BECH32_REGEX$1=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array(t){const n=new Uint8Array(4);return n[0]=t>>24&255,n[1]=t>>16&255,n[2]=t>>8&255,n[3]=t&255,n}function decodeNostrURI(t){try{return t.startsWith("nostr:")&&(t=t.substring(6)),decode(t)}catch{return{type:"invalid",data:null}}}function decode(t){let{prefix:n,words:s}=bech32.decode(t,Bech32MaxSize),a=new Uint8Array(bech32.fromWords(s));switch(n){case"nprofile":{let l=parseTLV(a);if(!l[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(l[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$1(l[0][0]),relays:l[1]?l[1].map(c=>utf8Decoder.decode(c)):[]}}}case"nevent":{let l=parseTLV(a);if(!l[0]?.[0])throw new Error("missing TLV 0 for nevent");if(l[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(l[2]&&l[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(l[3]&&l[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$1(l[0][0]),relays:l[1]?l[1].map(c=>utf8Decoder.decode(c)):[],author:l[2]?.[0]?bytesToHex$1(l[2][0]):void 0,kind:l[3]?.[0]?parseInt(bytesToHex$1(l[3][0]),16):void 0}}}case"naddr":{let l=parseTLV(a);if(!l[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!l[2]?.[0])throw new Error("missing TLV 2 for naddr");if(l[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!l[3]?.[0])throw new Error("missing TLV 3 for naddr");if(l[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder.decode(l[0][0]),pubkey:bytesToHex$1(l[2][0]),kind:parseInt(bytesToHex$1(l[3][0]),16),relays:l[1]?l[1].map(c=>utf8Decoder.decode(c)):[]}}}case"nsec":return{type:n,data:a};case"npub":case"note":return{type:n,data:bytesToHex$1(a)};default:throw new Error(`unknown prefix ${n}`)}}function parseTLV(t){let n={},s=t;for(;s.length>0;){let a=s[0],l=s[1],c=s.slice(2,2+l);if(s=s.slice(2+l),c.length<l)throw new Error(`not enough data to read on TLV ${a}`);n[a]=n[a]||[],n[a].push(c)}return n}function nsecEncode(t){return encodeBytes("nsec",t)}function npubEncode(t){return encodeBytes("npub",hexToBytes$1(t))}function noteEncode(t){return encodeBytes("note",hexToBytes$1(t))}function encodeBech32(t,n){let s=bech32.toWords(n);return bech32.encode(t,s,Bech32MaxSize)}function encodeBytes(t,n){return encodeBech32(t,n)}function nprofileEncode(t){let n=encodeTLV({0:[hexToBytes$1(t.pubkey)],1:(t.relays||[]).map(s=>utf8Encoder.encode(s))});return encodeBech32("nprofile",n)}function neventEncode(t){let n;t.kind!==void 0&&(n=integerToUint8Array(t.kind));let s=encodeTLV({0:[hexToBytes$1(t.id)],1:(t.relays||[]).map(a=>utf8Encoder.encode(a)),2:t.author?[hexToBytes$1(t.author)]:[],3:n?[new Uint8Array(n)]:[]});return encodeBech32("nevent",s)}function naddrEncode(t){let n=new ArrayBuffer(4);new DataView(n).setUint32(0,t.kind,!1);let s=encodeTLV({0:[utf8Encoder.encode(t.identifier)],1:(t.relays||[]).map(a=>utf8Encoder.encode(a)),2:[hexToBytes$1(t.pubkey)],3:[new Uint8Array(n)]});return encodeBech32("naddr",s)}function encodeTLV(t){let n=[];return Object.entries(t).reverse().forEach(([s,a])=>{a.forEach(l=>{let c=new Uint8Array(l.length+2);c.set([parseInt(s)],0),c.set([l.length],1),c.set(l,2),n.push(c)})}),concatBytes$1(...n)}var nip04_exports={};__export(nip04_exports,{decrypt:()=>decrypt$1,encrypt:()=>encrypt$1});function encrypt$1(t,n,s){const a=t instanceof Uint8Array?bytesToHex$1(t):t,l=secp256k1$1.getSharedSecret(a,"02"+n),c=getNormalizedX(l);let h=Uint8Array.from(randomBytes$1(16)),y=utf8Encoder.encode(s),g=cbc(c,h).encrypt(y),m=base64.encode(new Uint8Array(g)),b=base64.encode(new Uint8Array(h.buffer));return`${m}?iv=${b}`}function decrypt$1(t,n,s){const a=t instanceof Uint8Array?bytesToHex$1(t):t;let[l,c]=s.split("?iv="),h=secp256k1$1.getSharedSecret(a,"02"+n),y=getNormalizedX(h),g=base64.decode(c),m=base64.decode(l),b=cbc(y,g).decrypt(m);return utf8Decoder.decode(b)}function getNormalizedX(t){return t.slice(1,33)}var nip05_exports={};__export(nip05_exports,{NIP05_REGEX:()=>NIP05_REGEX$1,isNip05:()=>isNip05,isValid:()=>isValid,queryProfile:()=>queryProfile,searchDomain:()=>searchDomain,useFetchImplementation:()=>useFetchImplementation});var NIP05_REGEX$1=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,isNip05=t=>NIP05_REGEX$1.test(t||""),_fetch;try{_fetch=fetch}catch(t){}function useFetchImplementation(t){_fetch=t}async function searchDomain(t,n=""){try{const s=`https://${t}/.well-known/nostr.json?name=${n}`,a=await _fetch(s,{redirect:"manual"});if(a.status!==200)throw Error("Wrong response code");return(await a.json()).names}catch{return{}}}async function queryProfile(t){const n=t.match(NIP05_REGEX$1);if(!n)return null;const[,s="_",a]=n;try{const l=`https://${a}/.well-known/nostr.json?name=${s}`,c=await _fetch(l,{redirect:"manual"});if(c.status!==200)throw Error("Wrong response code");const h=await c.json(),y=h.names[s];return y?{pubkey:y,relays:h.relays?.[y]}:null}catch{return null}}async function isValid(t,n){const s=await queryProfile(n);return s?s.pubkey===t:!1}var nip10_exports={};__export(nip10_exports,{parse:()=>parse});function parse(t){const n={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let s,a;for(let l=t.tags.length-1;l>=0;l--){const c=t.tags[l];if(c[0]==="e"&&c[1]){const[h,y,g,m,b]=c,v={id:y,relays:g?[g]:[],author:b};if(m==="root"){n.root=v;continue}if(m==="reply"){n.reply=v;continue}if(m==="mention"){n.mentions.push(v);continue}s?a=v:s=v,n.mentions.push(v);continue}if(c[0]==="q"&&c[1]){const[h,y,g]=c;n.quotes.push({id:y,relays:g?[g]:[]})}if(c[0]==="p"&&c[1]){n.profiles.push({pubkey:c[1],relays:c[2]?[c[2]]:[]});continue}}return n.root||(n.root=a||s||n.reply),n.reply||(n.reply=s||n.root),[n.reply,n.root].forEach(l=>{if(!l)return;let c=n.mentions.indexOf(l);if(c!==-1&&n.mentions.splice(c,1),l.author){let h=n.profiles.find(y=>y.pubkey===l.author);h&&h.relays&&(l.relays||(l.relays=[]),h.relays.forEach(y=>{l.relays?.indexOf(y)===-1&&l.relays.push(y)}),h.relays=l.relays)}}),n.mentions.forEach(l=>{if(l.author){let c=n.profiles.find(h=>h.pubkey===l.author);c&&c.relays&&(l.relays||(l.relays=[]),c.relays.forEach(h=>{l.relays.indexOf(h)===-1&&l.relays.push(h)}),c.relays=l.relays)}}),n}var nip11_exports={};__export(nip11_exports,{fetchRelayInformation:()=>fetchRelayInformation,useFetchImplementation:()=>useFetchImplementation2});var _fetch2;try{_fetch2=fetch}catch{}function useFetchImplementation2(t){_fetch2=t}async function fetchRelayInformation(t){return await(await fetch(t.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var nip13_exports={};__export(nip13_exports,{fastEventHash:()=>fastEventHash,getPow:()=>getPow,minePow:()=>minePow});function getPow(t){let n=0;for(let s=0;s<64;s+=8){const a=parseInt(t.substring(s,s+8),16);if(a===0)n+=32;else{n+=Math.clz32(a);break}}return n}function minePow(t,n){let s=0;const a=t,l=["nonce",s.toString(),n.toString()];for(a.tags.push(l);;){const c=Math.floor(new Date().getTime()/1e3);if(c!==a.created_at&&(s=0,a.created_at=c),l[1]=(++s).toString(),a.id=fastEventHash(a),getPow(a.id)>=n)break}return a}function fastEventHash(t){return bytesToHex$1(sha256$2(utf8Encoder.encode(JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content]))))}var nip17_exports={};__export(nip17_exports,{unwrapEvent:()=>unwrapEvent2,unwrapManyEvents:()=>unwrapManyEvents2,wrapEvent:()=>wrapEvent2,wrapManyEvents:()=>wrapManyEvents2});var nip59_exports={};__export(nip59_exports,{createRumor:()=>createRumor,createSeal:()=>createSeal,createWrap:()=>createWrap,unwrapEvent:()=>unwrapEvent,unwrapManyEvents:()=>unwrapManyEvents,wrapEvent:()=>wrapEvent$1,wrapManyEvents:()=>wrapManyEvents});var nip44_exports={};__export(nip44_exports,{decrypt:()=>decrypt2,encrypt:()=>encrypt2,getConversationKey:()=>getConversationKey,v2:()=>v2});var minPlaintextSize=1,maxPlaintextSize=65535;function getConversationKey(t,n){const s=secp256k1$1.getSharedSecret(t,"02"+n).subarray(1,33);return extract(sha256$2,s,"nip44-v2")}function getMessageKeys(t,n){const s=expand(sha256$2,t,n,76);return{chacha_key:s.subarray(0,32),chacha_nonce:s.subarray(32,44),hmac_key:s.subarray(44,76)}}function calcPaddedLen(t){if(!Number.isSafeInteger(t)||t<1)throw new Error("expected positive integer");if(t<=32)return 32;const n=1<<Math.floor(Math.log2(t-1))+1,s=n<=256?32:n/8;return s*(Math.floor((t-1)/s)+1)}function writeU16BE(t){if(!Number.isSafeInteger(t)||t<minPlaintextSize||t>maxPlaintextSize)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const n=new Uint8Array(2);return new DataView(n.buffer).setUint16(0,t,!1),n}function pad(t){const n=utf8Encoder.encode(t),s=n.length,a=writeU16BE(s),l=new Uint8Array(calcPaddedLen(s)-s);return concatBytes$1(a,n,l)}function unpad(t){const n=new DataView(t.buffer).getUint16(0),s=t.subarray(2,2+n);if(n<minPlaintextSize||n>maxPlaintextSize||s.length!==n||t.length!==2+calcPaddedLen(n))throw new Error("invalid padding");return utf8Decoder.decode(s)}function hmacAad(t,n,s){if(s.length!==32)throw new Error("AAD associated data must be 32 bytes");const a=concatBytes$1(s,n);return hmac$1(sha256$2,t,a)}function decodePayload(t){if(typeof t!="string")throw new Error("payload must be a valid string");const n=t.length;if(n<132||n>87472)throw new Error("invalid payload length: "+n);if(t[0]==="#")throw new Error("unknown encryption version");let s;try{s=base64.decode(t)}catch(c){throw new Error("invalid base64: "+c.message)}const a=s.length;if(a<99||a>65603)throw new Error("invalid data length: "+a);const l=s[0];if(l!==2)throw new Error("unknown encryption version "+l);return{nonce:s.subarray(1,33),ciphertext:s.subarray(33,-32),mac:s.subarray(-32)}}function encrypt2(t,n,s=randomBytes$1(32)){const{chacha_key:a,chacha_nonce:l,hmac_key:c}=getMessageKeys(n,s),h=pad(t),y=chacha20(a,l,h),g=hmacAad(c,y,s);return base64.encode(concatBytes$1(new Uint8Array([2]),s,y,g))}function decrypt2(t,n){const{nonce:s,ciphertext:a,mac:l}=decodePayload(t),{chacha_key:c,chacha_nonce:h,hmac_key:y}=getMessageKeys(n,s),g=hmacAad(y,a,s);if(!equalBytes(g,l))throw new Error("invalid MAC");const m=chacha20(c,h,a);return unpad(m)}var v2={utils:{getConversationKey,calcPaddedLen},encrypt:encrypt2,decrypt:decrypt2},TWO_DAYS=2880*60,now=()=>Math.round(Date.now()/1e3),randomNow=()=>Math.round(now()-Math.random()*TWO_DAYS),nip44ConversationKey=(t,n)=>getConversationKey(t,n),nip44Encrypt=(t,n,s)=>encrypt2(JSON.stringify(t),nip44ConversationKey(n,s)),nip44Decrypt=(t,n)=>JSON.parse(decrypt2(t.content,nip44ConversationKey(n,t.pubkey)));function createRumor(t,n){const s={created_at:now(),content:"",tags:[],...t,pubkey:getPublicKey(n)};return s.id=getEventHash$1(s),s}function createSeal(t,n,s){return finalizeEvent({kind:Seal,content:nip44Encrypt(t,n,s),created_at:randomNow(),tags:[]},n)}function createWrap(t,n){const s=generateSecretKey();return finalizeEvent({kind:GiftWrap,content:nip44Encrypt(t,s,n),created_at:randomNow(),tags:[["p",n]]},s)}function wrapEvent$1(t,n,s){const a=createRumor(t,n),l=createSeal(a,n,s);return createWrap(l,s)}function wrapManyEvents(t,n,s){if(!s||s.length===0)throw new Error("At least one recipient is required.");const a=getPublicKey(n),l=[wrapEvent$1(t,n,a)];return s.forEach(c=>{l.push(wrapEvent$1(t,n,c))}),l}function unwrapEvent(t,n){const s=nip44Decrypt(t,n);return nip44Decrypt(s,n)}function unwrapManyEvents(t,n){let s=[];return t.forEach(a=>{s.push(unwrapEvent(a,n))}),s.sort((a,l)=>a.created_at-l.created_at),s}function createEvent(t,n,s,a){const l={created_at:Math.ceil(Date.now()/1e3),kind:PrivateDirectMessage,tags:[],content:n};return(Array.isArray(t)?t:[t]).forEach(({publicKey:h,relayUrl:y})=>{l.tags.push(y?["p",h,y]:["p",h])}),a&&l.tags.push(["e",a.eventId,a.relayUrl||"","reply"]),s&&l.tags.push(["subject",s]),l}function wrapEvent2(t,n,s,a,l){const c=createEvent(n,s,a,l);return wrapEvent$1(c,t,n.publicKey)}function wrapManyEvents2(t,n,s,a,l){if(!n||n.length===0)throw new Error("At least one recipient is required.");return[{publicKey:getPublicKey(t)},...n].map(h=>wrapEvent2(t,h,s,a,l))}var unwrapEvent2=unwrapEvent,unwrapManyEvents2=unwrapManyEvents,nip18_exports={};__export(nip18_exports,{finishRepostEvent:()=>finishRepostEvent,getRepostedEvent:()=>getRepostedEvent,getRepostedEventPointer:()=>getRepostedEventPointer});function finishRepostEvent(t,n,s,a){let l;const c=[...t.tags??[],["e",n.id,s],["p",n.pubkey]];return n.kind===ShortTextNote?l=Repost:(l=GenericRepost,c.push(["k",String(n.kind)])),finalizeEvent({kind:l,tags:c,content:t.content===""||n.tags?.find(h=>h[0]==="-")?"":JSON.stringify(n),created_at:t.created_at},a)}function getRepostedEventPointer(t){if(![Repost,GenericRepost].includes(t.kind))return;let n,s;for(let a=t.tags.length-1;a>=0&&(n===void 0||s===void 0);a--){const l=t.tags[a];l.length>=2&&(l[0]==="e"&&n===void 0?n=l:l[0]==="p"&&s===void 0&&(s=l))}if(n!==void 0)return{id:n[1],relays:[n[2],s?.[2]].filter(a=>typeof a=="string"),author:s?.[1]}}function getRepostedEvent(t,{skipVerification:n}={}){const s=getRepostedEventPointer(t);if(s===void 0||t.content==="")return;let a;try{a=JSON.parse(t.content)}catch{return}if(a.id===s.id&&!(!n&&!verifyEvent(a)))return a}var nip21_exports={};__export(nip21_exports,{NOSTR_URI_REGEX:()=>NOSTR_URI_REGEX,parse:()=>parse2,test:()=>test});var NOSTR_URI_REGEX=new RegExp(`nostr:(${BECH32_REGEX$1.source})`);function test(t){return typeof t=="string"&&new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(t)}function parse2(t){const n=t.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));if(!n)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:n[0],value:n[1],decoded:decode(n[1])}}var nip25_exports={};__export(nip25_exports,{finishReactionEvent:()=>finishReactionEvent,getReactedEventPointer:()=>getReactedEventPointer});function finishReactionEvent(t,n,s){const a=n.tags.filter(l=>l.length>=2&&(l[0]==="e"||l[0]==="p"));return finalizeEvent({...t,kind:Reaction,tags:[...t.tags??[],...a,["e",n.id],["p",n.pubkey]],content:t.content??"+"},s)}function getReactedEventPointer(t){if(t.kind!==Reaction)return;let n,s;for(let a=t.tags.length-1;a>=0&&(n===void 0||s===void 0);a--){const l=t.tags[a];l.length>=2&&(l[0]==="e"&&n===void 0?n=l:l[0]==="p"&&s===void 0&&(s=l))}if(!(n===void 0||s===void 0))return{id:n[1],relays:[n[2],s[2]].filter(a=>a!==void 0),author:s[1]}}var nip27_exports={};__export(nip27_exports,{parse:()=>parse3});var noCharacter=/\W/m,noURLCharacter=/\W |\W$|$|,| /m;function*parse3(t){const n=t.length;let s=0,a=0;for(;a<n;){let l=t.indexOf(":",a);if(l===-1)break;if(t.substring(l-5,l)==="nostr"){const c=t.substring(l+60).match(noCharacter),h=c?l+60+c.index:n;try{let y,{data:g,type:m}=decode(t.substring(l+1,h));switch(m){case"npub":y={pubkey:g};break;case"nsec":case"note":a=h+1;continue;default:y=g}s!==l-5&&(yield{type:"text",text:t.substring(s,l-5)}),yield{type:"reference",pointer:y},a=h,s=a;continue}catch{a=l+1;continue}}else if(t.substring(l-5,l)==="https"||t.substring(l-4,l)==="http"){const c=t.substring(l+4).match(noURLCharacter),h=c?l+4+c.index:n,y=t[l-1]==="s"?5:4;try{let g=new URL(t.substring(l-y,h));if(g.hostname.indexOf(".")===-1)throw new Error("invalid url");if(s!==l-y&&(yield{type:"text",text:t.substring(s,l-y)}),g.pathname.endsWith(".png")||g.pathname.endsWith(".jpg")||g.pathname.endsWith(".jpeg")||g.pathname.endsWith(".gif")||g.pathname.endsWith(".webp")){yield{type:"image",url:g.toString()},a=h,s=a;continue}if(g.pathname.endsWith(".mp4")||g.pathname.endsWith(".avi")||g.pathname.endsWith(".webm")||g.pathname.endsWith(".mkv")){yield{type:"video",url:g.toString()},a=h,s=a;continue}if(g.pathname.endsWith(".mp3")||g.pathname.endsWith(".aac")||g.pathname.endsWith(".ogg")||g.pathname.endsWith(".opus")){yield{type:"audio",url:g.toString()},a=h,s=a;continue}yield{type:"url",url:g.toString()},a=h,s=a;continue}catch{a=h+1;continue}}else if(t.substring(l-3,l)==="wss"||t.substring(l-2,l)==="ws"){const c=t.substring(l+4).match(noURLCharacter),h=c?l+4+c.index:n,y=t[l-1]==="s"?3:2;try{let g=new URL(t.substring(l-y,h));if(g.hostname.indexOf(".")===-1)throw new Error("invalid ws url");s!==l-y&&(yield{type:"text",text:t.substring(s,l-y)}),yield{type:"relay",url:g.toString()},a=h,s=a;continue}catch{a=h+1;continue}}else{a=l+1;continue}}s!==n&&(yield{type:"text",text:t.substring(s)})}var nip28_exports={};__export(nip28_exports,{channelCreateEvent:()=>channelCreateEvent,channelHideMessageEvent:()=>channelHideMessageEvent,channelMessageEvent:()=>channelMessageEvent,channelMetadataEvent:()=>channelMetadataEvent,channelMuteUserEvent:()=>channelMuteUserEvent});var channelCreateEvent=(t,n)=>{let s;if(typeof t.content=="object")s=JSON.stringify(t.content);else if(typeof t.content=="string")s=t.content;else return;return finalizeEvent({kind:ChannelCreation,tags:[...t.tags??[]],content:s,created_at:t.created_at},n)},channelMetadataEvent=(t,n)=>{let s;if(typeof t.content=="object")s=JSON.stringify(t.content);else if(typeof t.content=="string")s=t.content;else return;return finalizeEvent({kind:ChannelMetadata,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:s,created_at:t.created_at},n)},channelMessageEvent=(t,n)=>{const s=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&s.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),finalizeEvent({kind:ChannelMessage,tags:[...s,...t.tags??[]],content:t.content,created_at:t.created_at},n)},channelHideMessageEvent=(t,n)=>{let s;if(typeof t.content=="object")s=JSON.stringify(t.content);else if(typeof t.content=="string")s=t.content;else return;return finalizeEvent({kind:ChannelHideMessage,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:s,created_at:t.created_at},n)},channelMuteUserEvent=(t,n)=>{let s;if(typeof t.content=="object")s=JSON.stringify(t.content);else if(typeof t.content=="string")s=t.content;else return;return finalizeEvent({kind:ChannelMuteUser,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:s,created_at:t.created_at},n)},nip30_exports={};__export(nip30_exports,{EMOJI_SHORTCODE_REGEX:()=>EMOJI_SHORTCODE_REGEX,matchAll:()=>matchAll,regex:()=>regex,replaceAll:()=>replaceAll});var EMOJI_SHORTCODE_REGEX=/:(\w+):/,regex=()=>new RegExp(`\\B${EMOJI_SHORTCODE_REGEX.source}\\B`,"g");function*matchAll(t){const n=t.matchAll(regex());for(const s of n)try{const[a,l]=s;yield{shortcode:a,name:l,start:s.index,end:s.index+a.length}}catch{}}function replaceAll(t,n){return t.replaceAll(regex(),(s,a)=>n({shortcode:s,name:a}))}var nip39_exports={};__export(nip39_exports,{useFetchImplementation:()=>useFetchImplementation3,validateGithub:()=>validateGithub});var _fetch3;try{_fetch3=fetch}catch{}function useFetchImplementation3(t){_fetch3=t}async function validateGithub(t,n,s){try{return await(await _fetch3(`https://gist.github.com/${n}/${s}/raw`)).text()===`Verifying that I control the following Nostr public key: ${t}`}catch{return!1}}var nip47_exports={};__export(nip47_exports,{makeNwcRequestEvent:()=>makeNwcRequestEvent,parseConnectionString:()=>parseConnectionString});function parseConnectionString(t){const{host:n,pathname:s,searchParams:a}=new URL(t),l=s||n,c=a.get("relay"),h=a.get("secret");if(!l||!c||!h)throw new Error("invalid connection string");return{pubkey:l,relay:c,secret:h}}async function makeNwcRequestEvent(t,n,s){const l=encrypt$1(n,t,JSON.stringify({method:"pay_invoice",params:{invoice:s}})),c={kind:NWCWalletRequest,created_at:Math.round(Date.now()/1e3),content:l,tags:[["p",t]]};return finalizeEvent(c,n)}var nip54_exports={};__export(nip54_exports,{normalizeIdentifier:()=>normalizeIdentifier});function normalizeIdentifier(t){return t=t.trim().toLowerCase(),t=t.normalize("NFKC"),Array.from(t).map(n=>new RegExp("\\p{Letter}","u").test(n)||new RegExp("\\p{Number}","u").test(n)?n:"-").join("")}var nip57_exports={};__export(nip57_exports,{getSatoshisAmountFromBolt11:()=>getSatoshisAmountFromBolt11,getZapEndpoint:()=>getZapEndpoint,makeZapReceipt:()=>makeZapReceipt,makeZapRequest:()=>makeZapRequest,useFetchImplementation:()=>useFetchImplementation4,validateZapRequest:()=>validateZapRequest});var _fetch4;try{_fetch4=fetch}catch{}function useFetchImplementation4(t){_fetch4=t}async function getZapEndpoint(t){try{let n="",{lud06:s,lud16:a}=JSON.parse(t.content);if(s){let{words:h}=bech32.decode(s,1e3),y=bech32.fromWords(h);n=utf8Decoder.decode(y)}else if(a){let[h,y]=a.split("@");n=new URL(`/.well-known/lnurlp/${h}`,`https://${y}`).toString()}else return null;let c=await(await _fetch4(n)).json();if(c.allowsNostr&&c.nostrPubkey)return c.callback}catch{}return null}function makeZapRequest(t){let n={kind:9734,created_at:Math.round(Date.now()/1e3),content:t.comment||"",tags:[["p","pubkey"in t?t.pubkey:t.event.pubkey],["amount",t.amount.toString()],["relays",...t.relays]]};if("event"in t){if(n.tags.push(["e",t.event.id]),isReplaceableKind(t.event.kind)){const s=["a",`${t.event.kind}:${t.event.pubkey}:`];n.tags.push(s)}else if(isAddressableKind(t.event.kind)){let s=t.event.tags.find(([l,c])=>l==="d"&&c);if(!s)throw new Error("d tag not found or is empty");const a=["a",`${t.event.kind}:${t.event.pubkey}:${s[1]}`];n.tags.push(a)}n.tags.push(["k",t.event.kind.toString()])}return n}function validateZapRequest(t){let n;try{n=JSON.parse(t)}catch{return"Invalid zap request JSON."}if(!validateEvent(n))return"Zap request is not a valid Nostr event.";if(!verifyEvent(n))return"Invalid signature on zap request.";let s=n.tags.find(([c,h])=>c==="p"&&h);if(!s)return"Zap request doesn't have a 'p' tag.";if(!s[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let a=n.tags.find(([c,h])=>c==="e"&&h);return a&&!a[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":n.tags.find(([c,h])=>c==="relays"&&h)?null:"Zap request doesn't have a 'relays' tag."}function makeZapReceipt({zapRequest:t,preimage:n,bolt11:s,paidAt:a}){let l=JSON.parse(t),c=l.tags.filter(([y])=>y==="e"||y==="p"||y==="a"),h={kind:9735,created_at:Math.round(a.getTime()/1e3),content:"",tags:[...c,["P",l.pubkey],["bolt11",s],["description",t]]};return n&&h.tags.push(["preimage",n]),h}function getSatoshisAmountFromBolt11(t){if(t.length<50)return 0;t=t.substring(0,50);const n=t.lastIndexOf("1");if(n===-1)return 0;const s=t.substring(0,n);if(!s.startsWith("lnbc"))return 0;const a=s.substring(4);if(a.length<1)return 0;const l=a[a.length-1],c=l.charCodeAt(0)-48,h=c>=0&&c<=9;let y=a.length-1;if(h&&y++,y<1)return 0;const g=parseInt(a.substring(0,y));switch(l){case"m":return g*1e5;case"u":return g*100;case"n":return g/10;case"p":return g/1e4;default:return g*1e8}}var nip98_exports={};__export(nip98_exports,{getToken:()=>getToken,hashPayload:()=>hashPayload,unpackEventFromToken:()=>unpackEventFromToken,validateEvent:()=>validateEvent2,validateEventKind:()=>validateEventKind,validateEventMethodTag:()=>validateEventMethodTag,validateEventPayloadTag:()=>validateEventPayloadTag,validateEventTimestamp:()=>validateEventTimestamp,validateEventUrlTag:()=>validateEventUrlTag,validateToken:()=>validateToken});var _authorizationScheme="Nostr ";async function getToken(t,n,s,a=!1,l){const c={kind:HTTPAuth,tags:[["u",t],["method",n]],created_at:Math.round(new Date().getTime()/1e3),content:""};l&&c.tags.push(["payload",hashPayload(l)]);const h=await s(c);return(a?_authorizationScheme:"")+base64.encode(utf8Encoder.encode(JSON.stringify(h)))}async function validateToken(t,n,s){const a=await unpackEventFromToken(t).catch(c=>{throw c});return await validateEvent2(a,n,s).catch(c=>{throw c})}async function unpackEventFromToken(t){if(!t)throw new Error("Missing token");t=t.replace(_authorizationScheme,"");const n=utf8Decoder.decode(base64.decode(t));if(!n||n.length===0||!n.startsWith("{"))throw new Error("Invalid token");return JSON.parse(n)}function validateEventTimestamp(t){return t.created_at?Math.round(new Date().getTime()/1e3)-t.created_at<60:!1}function validateEventKind(t){return t.kind===HTTPAuth}function validateEventUrlTag(t,n){const s=t.tags.find(a=>a[0]==="u");return s?s.length>0&&s[1]===n:!1}function validateEventMethodTag(t,n){const s=t.tags.find(a=>a[0]==="method");return s?s.length>0&&s[1].toLowerCase()===n.toLowerCase():!1}function hashPayload(t){const n=sha256$2(utf8Encoder.encode(JSON.stringify(t)));return bytesToHex$1(n)}function validateEventPayloadTag(t,n){const s=t.tags.find(l=>l[0]==="payload");if(!s)return!1;const a=hashPayload(n);return s.length>0&&s[1]===a}async function validateEvent2(t,n,s,a){if(!verifyEvent(t))throw new Error("Invalid nostr event, signature invalid");if(!validateEventKind(t))throw new Error("Invalid nostr event, kind invalid");if(!validateEventTimestamp(t))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!validateEventUrlTag(t,n))throw new Error("Invalid nostr event, url tag invalid");if(!validateEventMethodTag(t,s))throw new Error("Invalid nostr event, method tag invalid");if(a&&typeof a=="object"&&Object.keys(a).length>0&&!validateEventPayloadTag(t,a))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}const crypto$1=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function anumber(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function abytes(t,...n){if(!isBytes(t))throw new Error("Uint8Array expected");if(n.length>0&&!n.includes(t.length))throw new Error("Uint8Array expected of length "+n+", got length="+t.length)}function ahash(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");anumber(t.outputLen),anumber(t.blockLen)}function aexists(t,n=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(n&&t.finished)throw new Error("Hash#digest() has already been called")}function aoutput(t,n){abytes(t);const s=n.outputLen;if(t.length<s)throw new Error("digestInto() expects output buffer of length at least "+s)}function clean(...t){for(let n=0;n<t.length;n++)t[n].fill(0)}function createView(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function rotr(t,n){return t<<32-n|t>>>n}const hasHexBuiltin=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));function bytesToHex(t){if(abytes(t),hasHexBuiltin)return t.toHex();let n="";for(let s=0;s<t.length;s++)n+=hexes[t[s]];return n}const asciis={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16(t){if(t>=asciis._0&&t<=asciis._9)return t-asciis._0;if(t>=asciis.A&&t<=asciis.F)return t-(asciis.A-10);if(t>=asciis.a&&t<=asciis.f)return t-(asciis.a-10)}function hexToBytes(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(hasHexBuiltin)return Uint8Array.fromHex(t);const n=t.length,s=n/2;if(n%2)throw new Error("hex string expected, got unpadded hex of length "+n);const a=new Uint8Array(s);for(let l=0,c=0;l<s;l++,c+=2){const h=asciiToBase16(t.charCodeAt(c)),y=asciiToBase16(t.charCodeAt(c+1));if(h===void 0||y===void 0){const g=t[c]+t[c+1];throw new Error('hex string expected, got non-hex character "'+g+'" at index '+c)}a[l]=h*16+y}return a}function utf8ToBytes(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function toBytes(t){return typeof t=="string"&&(t=utf8ToBytes(t)),abytes(t),t}function concatBytes(...t){let n=0;for(let a=0;a<t.length;a++){const l=t[a];abytes(l),n+=l.length}const s=new Uint8Array(n);for(let a=0,l=0;a<t.length;a++){const c=t[a];s.set(c,l),l+=c.length}return s}class Hash{}function createHasher(t){const n=a=>t().update(toBytes(a)).digest(),s=t();return n.outputLen=s.outputLen,n.blockLen=s.blockLen,n.create=()=>t(),n}function randomBytes(t=32){if(crypto$1&&typeof crypto$1.getRandomValues=="function")return crypto$1.getRandomValues(new Uint8Array(t));if(crypto$1&&typeof crypto$1.randomBytes=="function")return Uint8Array.from(crypto$1.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64(t,n,s,a){if(typeof t.setBigUint64=="function")return t.setBigUint64(n,s,a);const l=BigInt(32),c=BigInt(4294967295),h=Number(s>>l&c),y=Number(s&c),g=a?4:0,m=a?0:4;t.setUint32(n+g,h,a),t.setUint32(n+m,y,a)}function Chi(t,n,s){return t&n^~t&s}function Maj(t,n,s){return t&n^t&s^n&s}class HashMD extends Hash{constructor(n,s,a,l){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=n,this.outputLen=s,this.padOffset=a,this.isLE=l,this.buffer=new Uint8Array(n),this.view=createView(this.buffer)}update(n){aexists(this),n=toBytes(n),abytes(n);const{view:s,buffer:a,blockLen:l}=this,c=n.length;for(let h=0;h<c;){const y=Math.min(l-this.pos,c-h);if(y===l){const g=createView(n);for(;l<=c-h;h+=l)this.process(g,h);continue}a.set(n.subarray(h,h+y),this.pos),this.pos+=y,h+=y,this.pos===l&&(this.process(s,0),this.pos=0)}return this.length+=n.length,this.roundClean(),this}digestInto(n){aexists(this),aoutput(n,this),this.finished=!0;const{buffer:s,view:a,blockLen:l,isLE:c}=this;let{pos:h}=this;s[h++]=128,clean(this.buffer.subarray(h)),this.padOffset>l-h&&(this.process(a,0),h=0);for(let v=h;v<l;v++)s[v]=0;setBigUint64(a,l-8,BigInt(this.length*8),c),this.process(a,0);const y=createView(n),g=this.outputLen;if(g%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const m=g/4,b=this.get();if(m>b.length)throw new Error("_sha2: outputLen bigger than state");for(let v=0;v<m;v++)y.setUint32(4*v,b[v],c)}digest(){const{buffer:n,outputLen:s}=this;this.digestInto(n);const a=n.slice(0,s);return this.destroy(),a}_cloneInto(n){n||(n=new this.constructor),n.set(...this.get());const{blockLen:s,buffer:a,length:l,finished:c,destroyed:h,pos:y}=this;return n.destroyed=h,n.finished=c,n.length=l,n.pos=y,l%s&&n.buffer.set(a),n}clone(){return this._cloneInto()}}const SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_K=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W=new Uint32Array(64);class SHA256 extends HashMD{constructor(n=32){super(64,n,8,!1),this.A=SHA256_IV[0]|0,this.B=SHA256_IV[1]|0,this.C=SHA256_IV[2]|0,this.D=SHA256_IV[3]|0,this.E=SHA256_IV[4]|0,this.F=SHA256_IV[5]|0,this.G=SHA256_IV[6]|0,this.H=SHA256_IV[7]|0}get(){const{A:n,B:s,C:a,D:l,E:c,F:h,G:y,H:g}=this;return[n,s,a,l,c,h,y,g]}set(n,s,a,l,c,h,y,g){this.A=n|0,this.B=s|0,this.C=a|0,this.D=l|0,this.E=c|0,this.F=h|0,this.G=y|0,this.H=g|0}process(n,s){for(let v=0;v<16;v++,s+=4)SHA256_W[v]=n.getUint32(s,!1);for(let v=16;v<64;v++){const w=SHA256_W[v-15],S=SHA256_W[v-2],A=rotr(w,7)^rotr(w,18)^w>>>3,B=rotr(S,17)^rotr(S,19)^S>>>10;SHA256_W[v]=B+SHA256_W[v-7]+A+SHA256_W[v-16]|0}let{A:a,B:l,C:c,D:h,E:y,F:g,G:m,H:b}=this;for(let v=0;v<64;v++){const w=rotr(y,6)^rotr(y,11)^rotr(y,25),S=b+w+Chi(y,g,m)+SHA256_K[v]+SHA256_W[v]|0,B=(rotr(a,2)^rotr(a,13)^rotr(a,22))+Maj(a,l,c)|0;b=m,m=g,g=y,y=h+S|0,h=c,c=l,l=a,a=S+B|0}a=a+this.A|0,l=l+this.B|0,c=c+this.C|0,h=h+this.D|0,y=y+this.E|0,g=g+this.F|0,m=m+this.G|0,b=b+this.H|0,this.set(a,l,c,h,y,g,m,b)}roundClean(){clean(SHA256_W)}destroy(){this.set(0,0,0,0,0,0,0,0),clean(this.buffer)}}const sha256$1=createHasher(()=>new SHA256);class HMAC extends Hash{constructor(n,s){super(),this.finished=!1,this.destroyed=!1,ahash(n);const a=toBytes(s);if(this.iHash=n.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const l=this.blockLen,c=new Uint8Array(l);c.set(a.length>l?n.create().update(a).digest():a);for(let h=0;h<c.length;h++)c[h]^=54;this.iHash.update(c),this.oHash=n.create();for(let h=0;h<c.length;h++)c[h]^=106;this.oHash.update(c),clean(c)}update(n){return aexists(this),this.iHash.update(n),this}digestInto(n){aexists(this),abytes(n,this.outputLen),this.finished=!0,this.iHash.digestInto(n),this.oHash.update(n),this.oHash.digestInto(n),this.destroy()}digest(){const n=new Uint8Array(this.oHash.outputLen);return this.digestInto(n),n}_cloneInto(n){n||(n=Object.create(Object.getPrototypeOf(this),{}));const{oHash:s,iHash:a,finished:l,destroyed:c,blockLen:h,outputLen:y}=this;return n=n,n.finished=l,n.destroyed=c,n.blockLen=h,n.outputLen=y,n.oHash=s._cloneInto(n.oHash),n.iHash=a._cloneInto(n.iHash),n}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac=(t,n,s)=>new HMAC(t,n).update(s).digest();hmac.create=(t,n)=>new HMAC(t,n);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$4=BigInt(0),_1n$4=BigInt(1);function _abool2(t,n=""){if(typeof t!="boolean"){const s=n&&`"${n}"`;throw new Error(s+"expected boolean, got type="+typeof t)}return t}function _abytes2(t,n,s=""){const a=isBytes(t),l=t?.length,c=n!==void 0;if(!a||c&&l!==n){const h=s&&`"${s}" `,y=c?` of length ${n}`:"",g=a?`length=${l}`:`type=${typeof t}`;throw new Error(h+"expected Uint8Array"+y+", got "+g)}return t}function numberToHexUnpadded(t){const n=t.toString(16);return n.length&1?"0"+n:n}function hexToNumber(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?_0n$4:BigInt("0x"+t)}function bytesToNumberBE(t){return hexToNumber(bytesToHex(t))}function bytesToNumberLE(t){return abytes(t),hexToNumber(bytesToHex(Uint8Array.from(t).reverse()))}function numberToBytesBE(t,n){return hexToBytes(t.toString(16).padStart(n*2,"0"))}function numberToBytesLE(t,n){return numberToBytesBE(t,n).reverse()}function ensureBytes(t,n,s){let a;if(typeof n=="string")try{a=hexToBytes(n)}catch(c){throw new Error(t+" must be hex string or Uint8Array, cause: "+c)}else if(isBytes(n))a=Uint8Array.from(n);else throw new Error(t+" must be hex string or Uint8Array");const l=a.length;if(typeof s=="number"&&l!==s)throw new Error(t+" of length "+s+" expected, got "+l);return a}const isPosBig=t=>typeof t=="bigint"&&_0n$4<=t;function inRange(t,n,s){return isPosBig(t)&&isPosBig(n)&&isPosBig(s)&&n<=t&&t<s}function aInRange(t,n,s,a){if(!inRange(n,s,a))throw new Error("expected valid "+t+": "+s+" <= n < "+a+", got "+n)}function bitLen(t){let n;for(n=0;t>_0n$4;t>>=_1n$4,n+=1);return n}const bitMask=t=>(_1n$4<<BigInt(t))-_1n$4;function createHmacDrbg(t,n,s){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof n!="number"||n<2)throw new Error("qByteLen must be a number");if(typeof s!="function")throw new Error("hmacFn must be a function");const a=S=>new Uint8Array(S),l=S=>Uint8Array.of(S);let c=a(t),h=a(t),y=0;const g=()=>{c.fill(1),h.fill(0),y=0},m=(...S)=>s(h,c,...S),b=(S=a(0))=>{h=m(l(0),S),c=m(),S.length!==0&&(h=m(l(1),S),c=m())},v=()=>{if(y++>=1e3)throw new Error("drbg: tried 1000 values");let S=0;const A=[];for(;S<n;){c=m();const B=c.slice();A.push(B),S+=c.length}return concatBytes(...A)};return(S,A)=>{g(),b(S);let B;for(;!(B=A(v()));)b();return g(),B}}function _validateObject(t,n,s={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function a(l,c,h){const y=t[l];if(h&&y===void 0)return;const g=typeof y;if(g!==c||y===null)throw new Error(`param "${l}" is invalid: expected ${c}, got ${g}`)}Object.entries(n).forEach(([l,c])=>a(l,c,!1)),Object.entries(s).forEach(([l,c])=>a(l,c,!0))}function memoized(t){const n=new WeakMap;return(s,...a)=>{const l=n.get(s);if(l!==void 0)return l;const c=t(s,...a);return n.set(s,c),c}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$3=BigInt(0),_1n$3=BigInt(1),_2n$2=BigInt(2),_3n$1=BigInt(3),_4n$1=BigInt(4),_5n=BigInt(5),_7n=BigInt(7),_8n=BigInt(8),_9n=BigInt(9),_16n=BigInt(16);function mod(t,n){const s=t%n;return s>=_0n$3?s:n+s}function pow2(t,n,s){let a=t;for(;n-- >_0n$3;)a*=a,a%=s;return a}function invert(t,n){if(t===_0n$3)throw new Error("invert: expected non-zero number");if(n<=_0n$3)throw new Error("invert: expected positive modulus, got "+n);let s=mod(t,n),a=n,l=_0n$3,c=_1n$3;for(;s!==_0n$3;){const y=a/s,g=a%s,m=l-c*y;a=s,s=g,l=c,c=m}if(a!==_1n$3)throw new Error("invert: does not exist");return mod(l,n)}function assertIsSquare(t,n,s){if(!t.eql(t.sqr(n),s))throw new Error("Cannot find square root")}function sqrt3mod4(t,n){const s=(t.ORDER+_1n$3)/_4n$1,a=t.pow(n,s);return assertIsSquare(t,a,n),a}function sqrt5mod8(t,n){const s=(t.ORDER-_5n)/_8n,a=t.mul(n,_2n$2),l=t.pow(a,s),c=t.mul(n,l),h=t.mul(t.mul(c,_2n$2),l),y=t.mul(c,t.sub(h,t.ONE));return assertIsSquare(t,y,n),y}function sqrt9mod16(t){const n=Field(t),s=tonelliShanks(t),a=s(n,n.neg(n.ONE)),l=s(n,a),c=s(n,n.neg(a)),h=(t+_7n)/_16n;return(y,g)=>{let m=y.pow(g,h),b=y.mul(m,a);const v=y.mul(m,l),w=y.mul(m,c),S=y.eql(y.sqr(b),g),A=y.eql(y.sqr(v),g);m=y.cmov(m,b,S),b=y.cmov(w,v,A);const B=y.eql(y.sqr(b),g),N=y.cmov(m,b,B);return assertIsSquare(y,N,g),N}}function tonelliShanks(t){if(t<_3n$1)throw new Error("sqrt is not defined for small field");let n=t-_1n$3,s=0;for(;n%_2n$2===_0n$3;)n/=_2n$2,s++;let a=_2n$2;const l=Field(t);for(;FpLegendre(l,a)===1;)if(a++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(s===1)return sqrt3mod4;let c=l.pow(a,n);const h=(n+_1n$3)/_2n$2;return function(g,m){if(g.is0(m))return m;if(FpLegendre(g,m)!==1)throw new Error("Cannot find square root");let b=s,v=g.mul(g.ONE,c),w=g.pow(m,n),S=g.pow(m,h);for(;!g.eql(w,g.ONE);){if(g.is0(w))return g.ZERO;let A=1,B=g.sqr(w);for(;!g.eql(B,g.ONE);)if(A++,B=g.sqr(B),A===b)throw new Error("Cannot find square root");const N=_1n$3<<BigInt(b-A-1),L=g.pow(v,N);b=A,v=g.sqr(L),w=g.mul(w,v),S=g.mul(S,L)}return S}}function FpSqrt(t){return t%_4n$1===_3n$1?sqrt3mod4:t%_8n===_5n?sqrt5mod8:t%_16n===_9n?sqrt9mod16(t):tonelliShanks(t)}const FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(t){const n={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},s=FIELD_FIELDS.reduce((a,l)=>(a[l]="function",a),n);return _validateObject(t,s),t}function FpPow(t,n,s){if(s<_0n$3)throw new Error("invalid exponent, negatives unsupported");if(s===_0n$3)return t.ONE;if(s===_1n$3)return n;let a=t.ONE,l=n;for(;s>_0n$3;)s&_1n$3&&(a=t.mul(a,l)),l=t.sqr(l),s>>=_1n$3;return a}function FpInvertBatch(t,n,s=!1){const a=new Array(n.length).fill(s?t.ZERO:void 0),l=n.reduce((h,y,g)=>t.is0(y)?h:(a[g]=h,t.mul(h,y)),t.ONE),c=t.inv(l);return n.reduceRight((h,y,g)=>t.is0(y)?h:(a[g]=t.mul(h,a[g]),t.mul(h,y)),c),a}function FpLegendre(t,n){const s=(t.ORDER-_1n$3)/_2n$2,a=t.pow(n,s),l=t.eql(a,t.ONE),c=t.eql(a,t.ZERO),h=t.eql(a,t.neg(t.ONE));if(!l&&!c&&!h)throw new Error("invalid Legendre symbol result");return l?1:c?0:-1}function nLength(t,n){n!==void 0&&anumber(n);const s=n!==void 0?n:t.toString(2).length,a=Math.ceil(s/8);return{nBitLength:s,nByteLength:a}}function Field(t,n,s=!1,a={}){if(t<=_0n$3)throw new Error("invalid field: expected ORDER > 0, got "+t);let l,c,h=!1,y;if(typeof n=="object"&&n!=null){if(a.sqrt||s)throw new Error("cannot specify opts in two arguments");const w=n;w.BITS&&(l=w.BITS),w.sqrt&&(c=w.sqrt),typeof w.isLE=="boolean"&&(s=w.isLE),typeof w.modFromBytes=="boolean"&&(h=w.modFromBytes),y=w.allowedLengths}else typeof n=="number"&&(l=n),a.sqrt&&(c=a.sqrt);const{nBitLength:g,nByteLength:m}=nLength(t,l);if(m>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let b;const v=Object.freeze({ORDER:t,isLE:s,BITS:g,BYTES:m,MASK:bitMask(g),ZERO:_0n$3,ONE:_1n$3,allowedLengths:y,create:w=>mod(w,t),isValid:w=>{if(typeof w!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof w);return _0n$3<=w&&w<t},is0:w=>w===_0n$3,isValidNot0:w=>!v.is0(w)&&v.isValid(w),isOdd:w=>(w&_1n$3)===_1n$3,neg:w=>mod(-w,t),eql:(w,S)=>w===S,sqr:w=>mod(w*w,t),add:(w,S)=>mod(w+S,t),sub:(w,S)=>mod(w-S,t),mul:(w,S)=>mod(w*S,t),pow:(w,S)=>FpPow(v,w,S),div:(w,S)=>mod(w*invert(S,t),t),sqrN:w=>w*w,addN:(w,S)=>w+S,subN:(w,S)=>w-S,mulN:(w,S)=>w*S,inv:w=>invert(w,t),sqrt:c||(w=>(b||(b=FpSqrt(t)),b(v,w))),toBytes:w=>s?numberToBytesLE(w,m):numberToBytesBE(w,m),fromBytes:(w,S=!0)=>{if(y){if(!y.includes(w.length)||w.length>m)throw new Error("Field.fromBytes: expected "+y+" bytes, got "+w.length);const B=new Uint8Array(m);B.set(w,s?0:B.length-w.length),w=B}if(w.length!==m)throw new Error("Field.fromBytes: expected "+m+" bytes, got "+w.length);let A=s?bytesToNumberLE(w):bytesToNumberBE(w);if(h&&(A=mod(A,t)),!S&&!v.isValid(A))throw new Error("invalid field element: outside of range 0..ORDER");return A},invertBatch:w=>FpInvertBatch(v,w),cmov:(w,S,A)=>A?S:w});return Object.freeze(v)}function getFieldBytesLength(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const n=t.toString(2).length;return Math.ceil(n/8)}function getMinHashLength(t){const n=getFieldBytesLength(t);return n+Math.ceil(n/2)}function mapHashToField(t,n,s=!1){const a=t.length,l=getFieldBytesLength(n),c=getMinHashLength(n);if(a<16||a<c||a>1024)throw new Error("expected "+c+"-1024 bytes of input, got "+a);const h=s?bytesToNumberLE(t):bytesToNumberBE(t),y=mod(h,n-_1n$3)+_1n$3;return s?numberToBytesLE(y,l):numberToBytesBE(y,l)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$2=BigInt(0),_1n$2=BigInt(1);function negateCt(t,n){const s=n.negate();return t?s:n}function normalizeZ(t,n){const s=FpInvertBatch(t.Fp,n.map(a=>a.Z));return n.map((a,l)=>t.fromAffine(a.toAffine(s[l])))}function validateW(t,n){if(!Number.isSafeInteger(t)||t<=0||t>n)throw new Error("invalid window size, expected [1.."+n+"], got W="+t)}function calcWOpts(t,n){validateW(t,n);const s=Math.ceil(n/t)+1,a=2**(t-1),l=2**t,c=bitMask(t),h=BigInt(t);return{windows:s,windowSize:a,mask:c,maxNumber:l,shiftBy:h}}function calcOffsets(t,n,s){const{windowSize:a,mask:l,maxNumber:c,shiftBy:h}=s;let y=Number(t&l),g=t>>h;y>a&&(y-=c,g+=_1n$2);const m=n*a,b=m+Math.abs(y)-1,v=y===0,w=y<0,S=n%2!==0;return{nextN:g,offset:b,isZero:v,isNeg:w,isNegF:S,offsetF:m}}function validateMSMPoints(t,n){if(!Array.isArray(t))throw new Error("array expected");t.forEach((s,a)=>{if(!(s instanceof n))throw new Error("invalid point at index "+a)})}function validateMSMScalars(t,n){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((s,a)=>{if(!n.isValid(s))throw new Error("invalid scalar at index "+a)})}const pointPrecomputes=new WeakMap,pointWindowSizes=new WeakMap;function getW(t){return pointWindowSizes.get(t)||1}function assert0(t){if(t!==_0n$2)throw new Error("invalid wNAF")}class wNAF{constructor(n,s){this.BASE=n.BASE,this.ZERO=n.ZERO,this.Fn=n.Fn,this.bits=s}_unsafeLadder(n,s,a=this.ZERO){let l=n;for(;s>_0n$2;)s&_1n$2&&(a=a.add(l)),l=l.double(),s>>=_1n$2;return a}precomputeWindow(n,s){const{windows:a,windowSize:l}=calcWOpts(s,this.bits),c=[];let h=n,y=h;for(let g=0;g<a;g++){y=h,c.push(y);for(let m=1;m<l;m++)y=y.add(h),c.push(y);h=y.double()}return c}wNAF(n,s,a){if(!this.Fn.isValid(a))throw new Error("invalid scalar");let l=this.ZERO,c=this.BASE;const h=calcWOpts(n,this.bits);for(let y=0;y<h.windows;y++){const{nextN:g,offset:m,isZero:b,isNeg:v,isNegF:w,offsetF:S}=calcOffsets(a,y,h);a=g,b?c=c.add(negateCt(w,s[S])):l=l.add(negateCt(v,s[m]))}return assert0(a),{p:l,f:c}}wNAFUnsafe(n,s,a,l=this.ZERO){const c=calcWOpts(n,this.bits);for(let h=0;h<c.windows&&a!==_0n$2;h++){const{nextN:y,offset:g,isZero:m,isNeg:b}=calcOffsets(a,h,c);if(a=y,!m){const v=s[g];l=l.add(b?v.negate():v)}}return assert0(a),l}getPrecomputes(n,s,a){let l=pointPrecomputes.get(s);return l||(l=this.precomputeWindow(s,n),n!==1&&(typeof a=="function"&&(l=a(l)),pointPrecomputes.set(s,l))),l}cached(n,s,a){const l=getW(n);return this.wNAF(l,this.getPrecomputes(l,n,a),s)}unsafe(n,s,a,l){const c=getW(n);return c===1?this._unsafeLadder(n,s,l):this.wNAFUnsafe(c,this.getPrecomputes(c,n,a),s,l)}createCache(n,s){validateW(s,this.bits),pointWindowSizes.set(n,s),pointPrecomputes.delete(n)}hasCache(n){return getW(n)!==1}}function mulEndoUnsafe(t,n,s,a){let l=n,c=t.ZERO,h=t.ZERO;for(;s>_0n$2||a>_0n$2;)s&_1n$2&&(c=c.add(l)),a&_1n$2&&(h=h.add(l)),l=l.double(),s>>=_1n$2,a>>=_1n$2;return{p1:c,p2:h}}function pippenger(t,n,s,a){validateMSMPoints(s,t),validateMSMScalars(a,n);const l=s.length,c=a.length;if(l!==c)throw new Error("arrays of points and scalars must have equal length");const h=t.ZERO,y=bitLen(BigInt(l));let g=1;y>12?g=y-3:y>4?g=y-2:y>0&&(g=2);const m=bitMask(g),b=new Array(Number(m)+1).fill(h),v=Math.floor((n.BITS-1)/g)*g;let w=h;for(let S=v;S>=0;S-=g){b.fill(h);for(let B=0;B<c;B++){const N=a[B],L=Number(N>>BigInt(S)&m);b[L]=b[L].add(s[B])}let A=h;for(let B=b.length-1,N=h;B>0;B--)N=N.add(b[B]),A=A.add(N);if(w=w.add(A),S!==0)for(let B=0;B<g;B++)w=w.double()}return w}function createField(t,n,s){if(n){if(n.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return validateField(n),n}else return Field(t,{isLE:s})}function _createCurveFields(t,n,s={},a){if(a===void 0&&(a=t==="edwards"),!n||typeof n!="object")throw new Error(`expected valid ${t} CURVE object`);for(const g of["p","n","h"]){const m=n[g];if(!(typeof m=="bigint"&&m>_0n$2))throw new Error(`CURVE.${g} must be positive bigint`)}const l=createField(n.p,s.Fp,a),c=createField(n.n,s.Fn,a),y=["Gx","Gy","a","b"];for(const g of y)if(!l.isValid(n[g]))throw new Error(`CURVE.${g} must be valid field element of CURVE.Fp`);return n=Object.freeze(Object.assign({},n)),{CURVE:n,Fp:l,Fn:c}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const divNearest=(t,n)=>(t+(t>=0?n:-n)/_2n$1)/n;function _splitEndoScalar(t,n,s){const[[a,l],[c,h]]=n,y=divNearest(h*t,s),g=divNearest(-l*t,s);let m=t-y*a-g*c,b=-y*l-g*h;const v=m<_0n$1,w=b<_0n$1;v&&(m=-m),w&&(b=-b);const S=bitMask(Math.ceil(bitLen(s)/2))+_1n$1;if(m<_0n$1||m>=S||b<_0n$1||b>=S)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:v,k1:m,k2neg:w,k2:b}}function validateSigFormat(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function validateSigOpts(t,n){const s={};for(let a of Object.keys(n))s[a]=t[a]===void 0?n[a]:t[a];return _abool2(s.lowS,"lowS"),_abool2(s.prehash,"prehash"),s.format!==void 0&&validateSigFormat(s.format),s}class DERErr extends Error{constructor(n=""){super(n)}}const DER={Err:DERErr,_tlv:{encode:(t,n)=>{const{Err:s}=DER;if(t<0||t>256)throw new s("tlv.encode: wrong tag");if(n.length&1)throw new s("tlv.encode: unpadded data");const a=n.length/2,l=numberToHexUnpadded(a);if(l.length/2&128)throw new s("tlv.encode: long form length too big");const c=a>127?numberToHexUnpadded(l.length/2|128):"";return numberToHexUnpadded(t)+c+l+n},decode(t,n){const{Err:s}=DER;let a=0;if(t<0||t>256)throw new s("tlv.encode: wrong tag");if(n.length<2||n[a++]!==t)throw new s("tlv.decode: wrong tlv");const l=n[a++],c=!!(l&128);let h=0;if(!c)h=l;else{const g=l&127;if(!g)throw new s("tlv.decode(long): indefinite length not supported");if(g>4)throw new s("tlv.decode(long): byte length is too big");const m=n.subarray(a,a+g);if(m.length!==g)throw new s("tlv.decode: length bytes not complete");if(m[0]===0)throw new s("tlv.decode(long): zero leftmost byte");for(const b of m)h=h<<8|b;if(a+=g,h<128)throw new s("tlv.decode(long): not minimal encoding")}const y=n.subarray(a,a+h);if(y.length!==h)throw new s("tlv.decode: wrong value length");return{v:y,l:n.subarray(a+h)}}},_int:{encode(t){const{Err:n}=DER;if(t<_0n$1)throw new n("integer: negative integers are not allowed");let s=numberToHexUnpadded(t);if(Number.parseInt(s[0],16)&8&&(s="00"+s),s.length&1)throw new n("unexpected DER parsing assertion: unpadded hex");return s},decode(t){const{Err:n}=DER;if(t[0]&128)throw new n("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new n("invalid signature integer: unnecessary leading zero");return bytesToNumberBE(t)}},toSig(t){const{Err:n,_int:s,_tlv:a}=DER,l=ensureBytes("signature",t),{v:c,l:h}=a.decode(48,l);if(h.length)throw new n("invalid signature: left bytes after parsing");const{v:y,l:g}=a.decode(2,c),{v:m,l:b}=a.decode(2,g);if(b.length)throw new n("invalid signature: left bytes after parsing");return{r:s.decode(y),s:s.decode(m)}},hexFromSig(t){const{_tlv:n,_int:s}=DER,a=n.encode(2,s.encode(t.r)),l=n.encode(2,s.encode(t.s)),c=a+l;return n.encode(48,c)}},_0n$1=BigInt(0),_1n$1=BigInt(1),_2n$1=BigInt(2),_3n=BigInt(3),_4n=BigInt(4);function _normFnElement(t,n){const{BYTES:s}=t;let a;if(typeof n=="bigint")a=n;else{let l=ensureBytes("private key",n);try{a=t.fromBytes(l)}catch{throw new Error(`invalid private key: expected ui8a of size ${s}, got ${typeof n}`)}}if(!t.isValidNot0(a))throw new Error("invalid private key: out of range [1..N-1]");return a}function weierstrassN(t,n={}){const s=_createCurveFields("weierstrass",t,n),{Fp:a,Fn:l}=s;let c=s.CURVE;const{h,n:y}=c;_validateObject(n,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:g}=n;if(g&&(!a.is0(c.a)||typeof g.beta!="bigint"||!Array.isArray(g.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const m=getWLengths(a,l);function b(){if(!a.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function v(z,C,O){const{x:_,y:R}=C.toAffine(),U=a.toBytes(_);if(_abool2(O,"isCompressed"),O){b();const Y=!a.isOdd(R);return concatBytes(pprefix(Y),U)}else return concatBytes(Uint8Array.of(4),U,a.toBytes(R))}function w(z){_abytes2(z,void 0,"Point");const{publicKey:C,publicKeyUncompressed:O}=m,_=z.length,R=z[0],U=z.subarray(1);if(_===C&&(R===2||R===3)){const Y=a.fromBytes(U);if(!a.isValid(Y))throw new Error("bad point: is not on curve, wrong x");const J=B(Y);let T;try{T=a.sqrt(J)}catch(re){const oe=re instanceof Error?": "+re.message:"";throw new Error("bad point: is not on curve, sqrt error"+oe)}b();const D=a.isOdd(T);return(R&1)===1!==D&&(T=a.neg(T)),{x:Y,y:T}}else if(_===O&&R===4){const Y=a.BYTES,J=a.fromBytes(U.subarray(0,Y)),T=a.fromBytes(U.subarray(Y,Y*2));if(!N(J,T))throw new Error("bad point: is not on curve");return{x:J,y:T}}else throw new Error(`bad point: got length ${_}, expected compressed=${C} or uncompressed=${O}`)}const S=n.toBytes||v,A=n.fromBytes||w;function B(z){const C=a.sqr(z),O=a.mul(C,z);return a.add(a.add(O,a.mul(z,c.a)),c.b)}function N(z,C){const O=a.sqr(C),_=B(z);return a.eql(O,_)}if(!N(c.Gx,c.Gy))throw new Error("bad curve params: generator point");const L=a.mul(a.pow(c.a,_3n),_4n),G=a.mul(a.sqr(c.b),BigInt(27));if(a.is0(a.add(L,G)))throw new Error("bad curve params: a or b");function V(z,C,O=!1){if(!a.isValid(C)||O&&a.is0(C))throw new Error(`bad point coordinate ${z}`);return C}function ie(z){if(!(z instanceof X))throw new Error("ProjectivePoint expected")}function k(z){if(!g||!g.basises)throw new Error("no endo");return _splitEndoScalar(z,g.basises,l.ORDER)}const $=memoized((z,C)=>{const{X:O,Y:_,Z:R}=z;if(a.eql(R,a.ONE))return{x:O,y:_};const U=z.is0();C==null&&(C=U?a.ONE:a.inv(R));const Y=a.mul(O,C),J=a.mul(_,C),T=a.mul(R,C);if(U)return{x:a.ZERO,y:a.ZERO};if(!a.eql(T,a.ONE))throw new Error("invZ was invalid");return{x:Y,y:J}}),j=memoized(z=>{if(z.is0()){if(n.allowInfinityPoint&&!a.is0(z.Y))return;throw new Error("bad point: ZERO")}const{x:C,y:O}=z.toAffine();if(!a.isValid(C)||!a.isValid(O))throw new Error("bad point: x or y not field elements");if(!N(C,O))throw new Error("bad point: equation left != right");if(!z.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function I(z,C,O,_,R){return O=new X(a.mul(O.X,z),O.Y,O.Z),C=negateCt(_,C),O=negateCt(R,O),C.add(O)}class X{constructor(C,O,_){this.X=V("x",C),this.Y=V("y",O,!0),this.Z=V("z",_),Object.freeze(this)}static CURVE(){return c}static fromAffine(C){const{x:O,y:_}=C||{};if(!C||!a.isValid(O)||!a.isValid(_))throw new Error("invalid affine point");if(C instanceof X)throw new Error("projective point not allowed");return a.is0(O)&&a.is0(_)?X.ZERO:new X(O,_,a.ONE)}static fromBytes(C){const O=X.fromAffine(A(_abytes2(C,void 0,"point")));return O.assertValidity(),O}static fromHex(C){return X.fromBytes(ensureBytes("pointHex",C))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(C=8,O=!0){return H.createCache(this,C),O||this.multiply(_3n),this}assertValidity(){j(this)}hasEvenY(){const{y:C}=this.toAffine();if(!a.isOdd)throw new Error("Field doesn't support isOdd");return!a.isOdd(C)}equals(C){ie(C);const{X:O,Y:_,Z:R}=this,{X:U,Y,Z:J}=C,T=a.eql(a.mul(O,J),a.mul(U,R)),D=a.eql(a.mul(_,J),a.mul(Y,R));return T&&D}negate(){return new X(this.X,a.neg(this.Y),this.Z)}double(){const{a:C,b:O}=c,_=a.mul(O,_3n),{X:R,Y:U,Z:Y}=this;let J=a.ZERO,T=a.ZERO,D=a.ZERO,Q=a.mul(R,R),re=a.mul(U,U),oe=a.mul(Y,Y),le=a.mul(R,U);return le=a.add(le,le),D=a.mul(R,Y),D=a.add(D,D),J=a.mul(C,D),T=a.mul(_,oe),T=a.add(J,T),J=a.sub(re,T),T=a.add(re,T),T=a.mul(J,T),J=a.mul(le,J),D=a.mul(_,D),oe=a.mul(C,oe),le=a.sub(Q,oe),le=a.mul(C,le),le=a.add(le,D),D=a.add(Q,Q),Q=a.add(D,Q),Q=a.add(Q,oe),Q=a.mul(Q,le),T=a.add(T,Q),oe=a.mul(U,Y),oe=a.add(oe,oe),Q=a.mul(oe,le),J=a.sub(J,Q),D=a.mul(oe,re),D=a.add(D,D),D=a.add(D,D),new X(J,T,D)}add(C){ie(C);const{X:O,Y:_,Z:R}=this,{X:U,Y,Z:J}=C;let T=a.ZERO,D=a.ZERO,Q=a.ZERO;const re=c.a,oe=a.mul(c.b,_3n);let le=a.mul(O,U),ue=a.mul(_,Y),me=a.mul(R,J),be=a.add(O,_),ve=a.add(U,Y);be=a.mul(be,ve),ve=a.add(le,ue),be=a.sub(be,ve),ve=a.add(O,R);let Ue=a.add(U,J);return ve=a.mul(ve,Ue),Ue=a.add(le,me),ve=a.sub(ve,Ue),Ue=a.add(_,R),T=a.add(Y,J),Ue=a.mul(Ue,T),T=a.add(ue,me),Ue=a.sub(Ue,T),Q=a.mul(re,ve),T=a.mul(oe,me),Q=a.add(T,Q),T=a.sub(ue,Q),Q=a.add(ue,Q),D=a.mul(T,Q),ue=a.add(le,le),ue=a.add(ue,le),me=a.mul(re,me),ve=a.mul(oe,ve),ue=a.add(ue,me),me=a.sub(le,me),me=a.mul(re,me),ve=a.add(ve,me),le=a.mul(ue,ve),D=a.add(D,le),le=a.mul(Ue,ve),T=a.mul(be,T),T=a.sub(T,le),le=a.mul(be,ue),Q=a.mul(Ue,Q),Q=a.add(Q,le),new X(T,D,Q)}subtract(C){return this.add(C.negate())}is0(){return this.equals(X.ZERO)}multiply(C){const{endo:O}=n;if(!l.isValidNot0(C))throw new Error("invalid scalar: out of range");let _,R;const U=Y=>H.cached(this,Y,J=>normalizeZ(X,J));if(O){const{k1neg:Y,k1:J,k2neg:T,k2:D}=k(C),{p:Q,f:re}=U(J),{p:oe,f:le}=U(D);R=re.add(le),_=I(O.beta,Q,oe,Y,T)}else{const{p:Y,f:J}=U(C);_=Y,R=J}return normalizeZ(X,[_,R])[0]}multiplyUnsafe(C){const{endo:O}=n,_=this;if(!l.isValid(C))throw new Error("invalid scalar: out of range");if(C===_0n$1||_.is0())return X.ZERO;if(C===_1n$1)return _;if(H.hasCache(this))return this.multiply(C);if(O){const{k1neg:R,k1:U,k2neg:Y,k2:J}=k(C),{p1:T,p2:D}=mulEndoUnsafe(X,_,U,J);return I(O.beta,T,D,R,Y)}else return H.unsafe(_,C)}multiplyAndAddUnsafe(C,O,_){const R=this.multiplyUnsafe(O).add(C.multiplyUnsafe(_));return R.is0()?void 0:R}toAffine(C){return $(this,C)}isTorsionFree(){const{isTorsionFree:C}=n;return h===_1n$1?!0:C?C(X,this):H.unsafe(this,y).is0()}clearCofactor(){const{clearCofactor:C}=n;return h===_1n$1?this:C?C(X,this):this.multiplyUnsafe(h)}isSmallOrder(){return this.multiplyUnsafe(h).is0()}toBytes(C=!0){return _abool2(C,"isCompressed"),this.assertValidity(),S(X,this,C)}toHex(C=!0){return bytesToHex(this.toBytes(C))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(C=!0){return this.toBytes(C)}_setWindowSize(C){this.precompute(C)}static normalizeZ(C){return normalizeZ(X,C)}static msm(C,O){return pippenger(X,l,C,O)}static fromPrivateKey(C){return X.BASE.multiply(_normFnElement(l,C))}}X.BASE=new X(c.Gx,c.Gy,a.ONE),X.ZERO=new X(a.ZERO,a.ONE,a.ZERO),X.Fp=a,X.Fn=l;const te=l.BITS,H=new wNAF(X,n.endo?Math.ceil(te/2):te);return X.BASE.precompute(8),X}function pprefix(t){return Uint8Array.of(t?2:3)}function getWLengths(t,n){return{secretKey:n.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*n.BYTES}}function ecdh(t,n={}){const{Fn:s}=t,a=n.randomBytes||randomBytes,l=Object.assign(getWLengths(t.Fp,s),{seed:getMinHashLength(s.ORDER)});function c(S){try{return!!_normFnElement(s,S)}catch{return!1}}function h(S,A){const{publicKey:B,publicKeyUncompressed:N}=l;try{const L=S.length;return A===!0&&L!==B||A===!1&&L!==N?!1:!!t.fromBytes(S)}catch{return!1}}function y(S=a(l.seed)){return mapHashToField(_abytes2(S,l.seed,"seed"),s.ORDER)}function g(S,A=!0){return t.BASE.multiply(_normFnElement(s,S)).toBytes(A)}function m(S){const A=y(S);return{secretKey:A,publicKey:g(A)}}function b(S){if(typeof S=="bigint")return!1;if(S instanceof t)return!0;const{secretKey:A,publicKey:B,publicKeyUncompressed:N}=l;if(s.allowedLengths||A===B)return;const L=ensureBytes("key",S).length;return L===B||L===N}function v(S,A,B=!0){if(b(S)===!0)throw new Error("first arg must be private key");if(b(A)===!1)throw new Error("second arg must be public key");const N=_normFnElement(s,S);return t.fromHex(A).multiply(N).toBytes(B)}return Object.freeze({getPublicKey:g,getSharedSecret:v,keygen:m,Point:t,utils:{isValidSecretKey:c,isValidPublicKey:h,randomSecretKey:y,isValidPrivateKey:c,randomPrivateKey:y,normPrivateKeyToScalar:S=>_normFnElement(s,S),precompute(S=8,A=t.BASE){return A.precompute(S,!1)}},lengths:l})}function ecdsa(t,n,s={}){ahash(n),_validateObject(s,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const a=s.randomBytes||randomBytes,l=s.hmac||((O,..._)=>hmac(n,O,concatBytes(..._))),{Fp:c,Fn:h}=t,{ORDER:y,BITS:g}=h,{keygen:m,getPublicKey:b,getSharedSecret:v,utils:w,lengths:S}=ecdh(t,s),A={prehash:!1,lowS:typeof s.lowS=="boolean"?s.lowS:!1,format:void 0,extraEntropy:!1},B="compact";function N(O){const _=y>>_1n$1;return O>_}function L(O,_){if(!h.isValidNot0(_))throw new Error(`invalid signature ${O}: out of range 1..Point.Fn.ORDER`);return _}function G(O,_){validateSigFormat(_);const R=S.signature,U=_==="compact"?R:_==="recovered"?R+1:void 0;return _abytes2(O,U,`${_} signature`)}class V{constructor(_,R,U){this.r=L("r",_),this.s=L("s",R),U!=null&&(this.recovery=U),Object.freeze(this)}static fromBytes(_,R=B){G(_,R);let U;if(R==="der"){const{r:D,s:Q}=DER.toSig(_abytes2(_));return new V(D,Q)}R==="recovered"&&(U=_[0],R="compact",_=_.subarray(1));const Y=h.BYTES,J=_.subarray(0,Y),T=_.subarray(Y,Y*2);return new V(h.fromBytes(J),h.fromBytes(T),U)}static fromHex(_,R){return this.fromBytes(hexToBytes(_),R)}addRecoveryBit(_){return new V(this.r,this.s,_)}recoverPublicKey(_){const R=c.ORDER,{r:U,s:Y,recovery:J}=this;if(J==null||![0,1,2,3].includes(J))throw new Error("recovery id invalid");if(y*_2n$1<R&&J>1)throw new Error("recovery id is ambiguous for h>1 curve");const D=J===2||J===3?U+y:U;if(!c.isValid(D))throw new Error("recovery id 2 or 3 invalid");const Q=c.toBytes(D),re=t.fromBytes(concatBytes(pprefix((J&1)===0),Q)),oe=h.inv(D),le=k(ensureBytes("msgHash",_)),ue=h.create(-le*oe),me=h.create(Y*oe),be=t.BASE.multiplyUnsafe(ue).add(re.multiplyUnsafe(me));if(be.is0())throw new Error("point at infinify");return be.assertValidity(),be}hasHighS(){return N(this.s)}toBytes(_=B){if(validateSigFormat(_),_==="der")return hexToBytes(DER.hexFromSig(this));const R=h.toBytes(this.r),U=h.toBytes(this.s);if(_==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return concatBytes(Uint8Array.of(this.recovery),R,U)}return concatBytes(R,U)}toHex(_){return bytesToHex(this.toBytes(_))}assertValidity(){}static fromCompact(_){return V.fromBytes(ensureBytes("sig",_),"compact")}static fromDER(_){return V.fromBytes(ensureBytes("sig",_),"der")}normalizeS(){return this.hasHighS()?new V(this.r,h.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return bytesToHex(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return bytesToHex(this.toBytes("compact"))}}const ie=s.bits2int||function(_){if(_.length>8192)throw new Error("input is too large");const R=bytesToNumberBE(_),U=_.length*8-g;return U>0?R>>BigInt(U):R},k=s.bits2int_modN||function(_){return h.create(ie(_))},$=bitMask(g);function j(O){return aInRange("num < 2^"+g,O,_0n$1,$),h.toBytes(O)}function I(O,_){return _abytes2(O,void 0,"message"),_?_abytes2(n(O),void 0,"prehashed message"):O}function X(O,_,R){if(["recovered","canonical"].some(ue=>ue in R))throw new Error("sign() legacy options not supported");const{lowS:U,prehash:Y,extraEntropy:J}=validateSigOpts(R,A);O=I(O,Y);const T=k(O),D=_normFnElement(h,_),Q=[j(D),j(T)];if(J!=null&&J!==!1){const ue=J===!0?a(S.secretKey):J;Q.push(ensureBytes("extraEntropy",ue))}const re=concatBytes(...Q),oe=T;function le(ue){const me=ie(ue);if(!h.isValidNot0(me))return;const be=h.inv(me),ve=t.BASE.multiply(me).toAffine(),Ue=h.create(ve.x);if(Ue===_0n$1)return;const bt=h.create(be*h.create(oe+Ue*D));if(bt===_0n$1)return;let Xe=(ve.x===Ue?0:2)|Number(ve.y&_1n$1),ot=bt;return U&&N(bt)&&(ot=h.neg(bt),Xe^=1),new V(Ue,ot,Xe)}return{seed:re,k2sig:le}}function te(O,_,R={}){O=ensureBytes("message",O);const{seed:U,k2sig:Y}=X(O,_,R);return createHmacDrbg(n.outputLen,h.BYTES,l)(U,Y)}function H(O){let _;const R=typeof O=="string"||isBytes(O),U=!R&&O!==null&&typeof O=="object"&&typeof O.r=="bigint"&&typeof O.s=="bigint";if(!R&&!U)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(U)_=new V(O.r,O.s);else if(R){try{_=V.fromBytes(ensureBytes("sig",O),"der")}catch(Y){if(!(Y instanceof DER.Err))throw Y}if(!_)try{_=V.fromBytes(ensureBytes("sig",O),"compact")}catch{return!1}}return _||!1}function z(O,_,R,U={}){const{lowS:Y,prehash:J,format:T}=validateSigOpts(U,A);if(R=ensureBytes("publicKey",R),_=I(ensureBytes("message",_),J),"strict"in U)throw new Error("options.strict was renamed to lowS");const D=T===void 0?H(O):V.fromBytes(ensureBytes("sig",O),T);if(D===!1)return!1;try{const Q=t.fromBytes(R);if(Y&&D.hasHighS())return!1;const{r:re,s:oe}=D,le=k(_),ue=h.inv(oe),me=h.create(le*ue),be=h.create(re*ue),ve=t.BASE.multiplyUnsafe(me).add(Q.multiplyUnsafe(be));return ve.is0()?!1:h.create(ve.x)===re}catch{return!1}}function C(O,_,R={}){const{prehash:U}=validateSigOpts(R,A);return _=I(_,U),V.fromBytes(O,"recovered").recoverPublicKey(_).toBytes()}return Object.freeze({keygen:m,getPublicKey:b,getSharedSecret:v,utils:w,lengths:S,Point:t,sign:te,verify:z,recoverPublicKey:C,Signature:V,hash:n})}function _weierstrass_legacy_opts_to_new(t){const n={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},s=t.Fp;let a=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(h=>Math.ceil(h/2)))):void 0;const l=Field(n.n,{BITS:t.nBitLength,allowedLengths:a,modFromBytes:t.wrapPrivateKey}),c={Fp:s,Fn:l,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:n,curveOpts:c}}function _ecdsa_legacy_opts_to_new(t){const{CURVE:n,curveOpts:s}=_weierstrass_legacy_opts_to_new(t),a={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:n,curveOpts:s,hash:t.hash,ecdsaOpts:a}}function _ecdsa_new_output_to_legacy(t,n){const s=n.Point;return Object.assign({},n,{ProjectivePoint:s,CURVE:Object.assign({},t,nLength(s.Fn.ORDER,s.Fn.BITS))})}function weierstrass(t){const{CURVE:n,curveOpts:s,hash:a,ecdsaOpts:l}=_ecdsa_legacy_opts_to_new(t),c=weierstrassN(n,s),h=ecdsa(c,a,l);return _ecdsa_new_output_to_legacy(t,h)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function createCurve(t,n){const s=a=>weierstrass({...t,hash:a});return{...s(n),create:s}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const secp256k1_CURVE={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},secp256k1_ENDO={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},_0n=BigInt(0),_1n=BigInt(1),_2n=BigInt(2);function sqrtMod(t){const n=secp256k1_CURVE.p,s=BigInt(3),a=BigInt(6),l=BigInt(11),c=BigInt(22),h=BigInt(23),y=BigInt(44),g=BigInt(88),m=t*t*t%n,b=m*m*t%n,v=pow2(b,s,n)*b%n,w=pow2(v,s,n)*b%n,S=pow2(w,_2n,n)*m%n,A=pow2(S,l,n)*S%n,B=pow2(A,c,n)*A%n,N=pow2(B,y,n)*B%n,L=pow2(N,g,n)*N%n,G=pow2(L,y,n)*B%n,V=pow2(G,s,n)*b%n,ie=pow2(V,h,n)*A%n,k=pow2(ie,a,n)*m%n,$=pow2(k,_2n,n);if(!Fpk1.eql(Fpk1.sqr($),t))throw new Error("Cannot find square root");return $}const Fpk1=Field(secp256k1_CURVE.p,{sqrt:sqrtMod}),secp256k1=createCurve({...secp256k1_CURVE,Fp:Fpk1,lowS:!0,endo:secp256k1_ENDO},sha256$1),TAGGED_HASH_PREFIXES={};function taggedHash(t,...n){let s=TAGGED_HASH_PREFIXES[t];if(s===void 0){const a=sha256$1(utf8ToBytes(t));s=concatBytes(a,a),TAGGED_HASH_PREFIXES[t]=s}return sha256$1(concatBytes(s,...n))}const pointToBytes=t=>t.toBytes(!0).slice(1),Pointk1=secp256k1.Point,hasEven=t=>t%_2n===_0n;function schnorrGetExtPubKey(t){const{Fn:n,BASE:s}=Pointk1,a=_normFnElement(n,t),l=s.multiply(a);return{scalar:hasEven(l.y)?a:n.neg(a),bytes:pointToBytes(l)}}function lift_x(t){const n=Fpk1;if(!n.isValidNot0(t))throw new Error("invalid x: Fail if x ≥ p");const s=n.create(t*t),a=n.create(s*t+BigInt(7));let l=n.sqrt(a);hasEven(l)||(l=n.neg(l));const c=Pointk1.fromAffine({x:t,y:l});return c.assertValidity(),c}const num=bytesToNumberBE;function challenge(...t){return Pointk1.Fn.create(num(taggedHash("BIP0340/challenge",...t)))}function schnorrGetPublicKey(t){return schnorrGetExtPubKey(t).bytes}function schnorrSign(t,n,s=randomBytes(32)){const{Fn:a}=Pointk1,l=ensureBytes("message",t),{bytes:c,scalar:h}=schnorrGetExtPubKey(n),y=ensureBytes("auxRand",s,32),g=a.toBytes(h^num(taggedHash("BIP0340/aux",y))),m=taggedHash("BIP0340/nonce",g,c,l),{bytes:b,scalar:v}=schnorrGetExtPubKey(m),w=challenge(b,c,l),S=new Uint8Array(64);if(S.set(b,0),S.set(a.toBytes(a.create(v+w*h)),32),!schnorrVerify(S,l,c))throw new Error("sign: Invalid signature produced");return S}function schnorrVerify(t,n,s){const{Fn:a,BASE:l}=Pointk1,c=ensureBytes("signature",t,64),h=ensureBytes("message",n),y=ensureBytes("publicKey",s,32);try{const g=lift_x(num(y)),m=num(c.subarray(0,32));if(!inRange(m,_1n,secp256k1_CURVE.p))return!1;const b=num(c.subarray(32,64));if(!inRange(b,_1n,secp256k1_CURVE.n))return!1;const v=challenge(a.toBytes(m),pointToBytes(g),h),w=l.multiplyUnsafe(b).add(g.multiplyUnsafe(a.neg(v))),{x:S,y:A}=w.toAffine();return!(w.is0()||!hasEven(A)||S!==m)}catch{return!1}}const schnorr=(()=>{const s=(l=randomBytes(48))=>mapHashToField(l,secp256k1_CURVE.n);secp256k1.utils.randomSecretKey;function a(l){const c=s(l);return{secretKey:c,publicKey:schnorrGetPublicKey(c)}}return{keygen:a,getPublicKey:schnorrGetPublicKey,sign:schnorrSign,verify:schnorrVerify,Point:Pointk1,utils:{randomSecretKey:s,randomPrivateKey:s,taggedHash,lift_x,pointToBytes,numberToBytesBE,bytesToNumberBE,mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})(),sha256=sha256$1;var dist={},LRUCache={},LRUCacheNode={},hasRequiredLRUCacheNode;function requireLRUCacheNode(){if(hasRequiredLRUCacheNode)return LRUCacheNode;hasRequiredLRUCacheNode=1,Object.defineProperty(LRUCacheNode,"__esModule",{value:!0}),LRUCacheNode.LRUCacheNode=void 0;let t=class{constructor(s,a,l){const{entryExpirationTimeInMS:c=null,next:h=null,prev:y=null,onEntryEvicted:g,onEntryMarkedAsMostRecentlyUsed:m,clone:b,cloneFn:v}=l??{};if(typeof c=="number"&&(c<=0||Number.isNaN(c)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.clone=b??!1,this.cloneFn=v??this.defaultClone,this.key=s,this.internalValue=this.clone?this.cloneFn(a):a,this.created=Date.now(),this.entryExpirationTimeInMS=c,this.next=h,this.prev=y,this.onEntryEvicted=g,this.onEntryMarkedAsMostRecentlyUsed=m}get value(){return this.clone?this.cloneFn(this.internalValue):this.internalValue}get isExpired(){return typeof this.entryExpirationTimeInMS=="number"&&Date.now()-this.created>this.entryExpirationTimeInMS}invokeOnEvicted(){if(this.onEntryEvicted){const{key:s,value:a,isExpired:l}=this;this.onEntryEvicted({key:s,value:a,isExpired:l})}}invokeOnEntryMarkedAsMostRecentlyUsed(){if(this.onEntryMarkedAsMostRecentlyUsed){const{key:s,value:a}=this;this.onEntryMarkedAsMostRecentlyUsed({key:s,value:a})}}defaultClone(s){return typeof s=="boolean"||typeof s=="string"||typeof s=="number"?s:JSON.parse(JSON.stringify(s))}};return LRUCacheNode.LRUCacheNode=t,LRUCacheNode}var hasRequiredLRUCache;function requireLRUCache(){if(hasRequiredLRUCache)return LRUCache;hasRequiredLRUCache=1,Object.defineProperty(LRUCache,"__esModule",{value:!0}),LRUCache.LRUCache=void 0;const t=requireLRUCacheNode();let n=class{constructor(a){this.lookupTable=new Map,this.head=null,this.tail=null;const{maxSize:l=25,entryExpirationTimeInMS:c=null,onEntryEvicted:h,onEntryMarkedAsMostRecentlyUsed:y,cloneFn:g,clone:m}=a??{};if(Number.isNaN(l)||l<=0)throw new Error("maxSize must be greater than 0.");if(typeof c=="number"&&(c<=0||Number.isNaN(c)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.maxSizeInternal=l,this.entryExpirationTimeInMS=c,this.onEntryEvicted=h,this.onEntryMarkedAsMostRecentlyUsed=y,this.clone=m,this.cloneFn=g}get size(){return this.cleanCache(),this.lookupTable.size}get remainingSize(){return this.maxSizeInternal-this.size}get newest(){return this.head?this.head.isExpired?(this.removeNodeFromListAndLookupTable(this.head),this.newest):this.mapNodeToEntry(this.head):null}get oldest(){return this.tail?this.tail.isExpired?(this.removeNodeFromListAndLookupTable(this.tail),this.oldest):this.mapNodeToEntry(this.tail):null}get maxSize(){return this.maxSizeInternal}set maxSize(a){if(Number.isNaN(a)||a<=0)throw new Error("maxSize must be greater than 0.");this.maxSizeInternal=a,this.enforceSizeLimit()}set(a,l,c){const h=this.lookupTable.get(a);h&&this.removeNodeFromListAndLookupTable(h);const y=new t.LRUCacheNode(a,l,{entryExpirationTimeInMS:this.entryExpirationTimeInMS,onEntryEvicted:this.onEntryEvicted,onEntryMarkedAsMostRecentlyUsed:this.onEntryMarkedAsMostRecentlyUsed,clone:this.clone,cloneFn:this.cloneFn,...c});return this.setNodeAsHead(y),this.lookupTable.set(a,y),this.enforceSizeLimit(),this}get(a){const l=this.lookupTable.get(a);return l?l.isExpired?(this.removeNodeFromListAndLookupTable(l),null):(this.setNodeAsHead(l),l.value):null}peek(a){const l=this.lookupTable.get(a);return l?l.isExpired?(this.removeNodeFromListAndLookupTable(l),null):l.value:null}delete(a){const l=this.lookupTable.get(a);return l?this.removeNodeFromListAndLookupTable(l):!1}has(a){const l=this.lookupTable.get(a);return l?l.isExpired?(this.removeNodeFromListAndLookupTable(l),!1):!0:!1}clear(){this.head=null,this.tail=null,this.lookupTable.clear()}find(a){let l=this.head;for(;l;){if(l.isExpired){const h=l.next;this.removeNodeFromListAndLookupTable(l),l=h;continue}const c=this.mapNodeToEntry(l);if(a(c))return this.setNodeAsHead(l),c;l=l.next}return null}forEach(a){let l=this.head,c=0;for(;l;){if(l.isExpired){const h=l.next;this.removeNodeFromListAndLookupTable(l),l=h;continue}a(l.value,l.key,c),l=l.next,c++}}*values(){let a=this.head;for(;a;){if(a.isExpired){const l=a.next;this.removeNodeFromListAndLookupTable(a),a=l;continue}yield a.value,a=a.next}}*keys(){let a=this.head;for(;a;){if(a.isExpired){const l=a.next;this.removeNodeFromListAndLookupTable(a),a=l;continue}yield a.key,a=a.next}}*entries(){let a=this.head;for(;a;){if(a.isExpired){const l=a.next;this.removeNodeFromListAndLookupTable(a),a=l;continue}yield this.mapNodeToEntry(a),a=a.next}}*[Symbol.iterator](){let a=this.head;for(;a;){if(a.isExpired){const l=a.next;this.removeNodeFromListAndLookupTable(a),a=l;continue}yield this.mapNodeToEntry(a),a=a.next}}enforceSizeLimit(){let a=this.tail;for(;a!==null&&this.size>this.maxSizeInternal;){const l=a.prev;this.removeNodeFromListAndLookupTable(a),a=l}}mapNodeToEntry({key:a,value:l}){return{key:a,value:l}}setNodeAsHead(a){this.removeNodeFromList(a),this.head?(a.next=this.head,this.head.prev=a,this.head=a):(this.head=a,this.tail=a),a.invokeOnEntryMarkedAsMostRecentlyUsed()}removeNodeFromList(a){a.prev!==null&&(a.prev.next=a.next),a.next!==null&&(a.next.prev=a.prev),this.head===a&&(this.head=a.next),this.tail===a&&(this.tail=a.prev),a.next=null,a.prev=null}removeNodeFromListAndLookupTable(a){return a.invokeOnEvicted(),this.removeNodeFromList(a),this.lookupTable.delete(a.key)}cleanCache(){if(!this.entryExpirationTimeInMS)return;const a=[];for(const l of this.lookupTable.values())l.isExpired&&a.push(l);a.forEach(l=>this.removeNodeFromListAndLookupTable(l))}};return LRUCache.LRUCache=n,LRUCache}var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,(function(t){var n=dist&&dist.__createBinding||(Object.create?(function(a,l,c,h){h===void 0&&(h=c);var y=Object.getOwnPropertyDescriptor(l,c);(!y||("get"in y?!l.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return l[c]}}),Object.defineProperty(a,h,y)}):(function(a,l,c,h){h===void 0&&(h=c),a[h]=l[c]})),s=dist&&dist.__exportStar||function(a,l){for(var c in a)c!=="default"&&!Object.prototype.hasOwnProperty.call(l,c)&&n(l,a,c)};Object.defineProperty(t,"__esModule",{value:!0}),s(requireLRUCache(),t)})(dist)),dist}var distExports=requireDist(),lib={},hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,(function(t){/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.bytes=t.stringToBytes=t.str=t.bytesToString=t.hex=t.utf8=t.bech32m=t.bech32=t.base58check=t.base58xmr=t.base58xrp=t.base58flickr=t.base58=t.base64url=t.base64=t.base32crockford=t.base32hex=t.base32=t.base16=t.utils=t.assertNumber=void 0;function n(H){if(!Number.isSafeInteger(H))throw new Error(`Wrong integer: ${H}`)}t.assertNumber=n;function s(...H){const z=(_,R)=>U=>_(R(U)),C=Array.from(H).reverse().reduce((_,R)=>_?z(_,R.encode):R.encode,void 0),O=H.reduce((_,R)=>_?z(_,R.decode):R.decode,void 0);return{encode:C,decode:O}}function a(H){return{encode:z=>{if(!Array.isArray(z)||z.length&&typeof z[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return z.map(C=>{if(n(C),C<0||C>=H.length)throw new Error(`Digit index outside alphabet: ${C} (alphabet: ${H.length})`);return H[C]})},decode:z=>{if(!Array.isArray(z)||z.length&&typeof z[0]!="string")throw new Error("alphabet.decode input should be array of strings");return z.map(C=>{if(typeof C!="string")throw new Error(`alphabet.decode: not string element=${C}`);const O=H.indexOf(C);if(O===-1)throw new Error(`Unknown letter: "${C}". Allowed: ${H}`);return O})}}}function l(H=""){if(typeof H!="string")throw new Error("join separator should be string");return{encode:z=>{if(!Array.isArray(z)||z.length&&typeof z[0]!="string")throw new Error("join.encode input should be array of strings");for(let C of z)if(typeof C!="string")throw new Error(`join.encode: non-string input=${C}`);return z.join(H)},decode:z=>{if(typeof z!="string")throw new Error("join.decode input should be string");return z.split(H)}}}function c(H,z="="){if(n(H),typeof z!="string")throw new Error("padding chr should be string");return{encode(C){if(!Array.isArray(C)||C.length&&typeof C[0]!="string")throw new Error("padding.encode input should be array of strings");for(let O of C)if(typeof O!="string")throw new Error(`padding.encode: non-string input=${O}`);for(;C.length*H%8;)C.push(z);return C},decode(C){if(!Array.isArray(C)||C.length&&typeof C[0]!="string")throw new Error("padding.encode input should be array of strings");for(let _ of C)if(typeof _!="string")throw new Error(`padding.decode: non-string input=${_}`);let O=C.length;if(O*H%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;O>0&&C[O-1]===z;O--)if(!((O-1)*H%8))throw new Error("Invalid padding: string has too much padding");return C.slice(0,O)}}}function h(H){if(typeof H!="function")throw new Error("normalize fn should be function");return{encode:z=>z,decode:z=>H(z)}}function y(H,z,C){if(z<2)throw new Error(`convertRadix: wrong from=${z}, base cannot be less than 2`);if(C<2)throw new Error(`convertRadix: wrong to=${C}, base cannot be less than 2`);if(!Array.isArray(H))throw new Error("convertRadix: data should be array");if(!H.length)return[];let O=0;const _=[],R=Array.from(H);for(R.forEach(U=>{if(n(U),U<0||U>=z)throw new Error(`Wrong integer: ${U}`)});;){let U=0,Y=!0;for(let J=O;J<R.length;J++){const T=R[J],D=z*U+T;if(!Number.isSafeInteger(D)||z*U/z!==U||D-T!==z*U)throw new Error("convertRadix: carry overflow");if(U=D%C,R[J]=Math.floor(D/C),!Number.isSafeInteger(R[J])||R[J]*C+U!==D)throw new Error("convertRadix: carry overflow");if(Y)R[J]?Y=!1:O=J;else continue}if(_.push(U),Y)break}for(let U=0;U<H.length-1&&H[U]===0;U++)_.push(0);return _.reverse()}const g=(H,z)=>z?g(z,H%z):H,m=(H,z)=>H+(z-g(H,z));function b(H,z,C,O){if(!Array.isArray(H))throw new Error("convertRadix2: data should be array");if(z<=0||z>32)throw new Error(`convertRadix2: wrong from=${z}`);if(C<=0||C>32)throw new Error(`convertRadix2: wrong to=${C}`);if(m(z,C)>32)throw new Error(`convertRadix2: carry overflow from=${z} to=${C} carryBits=${m(z,C)}`);let _=0,R=0;const U=2**C-1,Y=[];for(const J of H){if(n(J),J>=2**z)throw new Error(`convertRadix2: invalid data word=${J} from=${z}`);if(_=_<<z|J,R+z>32)throw new Error(`convertRadix2: carry overflow pos=${R} from=${z}`);for(R+=z;R>=C;R-=C)Y.push((_>>R-C&U)>>>0);_&=2**R-1}if(_=_<<C-R&U,!O&&R>=z)throw new Error("Excess padding");if(!O&&_)throw new Error(`Non-zero padding: ${_}`);return O&&R>0&&Y.push(_>>>0),Y}function v(H){return n(H),{encode:z=>{if(!(z instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return y(Array.from(z),2**8,H)},decode:z=>{if(!Array.isArray(z)||z.length&&typeof z[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(y(z,H,2**8))}}}function w(H,z=!1){if(n(H),H<=0||H>32)throw new Error("radix2: bits should be in (0..32]");if(m(8,H)>32||m(H,8)>32)throw new Error("radix2: carry overflow");return{encode:C=>{if(!(C instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return b(Array.from(C),8,H,!z)},decode:C=>{if(!Array.isArray(C)||C.length&&typeof C[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(b(C,H,8,z))}}}function S(H){if(typeof H!="function")throw new Error("unsafeWrapper fn should be function");return function(...z){try{return H.apply(null,z)}catch{}}}function A(H,z){if(n(H),typeof z!="function")throw new Error("checksum fn should be function");return{encode(C){if(!(C instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const O=z(C).slice(0,H),_=new Uint8Array(C.length+H);return _.set(C),_.set(O,C.length),_},decode(C){if(!(C instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const O=C.slice(0,-H),_=z(O).slice(0,H),R=C.slice(-H);for(let U=0;U<H;U++)if(_[U]!==R[U])throw new Error("Invalid checksum");return O}}}t.utils={alphabet:a,chain:s,checksum:A,radix:v,radix2:w,join:l,padding:c},t.base16=s(w(4),a("0123456789ABCDEF"),l("")),t.base32=s(w(5),a("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),c(5),l("")),t.base32hex=s(w(5),a("0123456789ABCDEFGHIJKLMNOPQRSTUV"),c(5),l("")),t.base32crockford=s(w(5),a("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),l(""),h(H=>H.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),t.base64=s(w(6),a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),c(6),l("")),t.base64url=s(w(6),a("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),c(6),l(""));const B=H=>s(v(58),a(H),l(""));t.base58=B("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),t.base58flickr=B("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),t.base58xrp=B("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const N=[0,2,3,5,6,7,9,10,11];t.base58xmr={encode(H){let z="";for(let C=0;C<H.length;C+=8){const O=H.subarray(C,C+8);z+=t.base58.encode(O).padStart(N[O.length],"1")}return z},decode(H){let z=[];for(let C=0;C<H.length;C+=11){const O=H.slice(C,C+11),_=N.indexOf(O.length),R=t.base58.decode(O);for(let U=0;U<R.length-_;U++)if(R[U]!==0)throw new Error("base58xmr: wrong padding");z=z.concat(Array.from(R.slice(R.length-_)))}return Uint8Array.from(z)}};const L=H=>s(A(4,z=>H(H(z))),t.base58);t.base58check=L;const G=s(a("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),l("")),V=[996825010,642813549,513874426,1027748829,705979059];function ie(H){const z=H>>25;let C=(H&33554431)<<5;for(let O=0;O<V.length;O++)(z>>O&1)===1&&(C^=V[O]);return C}function k(H,z,C=1){const O=H.length;let _=1;for(let R=0;R<O;R++){const U=H.charCodeAt(R);if(U<33||U>126)throw new Error(`Invalid prefix (${H})`);_=ie(_)^U>>5}_=ie(_);for(let R=0;R<O;R++)_=ie(_)^H.charCodeAt(R)&31;for(let R of z)_=ie(_)^R;for(let R=0;R<6;R++)_=ie(_);return _^=C,G.encode(b([_%2**30],30,5,!1))}function $(H){const z=H==="bech32"?1:734539939,C=w(5),O=C.decode,_=C.encode,R=S(O);function U(D,Q,re=90){if(typeof D!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof D}`);if(!Array.isArray(Q)||Q.length&&typeof Q[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof Q}`);const oe=D.length+7+Q.length;if(re!==!1&&oe>re)throw new TypeError(`Length ${oe} exceeds limit ${re}`);return D=D.toLowerCase(),`${D}1${G.encode(Q)}${k(D,Q,z)}`}function Y(D,Q=90){if(typeof D!="string")throw new Error(`bech32.decode input should be string, not ${typeof D}`);if(D.length<8||Q!==!1&&D.length>Q)throw new TypeError(`Wrong string length: ${D.length} (${D}). Expected (8..${Q})`);const re=D.toLowerCase();if(D!==re&&D!==D.toUpperCase())throw new Error("String must be lowercase or uppercase");D=re;const oe=D.lastIndexOf("1");if(oe===0||oe===-1)throw new Error('Letter "1" must be present between prefix and data only');const le=D.slice(0,oe),ue=D.slice(oe+1);if(ue.length<6)throw new Error("Data must be at least 6 characters long");const me=G.decode(ue).slice(0,-6),be=k(le,me,z);if(!ue.endsWith(be))throw new Error(`Invalid checksum in ${D}: expected "${be}"`);return{prefix:le,words:me}}const J=S(Y);function T(D){const{prefix:Q,words:re}=Y(D,!1);return{prefix:Q,words:re,bytes:O(re)}}return{encode:U,decode:Y,decodeToBytes:T,decodeUnsafe:J,fromWords:O,fromWordsUnsafe:R,toWords:_}}t.bech32=$("bech32"),t.bech32m=$("bech32m"),t.utf8={encode:H=>new TextDecoder().decode(H),decode:H=>new TextEncoder().encode(H)},t.hex=s(w(4),a("0123456789abcdef"),l(""),h(H=>{if(typeof H!="string"||H.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof H} with length ${H.length}`);return H.toLowerCase()}));const j={utf8:t.utf8,hex:t.hex,base16:t.base16,base32:t.base32,base64:t.base64,base64url:t.base64url,base58:t.base58,base58xmr:t.base58xmr},I=`Invalid encoding type. Available types: ${Object.keys(j).join(", ")}`,X=(H,z)=>{if(typeof H!="string"||!j.hasOwnProperty(H))throw new TypeError(I);if(!(z instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return j[H].encode(z)};t.bytesToString=X,t.str=t.bytesToString;const te=(H,z)=>{if(!j.hasOwnProperty(H))throw new TypeError(I);if(typeof z!="string")throw new TypeError("stringToBytes() expects string");return j[H].decode(z)};t.stringToBytes=te,t.bytes=t.stringToBytes})(lib)),lib}var bolt11,hasRequiredBolt11;function requireBolt11(){if(hasRequiredBolt11)return bolt11;hasRequiredBolt11=1;const{bech32:t,hex:n,utf8:s}=requireLib(),a={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},l={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},c={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},h={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},y={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},g=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],m={m:BigInt(1e3),u:BigInt(1e6),n:BigInt(1e9),p:BigInt(1e12)},b=BigInt("2100000000000000000"),v=BigInt(1e11),w={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},S={};for(let k=0,$=Object.keys(w);k<$.length;k++){const j=$[k],I=w[$[k]].toString();S[I]=j}const A={1:k=>n.encode(t.fromWordsUnsafe(k)),16:k=>n.encode(t.fromWordsUnsafe(k)),13:k=>s.encode(t.fromWordsUnsafe(k)),19:k=>n.encode(t.fromWordsUnsafe(k)),23:k=>n.encode(t.fromWordsUnsafe(k)),27:k=>n.encode(t.fromWordsUnsafe(k)),6:N,24:N,3:L,5:G};function B(k){return $=>({tagCode:parseInt(k),words:t.encode("unknown",$,Number.MAX_SAFE_INTEGER)})}function N(k){return k.reverse().reduce(($,j,I)=>$+j*Math.pow(32,I),0)}function L(k){const $=[];let j,I,X,te,H,z=t.fromWordsUnsafe(k);for(;z.length>0;)j=n.encode(z.slice(0,33)),I=n.encode(z.slice(33,41)),X=parseInt(n.encode(z.slice(41,45)),16),te=parseInt(n.encode(z.slice(45,49)),16),H=parseInt(n.encode(z.slice(49,51)),16),z=z.slice(51),$.push({pubkey:j,short_channel_id:I,fee_base_msat:X,fee_proportional_millionths:te,cltv_expiry_delta:H});return $}function G(k){const $=k.slice().reverse().map(X=>[!!(X&1),!!(X&2),!!(X&4),!!(X&8),!!(X&16)]).reduce((X,te)=>X.concat(te),[]);for(;$.length<g.length*2;)$.push(!1);const j={};g.forEach((X,te)=>{let H;$[te*2]?H="required":$[te*2+1]?H="supported":H="unsupported",j[X]=H});const I=$.slice(g.length*2);return j.extra_bits={start_bit:g.length*2,bits:I,has_required:I.reduce((X,te,H)=>H%2!==0?X||!1:X||te,!1)},j}function V(k,$){let j,I;if(k.slice(-1).match(/^[munp]$/))j=k.slice(-1),I=k.slice(0,-1);else{if(k.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");I=k}if(!I.match(/^\d+$/))throw new Error("Not a valid human readable amount");const X=BigInt(I),te=j?X*v/m[j]:X*v;if(j==="p"&&X%BigInt(10)!==BigInt(0)||te>b)throw new Error("Amount is outside of valid range");return $?te.toString():te}function ie(k,$){if(typeof k!="string")throw new Error("Lightning Payment Request must be string");if(k.slice(0,2).toLowerCase()!=="ln")throw new Error("Not a proper lightning payment request");const j=[],I=t.decode(k,Number.MAX_SAFE_INTEGER);k=k.toLowerCase();const X=I.prefix;let te=I.words,H=k.slice(X.length+1),z=te.slice(-104);te=te.slice(0,-104);let C=X.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(C&&!C[2]&&(C=X.match(/^ln(\S+)$/)),!C)throw new Error("Not a proper lightning payment request");j.push({name:"lightning_network",letters:"ln"});const O=C[1];let _;if($){if($.bech32===void 0||$.pubKeyHash===void 0||$.scriptHash===void 0||!Array.isArray($.validWitnessVersions))throw new Error("Invalid network");_=$}else switch(O){case a.bech32:_=a;break;case l.bech32:_=l;break;case c.bech32:_=c;break;case h.bech32:_=h;break;case y.bech32:_=y;break}if(!_||_.bech32!==O)throw new Error("Unknown coin bech32 prefix");j.push({name:"coin_network",letters:O,value:_});const R=C[2];let U;if(R){const le=C[3];U=V(R+le,!0),j.push({name:"amount",letters:C[2]+C[3],value:U})}else U=null;j.push({name:"separator",letters:"1"});const Y=N(te.slice(0,7));te=te.slice(7),j.push({name:"timestamp",letters:H.slice(0,7),value:Y}),H=H.slice(7);let J,T,D,Q;for(;te.length>0;){const le=te[0].toString();J=S[le]||"unknown_tag",T=A[le]||B(le),te=te.slice(1),D=N(te.slice(0,2)),te=te.slice(2),Q=te.slice(0,D),te=te.slice(D),j.push({name:J,tag:H[0],letters:H.slice(0,3+D),value:T(Q)}),H=H.slice(3+D)}j.push({name:"signature",letters:H.slice(0,104),value:n.encode(t.fromWordsUnsafe(z))}),H=H.slice(104),j.push({name:"checksum",letters:H});let re={paymentRequest:k,sections:j,get expiry(){let le=j.find(ue=>ue.name==="expiry");if(le)return oe("timestamp")+le.value},get route_hints(){return j.filter(le=>le.name==="route_hint").map(le=>le.value)}};for(let le in w)le!=="route_hint"&&Object.defineProperty(re,le,{get(){return oe(le)}});return re;function oe(le){let ue=j.find(me=>me.name===le);return ue?ue.value:void 0}}return bolt11={decode:ie,hrpToMillisat:V},bolt11}requireBolt11();var NDKKind=(t=>(t[t.Metadata=0]="Metadata",t[t.Text=1]="Text",t[t.RecommendRelay=2]="RecommendRelay",t[t.Contacts=3]="Contacts",t[t.EncryptedDirectMessage=4]="EncryptedDirectMessage",t[t.EventDeletion=5]="EventDeletion",t[t.Repost=6]="Repost",t[t.Reaction=7]="Reaction",t[t.BadgeAward=8]="BadgeAward",t[t.GroupChat=9]="GroupChat",t[t.Thread=11]="Thread",t[t.GroupReply=12]="GroupReply",t[t.GiftWrapSeal=13]="GiftWrapSeal",t[t.PrivateDirectMessage=14]="PrivateDirectMessage",t[t.Image=20]="Image",t[t.Video=21]="Video",t[t.ShortVideo=22]="ShortVideo",t[t.Story=23]="Story",t[t.Vanish=62]="Vanish",t[t.CashuWalletBackup=375]="CashuWalletBackup",t[t.GiftWrap=1059]="GiftWrap",t[t.GenericRepost=16]="GenericRepost",t[t.ChannelCreation=40]="ChannelCreation",t[t.ChannelMetadata=41]="ChannelMetadata",t[t.ChannelMessage=42]="ChannelMessage",t[t.ChannelHideMessage=43]="ChannelHideMessage",t[t.ChannelMuteUser=44]="ChannelMuteUser",t[t.WikiMergeRequest=818]="WikiMergeRequest",t[t.GenericReply=1111]="GenericReply",t[t.Media=1063]="Media",t[t.DraftCheckpoint=1234]="DraftCheckpoint",t[t.Task=1934]="Task",t[t.Report=1984]="Report",t[t.Label=1985]="Label",t[t.DVMReqTextExtraction=5e3]="DVMReqTextExtraction",t[t.DVMReqTextSummarization=5001]="DVMReqTextSummarization",t[t.DVMReqTextTranslation=5002]="DVMReqTextTranslation",t[t.DVMReqTextGeneration=5050]="DVMReqTextGeneration",t[t.DVMReqImageGeneration=5100]="DVMReqImageGeneration",t[t.DVMReqTextToSpeech=5250]="DVMReqTextToSpeech",t[t.DVMReqDiscoveryNostrContent=5300]="DVMReqDiscoveryNostrContent",t[t.DVMReqDiscoveryNostrPeople=5301]="DVMReqDiscoveryNostrPeople",t[t.DVMReqTimestamping=5900]="DVMReqTimestamping",t[t.DVMEventSchedule=5905]="DVMEventSchedule",t[t.DVMJobFeedback=7e3]="DVMJobFeedback",t[t.Subscribe=7001]="Subscribe",t[t.Unsubscribe=7002]="Unsubscribe",t[t.SubscriptionReceipt=7003]="SubscriptionReceipt",t[t.CashuReserve=7373]="CashuReserve",t[t.CashuQuote=7374]="CashuQuote",t[t.CashuToken=7375]="CashuToken",t[t.CashuWalletTx=7376]="CashuWalletTx",t[t.GroupAdminAddUser=9e3]="GroupAdminAddUser",t[t.GroupAdminRemoveUser=9001]="GroupAdminRemoveUser",t[t.GroupAdminEditMetadata=9002]="GroupAdminEditMetadata",t[t.GroupAdminEditStatus=9006]="GroupAdminEditStatus",t[t.GroupAdminCreateGroup=9007]="GroupAdminCreateGroup",t[t.GroupAdminRequestJoin=9021]="GroupAdminRequestJoin",t[t.MuteList=1e4]="MuteList",t[t.PinList=10001]="PinList",t[t.RelayList=10002]="RelayList",t[t.BookmarkList=10003]="BookmarkList",t[t.CommunityList=10004]="CommunityList",t[t.PublicChatList=10005]="PublicChatList",t[t.BlockRelayList=10006]="BlockRelayList",t[t.SearchRelayList=10007]="SearchRelayList",t[t.SimpleGroupList=10009]="SimpleGroupList",t[t.InterestList=10015]="InterestList",t[t.CashuMintList=10019]="CashuMintList",t[t.EmojiList=10030]="EmojiList",t[t.DirectMessageReceiveRelayList=10050]="DirectMessageReceiveRelayList",t[t.BlossomList=10063]="BlossomList",t[t.NostrWaletConnectInfo=13194]="NostrWaletConnectInfo",t[t.TierList=17e3]="TierList",t[t.CashuWallet=17375]="CashuWallet",t[t.FollowSet=3e4]="FollowSet",t[t.CategorizedPeopleList=3e4]="CategorizedPeopleList",t[t.CategorizedBookmarkList=30001]="CategorizedBookmarkList",t[t.RelaySet=30002]="RelaySet",t[t.CategorizedRelayList=30002]="CategorizedRelayList",t[t.BookmarkSet=30003]="BookmarkSet",t[t.CurationSet=30004]="CurationSet",t[t.ArticleCurationSet=30004]="ArticleCurationSet",t[t.VideoCurationSet=30005]="VideoCurationSet",t[t.ImageCurationSet=30006]="ImageCurationSet",t[t.InterestSet=30015]="InterestSet",t[t.InterestsList=30015]="InterestsList",t[t.ProjectTemplate=30717]="ProjectTemplate",t[t.EmojiSet=30030]="EmojiSet",t[t.ModularArticle=30040]="ModularArticle",t[t.ModularArticleItem=30041]="ModularArticleItem",t[t.Wiki=30818]="Wiki",t[t.Draft=31234]="Draft",t[t.Project=31933]="Project",t[t.SubscriptionTier=37001]="SubscriptionTier",t[t.EcashMintRecommendation=38e3]="EcashMintRecommendation",t[t.HighlightSet=39802]="HighlightSet",t[t.CategorizedHighlightList=39802]="CategorizedHighlightList",t[t.Nutzap=9321]="Nutzap",t[t.ZapRequest=9734]="ZapRequest",t[t.Zap=9735]="Zap",t[t.Highlight=9802]="Highlight",t[t.ClientAuth=22242]="ClientAuth",t[t.NostrWalletConnectReq=23194]="NostrWalletConnectReq",t[t.NostrWalletConnectRes=23195]="NostrWalletConnectRes",t[t.NostrConnect=24133]="NostrConnect",t[t.BlossomUpload=24242]="BlossomUpload",t[t.HttpAuth=27235]="HttpAuth",t[t.ProfileBadge=30008]="ProfileBadge",t[t.BadgeDefinition=30009]="BadgeDefinition",t[t.MarketStall=30017]="MarketStall",t[t.MarketProduct=30018]="MarketProduct",t[t.Article=30023]="Article",t[t.AppSpecificData=30078]="AppSpecificData",t[t.Classified=30402]="Classified",t[t.HorizontalVideo=34235]="HorizontalVideo",t[t.VerticalVideo=34236]="VerticalVideo",t[t.LegacyCashuWallet=37375]="LegacyCashuWallet",t[t.GroupMetadata=39e3]="GroupMetadata",t[t.GroupAdmins=39001]="GroupAdmins",t[t.GroupMembers=39002]="GroupMembers",t[t.FollowPack=39089]="FollowPack",t[t.MediaFollowPack=39092]="MediaFollowPack",t[t.AppRecommendation=31989]="AppRecommendation",t[t.AppHandler=31990]="AppHandler",t))(NDKKind||{});function getRelaysForSync(t,n,s="write"){if(!t.outboxTracker)return;const a=t.outboxTracker.data.get(n);if(a)return s==="write"?a.writeRelays:a.readRelays}async function getWriteRelaysFor(t,n,s="write"){if(t.outboxTracker)return t.outboxTracker.data.has(n)||await t.outboxTracker.trackUsers([n]),getRelaysForSync(t,n,s)}function getTopRelaysForAuthors(t,n){const s=new Map;return n.forEach(l=>{const c=getRelaysForSync(t,l);c&&c.forEach(h=>{const y=s.get(h)||0;s.set(h,y+1)})}),Array.from(s.entries()).sort((l,c)=>c[1]-l[1]).map(l=>l[0])}function getAllRelaysForAllPubkeys(t,n,s="read"){const a=new Map,l=new Set;return n.forEach(c=>{const h=getRelaysForSync(t,c,s);h&&h.size>0?(h.forEach(y=>{(a.get(y)||new Set).add(c)}),a.set(c,h)):l.add(c)}),{pubkeysToRelays:a,authorsMissingRelays:l}}function chooseRelayCombinationForPubkeys(t,n,s,{count:a,preferredRelays:l}={}){a??=2,l??=new Set;const c=t.pool,h=c.connectedRelays();h.forEach(w=>{l?.add(w.url)});const y=new Map,{pubkeysToRelays:g,authorsMissingRelays:m}=getAllRelaysForAllPubkeys(t,n,s),b=getTopRelaysForAuthors(t,n),v=(w,S)=>{const A=y.get(S)||[];A.push(w),y.set(S,A)};for(const[w,S]of g.entries()){let A=a;for(const B of h)S.has(B.url)&&(v(w,B.url),A--);for(const B of S)y.has(B)&&(v(w,B),A--);if(!(A<=0))for(const B of b){if(A<=0)break;S.has(B)&&(v(w,B),A--)}}for(const w of m)c.permanentAndConnectedRelays().forEach(S=>{const A=y.get(S.url)||[];A.push(w),y.set(S.url,A)});return y}function getRelaysForFilterWithAuthors(t,n,s=2){return chooseRelayCombinationForPubkeys(t,n,"write",{count:s})}function tryNormalizeRelayUrl(t){try{return normalizeRelayUrl(t)}catch{return}}function normalizeRelayUrl(t){let n=normalizeUrl(t,{stripAuthentication:!1,stripWWW:!1,stripHash:!0});return n.endsWith("/")||(n+="/"),n}function normalize(t){const n=new Set;for(const s of t)try{n.add(normalizeRelayUrl(s))}catch{}return Array.from(n)}var DATA_URL_DEFAULT_MIME_TYPE="text/plain",DATA_URL_DEFAULT_CHARSET="us-ascii",testParameter=(t,n)=>n.some(s=>s instanceof RegExp?s.test(t):s===t),supportedProtocols=new Set(["https:","http:","file:"]),hasCustomProtocol=t=>{try{const{protocol:n}=new URL(t);return n.endsWith(":")&&!n.includes(".")&&!supportedProtocols.has(n)}catch{return!1}},normalizeDataURL=(t,{stripHash:n})=>{const s=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!s)throw new Error(`Invalid URL: ${t}`);const a=s.groups?.type??"",l=s.groups?.data??"";let c=s.groups?.hash??"";const h=a.split(";");c=n?"":c;let y=!1;h[h.length-1]==="base64"&&(h.pop(),y=!0);const g=h.shift()?.toLowerCase()??"",b=[...h.map(v=>{let[w,S=""]=v.split("=").map(A=>A.trim());return w==="charset"&&(S=S.toLowerCase(),S===DATA_URL_DEFAULT_CHARSET)?"":`${w}${S?`=${S}`:""}`}).filter(Boolean)];return y&&b.push("base64"),(b.length>0||g&&g!==DATA_URL_DEFAULT_MIME_TYPE)&&b.unshift(g),`data:${b.join(";")},${y?l.trim():l}${c?`#${c}`:""}`};function normalizeUrl(t,n={}){if(n={defaultProtocol:"http",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,removeExplicitPort:!1,sortQueryParameters:!0,...n},typeof n.defaultProtocol=="string"&&!n.defaultProtocol.endsWith(":")&&(n.defaultProtocol=`${n.defaultProtocol}:`),t=t.trim(),/^data:/i.test(t))return normalizeDataURL(t,n);if(hasCustomProtocol(t))return t;const s=t.startsWith("//");!s&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,n.defaultProtocol));const l=new URL(t);if(l.hostname=l.hostname.toLowerCase(),n.forceHttp&&n.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(n.forceHttp&&l.protocol==="https:"&&(l.protocol="http:"),n.forceHttps&&l.protocol==="http:"&&(l.protocol="https:"),n.stripAuthentication&&(l.username="",l.password=""),n.stripHash?l.hash="":n.stripTextFragment&&(l.hash=l.hash.replace(/#?:~:text.*?$/i,"")),l.pathname){const h=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g;let y=0,g="";for(;;){const b=h.exec(l.pathname);if(!b)break;const v=b[0],w=b.index,S=l.pathname.slice(y,w);g+=S.replace(/\/{2,}/g,"/"),g+=v,y=w+v.length}const m=l.pathname.slice(y,l.pathname.length);g+=m.replace(/\/{2,}/g,"/"),l.pathname=g}if(l.pathname)try{l.pathname=decodeURI(l.pathname)}catch{}if(n.removeDirectoryIndex===!0&&(n.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(n.removeDirectoryIndex)&&n.removeDirectoryIndex.length>0){let h=l.pathname.split("/");const y=h[h.length-1];testParameter(y,n.removeDirectoryIndex)&&(h=h.slice(0,-1),l.pathname=`${h.slice(1).join("/")}/`)}if(l.hostname&&(l.hostname=l.hostname.replace(/\.$/,""),n.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(l.hostname)&&(l.hostname=l.hostname.replace(/^www\./,""))),Array.isArray(n.removeQueryParameters))for(const h of[...l.searchParams.keys()])testParameter(h,n.removeQueryParameters)&&l.searchParams.delete(h);if(!Array.isArray(n.keepQueryParameters)&&n.removeQueryParameters===!0&&(l.search=""),Array.isArray(n.keepQueryParameters)&&n.keepQueryParameters.length>0)for(const h of[...l.searchParams.keys()])testParameter(h,n.keepQueryParameters)||l.searchParams.delete(h);if(n.sortQueryParameters){l.searchParams.sort();try{l.search=decodeURIComponent(l.search)}catch{}}n.removeTrailingSlash&&(l.pathname=l.pathname.replace(/\/$/,"")),n.removeExplicitPort&&l.port&&(l.port="");const c=t;return t=l.toString(),!n.removeSingleSlash&&l.pathname==="/"&&!c.endsWith("/")&&l.hash===""&&(t=t.replace(/\/$/,"")),(n.removeTrailingSlash||l.pathname==="/")&&l.hash===""&&n.removeSingleSlash&&(t=t.replace(/\/$/,"")),s&&!n.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),n.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}var MAX_RECONNECT_ATTEMPTS=5,FLAPPING_THRESHOLD_MS=1e3,NDKRelayConnectivity=class{ndkRelay;ws;_status;timeoutMs;connectedAt;_connectionStats={attempts:0,success:0,durations:[]};debug;netDebug;connectTimeout;reconnectTimeout;ndk;openSubs=new Map;openCountRequests=new Map;openEventPublishes=new Map;serial=0;baseEoseTimeout=4400;constructor(t,n){this.ndkRelay=t,this._status=1;const s=Math.floor(Math.random()*1e3);this.debug=this.ndkRelay.debug.extend(`connectivity${s}`),this.ndk=n}async connect(t,n=!0){if(this.ws&&this.ws.readyState!==WebSocket.OPEN&&this.ws.readyState!==WebSocket.CONNECTING){this.debug("Cleaning up stale WebSocket connection");try{this.ws.close()}catch{}this.ws=void 0,this._status=1}if(this._status!==2&&this._status!==1||this.reconnectTimeout){this.debug("Relay requested to be connected but was in state %s or it had a reconnect timeout",this._status);return}this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),t??=this.timeoutMs,!this.timeoutMs&&t&&(this.timeoutMs=t),this.timeoutMs&&(this.connectTimeout=setTimeout(()=>this.onConnectionError(n),this.timeoutMs));try{this.updateConnectionStats.attempt(),this._status===1?this._status=4:this._status=2,this.ws=new WebSocket(this.ndkRelay.url),this.ws.onopen=this.onConnect.bind(this),this.ws.onclose=this.onDisconnect.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onerror=this.onError.bind(this)}catch(s){throw this.debug(`Failed to connect to ${this.ndkRelay.url}`,s),this._status=1,n?this.handleReconnection():this.ndkRelay.emit("delayed-connect",2880*60*1e3),s}}disconnect(){this._status=0;try{this.ws?.close()}catch(t){this.debug("Failed to disconnect",t),this._status=1}}onConnectionError(t){this.debug(`Error connecting to ${this.ndkRelay.url}`,this.timeoutMs),t&&!this.reconnectTimeout&&this.handleReconnection()}onConnect(){this.netDebug?.("connected",this.ndkRelay),this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),this.updateConnectionStats.connected(),this._status=5,this.ndkRelay.emit("connect"),this.ndkRelay.emit("ready")}onDisconnect(){this.netDebug?.("disconnected",this.ndkRelay),this.updateConnectionStats.disconnected(),this._status===5&&this.handleReconnection(),this._status=1,this.ndkRelay.emit("disconnect")}onMessage(t){this.netDebug?.(t.data,this.ndkRelay,"recv");try{const n=JSON.parse(t.data),[s,a,...l]=n;switch(s){case"EVENT":{const c=this.openSubs.get(a),h=n[2];if(!c){this.debug(`Received event for unknown subscription ${a}`);return}c.onevent(h);return}case"COUNT":{const c=n[2],h=this.openCountRequests.get(a);h&&(h.resolve(c.count),this.openCountRequests.delete(a));return}case"EOSE":{const c=this.openSubs.get(a);if(!c)return;c.oneose(a);return}case"OK":{const c=n[2],h=n[3],y=this.openEventPublishes.get(a),g=y?.pop();if(!y||!g){this.debug("Received OK for unknown event publish",a);return}c?g.resolve(h):g.reject(new Error(h)),y.length===0?this.openEventPublishes.delete(a):this.openEventPublishes.set(a,y);return}case"CLOSED":{const c=this.openSubs.get(a);if(!c)return;c.onclosed(n[2]);return}case"NOTICE":this.onNotice(n[1]);return;case"AUTH":{this.onAuthRequested(n[1]);return}}}catch(n){this.debug(`Error parsing message from ${this.ndkRelay.url}: ${n.message}`,n?.stack);return}}async onAuthRequested(t){const n=this.ndkRelay.authPolicy??this.ndk?.relayAuthDefaultPolicy;if(this.debug("Relay requested authentication",{havePolicy:!!n}),this._status===7){this.debug("Already authenticating, ignoring");return}if(this._status=6,n){if(this._status>=5){this._status=7;let s;try{s=await n(this.ndkRelay,t)}catch(a){this.debug("Authentication policy threw an error",a),s=!1}if(this.debug("Authentication policy returned",!!s),s instanceof NDKEvent||s===!0){s instanceof NDKEvent&&await this.auth(s);const a=async()=>{if(this._status>=5&&this._status<8){const l=new NDKEvent(this.ndk);l.kind=22242,l.tags=[["relay",this.ndkRelay.url],["challenge",t]],await l.sign(),this.auth(l).then(()=>{this._status=8,this.ndkRelay.emit("authed"),this.debug("Authentication successful")}).catch(c=>{this._status=6,this.ndkRelay.emit("auth:failed",c),this.debug("Authentication failed",c)})}else this.debug("Authentication failed, it changed status, status is %d",this._status)};s===!0&&(this.ndk?.signer?a().catch(l=>{console.error("Error authenticating",l)}):(this.debug("No signer available for authentication localhost"),this.ndk?.once("signer:ready",a))),this._status=5,this.ndkRelay.emit("authed")}}}else this.ndkRelay.emit("auth",t)}onError(t){this.debug(`WebSocket error on ${this.ndkRelay.url}:`,t)}get status(){return this._status}isAvailable(){return this._status===5}isFlapping(){const t=this._connectionStats.durations;if(t.length%3!==0)return!1;const s=t.reduce((h,y)=>h+y,0)/t.length,a=t.map(h=>(h-s)**2).reduce((h,y)=>h+y,0)/t.length;return Math.sqrt(a)<FLAPPING_THRESHOLD_MS}async onNotice(t){this.ndkRelay.emit("notice",t)}handleReconnection(t=0){if(this.reconnectTimeout)return;if(this.isFlapping()){this.ndkRelay.emit("flapping",this._connectionStats),this._status=3;return}const n=this.connectedAt?Math.max(0,6e4-(Date.now()-this.connectedAt)):5e3*(this._connectionStats.attempts+1);this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=void 0,this._status=2,this.connect().catch(s=>{t<MAX_RECONNECT_ATTEMPTS?setTimeout(()=>{this.handleReconnection(t+1)},Math.pow(1e3*(t+1),2)):this.debug("Reconnect failed")})},n),this.ndkRelay.emit("delayed-connect",n),this.debug("Reconnecting in",n),this._connectionStats.nextReconnectAt=Date.now()+n}async send(t){this._status>=5&&this.ws?.readyState===WebSocket.OPEN?(this.ws?.send(t),this.netDebug?.(t,this.ndkRelay,"send")):(this.debug(`Not connected to ${this.ndkRelay.url} (%d), not sending message ${t}`,this._status),this._status>=5&&this.ws?.readyState!==WebSocket.OPEN&&(this.debug(`Stale connection detected, WebSocket state: ${this.ws?.readyState}`),this.onDisconnect()))}async auth(t){const n=new Promise((s,a)=>{const l=this.openEventPublishes.get(t.id)??[];l.push({resolve:s,reject:a}),this.openEventPublishes.set(t.id,l)});return this.send(`["AUTH",${JSON.stringify(t.rawEvent())}]`),n}async publish(t){const n=new Promise((s,a)=>{const l=this.openEventPublishes.get(t.id)??[];l.length>0&&console.warn(`Duplicate event publishing detected, you are publishing event ${t.id} twice`),l.push({resolve:s,reject:a}),this.openEventPublishes.set(t.id,l)});return this.send(`["EVENT",${JSON.stringify(t)}]`),n}async count(t,n){this.serial++;const s=n?.id||`count:${this.serial}`,a=new Promise((l,c)=>{this.openCountRequests.set(s,{resolve:l,reject:c})});return this.send(`["COUNT","${s}",${JSON.stringify(t).substring(1)}`),a}close(t,n){this.send(`["CLOSE","${t}"]`);const s=this.openSubs.get(t);this.openSubs.delete(t),s&&s.onclose(n)}req(t){`${this.send(`["REQ","${t.subId}",${JSON.stringify(t.executeFilters).substring(1)}`)}`,this.openSubs.set(t.subId,t)}updateConnectionStats={connected:()=>{this._connectionStats.success++,this._connectionStats.connectedAt=Date.now()},disconnected:()=>{this._connectionStats.connectedAt&&(this._connectionStats.durations.push(Date.now()-this._connectionStats.connectedAt),this._connectionStats.durations.length>100&&this._connectionStats.durations.shift()),this._connectionStats.connectedAt=void 0},attempt:()=>{this._connectionStats.attempts++,this._connectionStats.connectedAt=Date.now()}};get connectionStats(){return this._connectionStats}get url(){return this.ndkRelay.url}get connected(){return this._status>=5&&this.ws?.readyState===WebSocket.OPEN}},NDKRelayPublisher=class{ndkRelay;debug;constructor(t){this.ndkRelay=t,this.debug=t.debug.extend("publisher")}async publish(t,n=2500){let s;const a=()=>new Promise((b,v)=>{try{this.publishEvent(t).then(w=>{this.ndkRelay.emit("published",t),t.emit("relay:published",this.ndkRelay),b(!0)}).catch(v)}catch(w){v(w)}}),l=new Promise((b,v)=>{s=setTimeout(()=>{s=void 0,v(new Error(`Timeout: ${n}ms`))},n)}),c=()=>{a().then(b=>h(b)).catch(b=>y(b))};let h,y;const g=b=>{throw this.ndkRelay.debug("Publish failed",b,t.id),this.ndkRelay.emit("publish:failed",t,b),t.emit("relay:publish:failed",this.ndkRelay,b),b},m=()=>{s&&clearTimeout(s),this.ndkRelay.removeListener("connect",c)};return this.ndkRelay.status>=5?Promise.race([a(),l]).catch(g).finally(m):(this.ndkRelay.status<=1?(console.warn("Relay is disconnected, trying to connect to publish an event",this.ndkRelay.url),this.ndkRelay.connect()):console.warn("Relay not connected, waiting for connection to publish an event",this.ndkRelay.url),Promise.race([new Promise((b,v)=>{h=b,y=v,this.ndkRelay.on("connect",c)}),l]).catch(g).finally(m))}async publishEvent(t){return this.ndkRelay.connectivity.publish(t.rawEvent())}};function filterFingerprint(t,n){const s=[];for(const l of t){const c=Object.entries(l||{}).map(([h,y])=>["since","until"].includes(h)?`${h}:${y}`:h).sort().join("-");s.push(c)}let a=n?"+":"";return a+=s.join("|"),a}function mergeFilters(t){const n=[],s={};return t.filter(a=>!!a.limit).forEach(a=>n.push(a)),t=t.filter(a=>!a.limit),t.length===0?n:(t.forEach(a=>{Object.entries(a).forEach(([l,c])=>{Array.isArray(c)?s[l]===void 0?s[l]=[...c]:s[l]=Array.from(new Set([...s[l],...c])):s[l]=c})}),[...n,s])}var NDKRelaySubscription=class{fingerprint;items=new Map;topSubManager;debug;status=0;onClose;relay;eosed=!1;executionTimer;fireTime;delayType;executeFilters;id=Math.random().toString(36).substring(7);constructor(t,n,s){this.relay=t,this.topSubManager=s,this.debug=t.debug.extend(`sub[${this.id}]`),this.fingerprint=n||Math.random().toString(36).substring(7)}_subId;get subId(){return this._subId?this._subId:(this._subId=this.fingerprint.slice(0,15),this._subId)}subIdParts=new Set;addSubIdPart(t){this.subIdParts.add(t)}addItem(t,n){if(this.debug("Adding item",{filters:n,internalId:t.internalId,status:this.status,fingerprint:this.fingerprint,id:this.subId,items:this.items,itemsSize:this.items.size}),!this.items.has(t.internalId))switch(t.on("close",this.removeItem.bind(this,t)),this.items.set(t.internalId,{subscription:t,filters:n}),this.status!==3&&t.subId&&(!this._subId||this._subId.length<48)&&(this.status===0||this.status===1)&&this.addSubIdPart(t.subId),this.status){case 0:this.evaluateExecutionPlan(t);break;case 3:break;case 1:this.evaluateExecutionPlan(t);break;case 4:throw this.debug("Subscription is closed, cannot add new items %o (%o)",t,n),new Error("Cannot add new items to a closed subscription")}}removeItem(t){if(this.items.delete(t.internalId),this.items.size===0){if(!this.eosed)return;this.close(),this.cleanup()}}close(){if(this.status===4)return;const t=this.status;if(this.status=4,t===3)try{this.relay.close(this.subId)}catch(n){this.debug("Error closing subscription",n,this)}else this.debug("Subscription wanted to close but it wasn't running, this is probably ok",{subId:this.subId,prevStatus:t,sub:this});this.cleanup()}cleanup(){this.executionTimer&&clearTimeout(this.executionTimer),this.relay.off("ready",this.executeOnRelayReady),this.relay.off("authed",this.reExecuteAfterAuth),this.onClose&&this.onClose(this)}evaluateExecutionPlan(t){if(!t.isGroupable()){this.status=1,this.execute();return}if(t.filters.find(a=>!!a.limit)&&(this.executeFilters=this.compileFilters(),this.executeFilters.length>=10)){this.status=1,this.execute();return}const n=t.groupableDelay,s=t.groupableDelayType;if(!n)throw new Error("Cannot group a subscription without a delay");if(this.status===0)this.schedule(n,s);else{const a=this.delayType,l=this.fireTime-Date.now();if(a==="at-least"&&s==="at-least")l<n&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(n,s));else if(a==="at-least"&&s==="at-most")l>n&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(n,s));else if(a==="at-most"&&s==="at-most")l>n&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(n,s));else if(a==="at-most"&&s==="at-least")l>n&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(n,s));else throw new Error(`Unknown delay type combination ${a} ${s}`)}}schedule(t,n){this.status=1;const s=Date.now();this.fireTime=s+t,this.delayType=n;const a=setTimeout(this.execute.bind(this),t);n==="at-least"&&(this.executionTimer=a)}executeOnRelayReady=()=>{if(this.status===2){if(this.items.size===0){this.debug("No items to execute; this relay was probably too slow to respond and the caller gave up",{status:this.status,fingerprint:this.fingerprint,items:this.items,itemsSize:this.items.size,id:this.id,subId:this.subId}),this.cleanup();return}this.debug("Executing on relay ready",{status:this.status,fingerprint:this.fingerprint,items:this.items,itemsSize:this.items.size}),this.status=1,this.execute()}};finalizeSubId(){this.subIdParts.size>0?this._subId=Array.from(this.subIdParts).join("-"):this._subId=this.fingerprint.slice(0,15),this._subId+=`-${Math.random().toString(36).substring(2,7)}`}reExecuteAfterAuth=(()=>{const t=this.subId;this.debug("Re-executing after auth",this.items.size),this.eosed?this.relay.close(this.subId):this.debug("We are abandoning an opened subscription, once it EOSE's, the handler will close it",{oldSubId:t}),this._subId=void 0,this.status=1,this.execute(),this.debug("Re-executed after auth %s 👉 %s",t,this.subId)}).bind(this);execute(){if(this.status===1){if(!this.relay.connected){this.status=2,this.debug("Waiting for relay to be ready",{status:this.status,id:this.subId,fingerprint:this.fingerprint,items:this.items,itemsSize:this.items.size}),this.relay.once("ready",this.executeOnRelayReady);return}this.relay.status<8&&this.relay.once("authed",this.reExecuteAfterAuth),this.status=3,this.finalizeSubId(),this.executeFilters=this.compileFilters(),this.relay.req(this)}}onstart(){}onevent(t){this.topSubManager.dispatchEvent(t,this.relay)}oneose(t){if(this.eosed=!0,t!==this.subId){this.debug("Received EOSE for an abandoned subscription",t,this.subId),this.relay.close(t);return}this.items.size===0&&this.close();for(const{subscription:n}of this.items.values())n.eoseReceived(this.relay),n.closeOnEose&&(this.debug("Removing item because of EOSE",{filters:n.filters,internalId:n.internalId,status:this.status,fingerprint:this.fingerprint,items:this.items,itemsSize:this.items.size}),this.removeItem(n))}onclose(t){this.status=4}onclosed(t){if(t)for(const{subscription:n}of this.items.values())n.closedReceived(this.relay,t)}compileFilters(){const t=[],n=Array.from(this.items.values()).map(a=>a.filters);if(!n[0])return this.debug("👀 No filters to merge",this.items),console.error("BUG: No filters to merge!",this.items),[];const s=n[0].length;for(let a=0;a<s;a++){const l=n.map(c=>c[a]);t.push(...mergeFilters(l))}return t}},NDKRelaySubscriptionManager=class{relay;subscriptions;generalSubManager;constructor(t,n){this.relay=t,this.subscriptions=new Map,this.generalSubManager=n}addSubscription(t,n){let s;if(!t.isGroupable())s=this.createSubscription(t,n);else{const a=filterFingerprint(n,t.closeOnEose);a&&(s=(this.subscriptions.get(a)||[]).find(c=>c.status<3)),s??=this.createSubscription(t,n,a)}s.addItem(t,n)}createSubscription(t,n,s){const a=new NDKRelaySubscription(this.relay,s||null,this.generalSubManager);a.onClose=this.onRelaySubscriptionClose.bind(this);const l=this.subscriptions.get(a.fingerprint)??[];return this.subscriptions.set(a.fingerprint,[...l,a]),a}onRelaySubscriptionClose(t){let n=this.subscriptions.get(t.fingerprint)??[];n?n.length===1?this.subscriptions.delete(t.fingerprint):(n=n.filter(s=>s.id!==t.id),this.subscriptions.set(t.fingerprint,n)):console.warn("Unexpectedly did not find a subscription with fingerprint",t.fingerprint)}},NDKRelay=class Wf extends libExports.EventEmitter{url;scores;connectivity;subs;publisher;authPolicy;lowestValidationRatio;targetValidationRatio;validationRatioFn;validatedEventCount=0;nonValidatedEventCount=0;trusted=!1;complaining=!1;debug;static defaultValidationRatioUpdateFn=(n,s,a)=>{if(n.lowestValidationRatio===void 0||n.targetValidationRatio===void 0)return 1;let l=n.validationRatio;if(n.validationRatio>n.targetValidationRatio){const c=s/100;l=Math.max(n.lowestValidationRatio,n.validationRatio-c)}return l<n.validationRatio?l:n.validationRatio};constructor(n,s,a){super(),this.url=normalizeRelayUrl(n),this.scores=new Map,this.debug=createDebug5(`ndk:relay:${n}`),this.connectivity=new NDKRelayConnectivity(this,a),this.connectivity.netDebug=a?.netDebug,this.req=this.connectivity.req.bind(this.connectivity),this.close=this.connectivity.close.bind(this.connectivity),this.subs=new NDKRelaySubscriptionManager(this,a.subManager),this.publisher=new NDKRelayPublisher(this),this.authPolicy=s,this.targetValidationRatio=a?.initialValidationRatio,this.lowestValidationRatio=a?.lowestValidationRatio,this.validationRatioFn=(a?.validationRatioFn??Wf.defaultValidationRatioUpdateFn).bind(this),this.updateValidationRatio(),a||console.trace("relay created without ndk")}updateValidationRatio(){if(this.validationRatioFn&&this.validatedEventCount>0){const n=this.validationRatioFn(this,this.validatedEventCount,this.nonValidatedEventCount);this.targetValidationRatio=n}setTimeout(()=>{this.updateValidationRatio()},3e4)}get status(){return this.connectivity.status}get connectionStats(){return this.connectivity.connectionStats}async connect(n,s=!0){return this.connectivity.connect(n,s)}disconnect(){this.status!==1&&this.connectivity.disconnect()}subscribe(n,s){this.subs.addSubscription(n,s)}async publish(n,s=2500){return this.publisher.publish(n,s)}referenceTags(){return[["r",this.url]]}addValidatedEvent(){this.validatedEventCount++}addNonValidatedEvent(){this.nonValidatedEventCount++}get validationRatio(){return this.nonValidatedEventCount===0?1:this.validatedEventCount/(this.validatedEventCount+this.nonValidatedEventCount)}shouldValidateEvent(){return this.trusted?!1:this.targetValidationRatio===void 0||this.targetValidationRatio>=1?!0:Math.random()<this.targetValidationRatio}get connected(){return this.connectivity.connected}req;close},NDKPublishError=class extends Error{errors;publishedToRelays;intendedRelaySet;constructor(t,n,s,a){super(t),this.errors=n,this.publishedToRelays=s,this.intendedRelaySet=a}get relayErrors(){const t=[];for(const[n,s]of this.errors)t.push(`${n.url}: ${s}`);return t.join(`
`)}},NDKRelaySet=class Jf{relays;debug;ndk;pool;constructor(n,s,a){this.relays=n,this.ndk=s,this.pool=a??s.pool,this.debug=s.debug.extend("relayset")}addRelay(n){this.relays.add(n)}get relayUrls(){return Array.from(this.relays).map(n=>n.url)}static fromRelayUrls(n,s,a=!0,l){if(l=l??s.pool,!l)throw new Error("No pool provided");const c=new Set;for(const h of n){const y=l.relays.get(normalizeRelayUrl(h));if(y)y.status<5&&a&&y.connect(),c.add(y);else{const g=new NDKRelay(normalizeRelayUrl(h),s?.relayAuthDefaultPolicy,s);l.useTemporaryRelay(g,void 0,`requested from fromRelayUrls ${n}`),c.add(g)}}return new Jf(new Set(c),s,l)}async publish(n,s,a=1){const l=new Set,c=new Map,h=n.isEphemeral();n.publishStatus="pending";const y=g=>{l.add(g)};n.on("relay:published",y);try{const g=Array.from(this.relays).map(m=>new Promise(b=>{const v=s?setTimeout(()=>{l.has(m)||(c.set(m,new Error(`Publish timeout after ${s}ms`)),b(!1))},s):null;m.publish(n,s).then(w=>{v&&clearTimeout(v),w?(l.add(m),b(!0)):b(!1)}).catch(w=>{v&&clearTimeout(v),h||c.set(m,w),b(!1)})}));if(await Promise.all(g),l.size<a){if(!h){const m=new NDKPublishError("Not enough relays received the event ("+l.size+" published, "+a+" required)",c,l,this);throw n.publishStatus="error",n.publishError=m,this.ndk?.emit("event:publish-failed",n,m,this.relayUrls),m}}else n.publishStatus="success",n.emit("published",{relaySet:this,publishedToRelays:l});return l}finally{n.off("relay:published",y)}}get size(){return this.relays.size}},d=createDebug5("ndk:outbox:calculate");async function calculateRelaySetFromEvent(t,n,s){const a=new Set,l=await getWriteRelaysFor(t,n.pubkey);l&&l.forEach(y=>{const g=t.pool?.getRelay(y);g&&a.add(g)});let c=n.tags.filter(y=>["a","e"].includes(y[0])).map(y=>y[2]).filter(y=>y?.startsWith("wss://")).filter(y=>{try{return new URL(y),!0}catch{return!1}}).map(y=>normalizeRelayUrl(y));c=Array.from(new Set(c)).slice(0,5),c.forEach(y=>{const g=t.pool?.getRelay(y,!0,!0);g&&(d("Adding relay hint %s",y),a.add(g))});const h=n.getMatchingTags("p").map(y=>y[1]);return h.length<5?Array.from(chooseRelayCombinationForPubkeys(t,h,"read",{preferredRelays:new Set(l)}).keys()).forEach(g=>{const m=t.pool?.getRelay(g,!1,!0);m&&(d("Adding p-tagged relay %s",g),a.add(m))}):d("Too many p-tags to consider %d",h.length),t.pool?.permanentAndConnectedRelays().forEach(y=>a.add(y)),s&&a.size<s&&t.explicitRelayUrls?.filter(g=>!Array.from(a).some(m=>m.url===g)).slice(0,s-a.size)?.forEach(g=>{const m=t.pool?.getRelay(g,!1,!0);m&&(d("Adding explicit relay %s",g),a.add(m))}),new NDKRelaySet(a,t)}function calculateRelaySetsFromFilter(t,n,s){const a=new Map,l=new Set;if(n.forEach(c=>{c.authors&&c.authors.forEach(h=>l.add(h))}),l.size>0){const c=getRelaysForFilterWithAuthors(t,Array.from(l));for(const h of c.keys())a.set(h,[]);for(const h of n)if(h.authors)for(const[y,g]of c.entries()){const m=h.authors.filter(b=>g.includes(b));a.set(y,[...a.get(y),{...h,authors:m}])}else for(const y of c.keys())a.set(y,[...a.get(y),h])}else t.explicitRelayUrls&&t.explicitRelayUrls.forEach(c=>{a.set(c,n)});return a.size===0&&s.permanentAndConnectedRelays().slice(0,5).forEach(c=>{a.set(c.url,n)}),a}function calculateRelaySetsFromFilters(t,n,s){return calculateRelaySetsFromFilter(t,n,s)}function mergeTags(t,n){const s=new Map,a=h=>h.join(","),l=(h,y)=>h.every((g,m)=>g===y[m]),c=h=>{for(const[y,g]of s)if(l(g,h)||l(h,g)){h.length>=g.length&&s.set(y,h);return}s.set(a(h),h)};return t.concat(n).forEach(c),Array.from(s.values())}var hashtagRegex=new RegExp(`(?<=\\s|^)(#[^\\s!@#$%^&*()=+./,[{\\]};:'"?><]+)`,"g");function generateHashtags(t){const n=t.match(hashtagRegex),s=new Set,a=new Set;if(n)for(const l of n)s.has(l.slice(1))||(a.add(l.slice(1)),s.add(l.slice(1)));return Array.from(a)}async function generateContentTags(t,n=[]){const s=/(@|nostr:)(npub|nprofile|note|nevent|naddr)[a-zA-Z0-9]+/g,a=[],l=h=>{n.find(y=>["q",h[0]].includes(y[0])&&y[1]===h[1])||n.push(h)};t=t.replace(s,h=>{try{const y=h.split(/(@|nostr:)/)[2],{type:g,data:m}=nip19_exports.decode(y);let b;switch(g){case"npub":b=["p",m];break;case"nprofile":b=["p",m.pubkey];break;case"note":a.push(new Promise(async v=>{l(["q",m,await maybeGetEventRelayUrl(y)]),v()}));break;case"nevent":a.push(new Promise(async v=>{const{id:w,author:S}=m;let{relays:A}=m;(!A||A.length===0)&&(A=[await maybeGetEventRelayUrl(y)]),l(["q",w,A[0]]),S&&l(["p",S]),v()}));break;case"naddr":a.push(new Promise(async v=>{const w=[m.kind,m.pubkey,m.identifier].join(":");let S=m.relays??[];S.length===0&&(S=[await maybeGetEventRelayUrl(y)]),l(["q",w,S[0]]),l(["p",m.pubkey]),v()}));break;default:return h}return b&&l(b),`nostr:${y}`}catch{return h}}),await Promise.all(a);const c=generateHashtags(t).map(h=>["t",h]);return n=mergeTags(n,c),{content:t,tags:n}}async function maybeGetEventRelayUrl(t){return""}async function encrypt(t,n,s="nip44"){let a;if(!this.ndk)throw new Error("No NDK instance found!");let l=n;if(l||(this.ndk.assertSigner(),l=this.ndk.signer),!l)throw new Error("no NDK signer");const c=t||(()=>{const h=this.getMatchingTags("p");if(h.length!==1)throw new Error("No recipient could be determined and no explicit recipient was provided");return this.ndk.getUser({pubkey:h[0][1]})})();if(s==="nip44"&&await isEncryptionEnabled(l,"nip44")&&(a=await l.encrypt(c,this.content,"nip44")),(!a||s==="nip04")&&await isEncryptionEnabled(l,"nip04")&&(a=await l.encrypt(c,this.content,"nip04")),!a)throw new Error("Failed to encrypt event.");this.content=a}async function decrypt(t,n,s){if(this.ndk?.cacheAdapter?.getDecryptedEvent){let y=null;if(typeof this.ndk.cacheAdapter.getDecryptedEvent=="function"&&(y=this.ndk.cacheAdapter.getDecryptedEvent(this.id)),y){this.content=y.content;return}}let a;if(!this.ndk)throw new Error("No NDK instance found!");let l=n;if(l||(this.ndk.assertSigner(),l=this.ndk.signer),!l)throw new Error("no NDK signer");const c=t||this.author;if(!c)throw new Error("No sender provided and no author available");const h=s||(this.content.match(/\\?iv=/)?"nip04":"nip44");if((h==="nip04"||this.kind===4)&&await isEncryptionEnabled(l,"nip04")&&this.content.search("\\?iv=")&&(a=await l.decrypt(c,this.content,"nip04")),!a&&h==="nip44"&&await isEncryptionEnabled(l,"nip44")&&(a=await l.decrypt(c,this.content,"nip44")),!a)throw new Error("Failed to decrypt event.");this.content=a,this.ndk?.cacheAdapter?.addDecryptedEvent&&this.ndk.cacheAdapter.addDecryptedEvent(this)}async function isEncryptionEnabled(t,n){return t.encryptionEnabled?n?!!await t.encryptionEnabled(n):!0:!1}function eventHasETagMarkers(t){for(const n of t.tags)if(n[0]==="e"&&(n[3]??"").length>0)return!0;return!1}function getRootTag(t,n){n??=t.tagType();const s=t.tags.find(isTagRootTag);if(!s){if(eventHasETagMarkers(t))return;const a=t.getMatchingTags(n);if(a.length<3)return a[0]}return s}var nip22RootTags=new Set(["A","E","I"]),nip22ReplyTags=new Set(["a","e","i"]);function getReplyTag(t,n){if(t.kind===1111){let l;for(const c of t.tags)if(nip22RootTags.has(c[0]))l=c;else if(nip22ReplyTags.has(c[0])){l=c;break}return l}n??=t.tagType();let s=!1,a;for(const l of t.tags)if(l[0]===n){if((l[3]??"").length>0&&(s=!0),s&&l[3]==="reply")return l;s&&l[3]==="root"&&(a=l),s||(a=l)}return a}function isTagRootTag(t){return t[0]==="E"||t[3]==="root"}async function fetchTaggedEvent(t,n){if(!this.ndk)throw new Error("NDK instance not found");const s=this.getMatchingTags(t,n);if(s.length===0)return;const[a,l,c]=s[0];let h=c!==""?this.ndk.pool.getRelay(c):void 0;return await this.ndk.fetchEvent(l,{},h)}async function fetchRootEvent(t){if(!this.ndk)throw new Error("NDK instance not found");const n=getRootTag(this);if(n)return this.ndk.fetchEventFromTag(n,this,t)}async function fetchReplyEvent(t){if(!this.ndk)throw new Error("NDK instance not found");const n=getReplyTag(this);if(n)return this.ndk.fetchEventFromTag(n,this,t)}function isReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return[0,3].includes(this.kind)||this.kind>=1e4&&this.kind<2e4||this.kind>=3e4&&this.kind<4e4}function isEphemeral(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=2e4&&this.kind<3e4}function isParamReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=3e4&&this.kind<4e4}var DEFAULT_RELAY_COUNT=2;function encode(t=DEFAULT_RELAY_COUNT){let n=[];return this.onRelays.length>0?n=this.onRelays.map(s=>s.url):this.relay&&(n=[this.relay.url]),n.length>t&&(n=n.slice(0,t)),this.isParamReplaceable()?nip19_exports.naddrEncode({kind:this.kind,pubkey:this.pubkey,identifier:this.replaceableDTag(),relays:n}):n.length>0?nip19_exports.neventEncode({id:this.tagId(),relays:n,author:this.pubkey}):nip19_exports.noteEncode(this.tagId())}async function repost(t=!0,n){if(!n&&t){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),n=this.ndk.signer}const s=new NDKEvent(this.ndk,{kind:getKind(this)});return this.isProtected||(s.content=JSON.stringify(this.rawEvent())),s.tag(this),this.kind!==1&&s.tags.push(["k",`${this.kind}`]),n&&await s.sign(n),t&&await s.publish(),s}function getKind(t){return t.kind===1?6:16}function serialize(t=!1,n=!1){const s=[0,this.pubkey,this.created_at,this.kind,this.tags,this.content];return t&&s.push(this.sig),n&&s.push(this.id),JSON.stringify(s)}function deserialize(t){const n=JSON.parse(t),s={pubkey:n[1],created_at:n[2],kind:n[3],tags:n[4],content:n[5]};if(n.length>=7){const a=n[6],l=n[7];a&&a.length===128?(s.sig=a,l&&l.length===64&&(s.id=l)):a&&a.length===64&&(s.id=a,l&&l.length===128&&(s.sig=l))}return s}var worker,processingQueue={};function signatureVerificationInit(t){worker=t,worker.onmessage=n=>{const[s,a]=n.data,l=processingQueue[s];if(!l){console.error("No record found for event",s);return}delete processingQueue[s];for(const c of l.resolves)c(a)}}async function verifySignatureAsync(t,n,s){const a=t.ndk,l=Date.now();let c;return a.signatureVerificationFunction?(console.log("[NDK-CORE] Using custom signature verification function async"),c=await a.signatureVerificationFunction(t),console.log("Custom signature verification result",t.id,{result:c})):(console.log("Using worker-based signature verification async"),c=await new Promise(h=>{const y=t.serialize();let g=!1;processingQueue[t.id]||(processingQueue[t.id]={event:t,resolves:[],relay:s},g=!0),processingQueue[t.id].resolves.push(h),g&&worker?.postMessage({serialized:y,id:t.id,sig:t.sig,pubkey:t.pubkey})})),a.signatureVerificationTimeMs+=Date.now()-l,c}var PUBKEY_REGEX=/^[a-f0-9]{64}$/;function validate(){if(typeof this.kind!="number"||typeof this.content!="string"||typeof this.created_at!="number"||typeof this.pubkey!="string"||!this.pubkey.match(PUBKEY_REGEX)||!Array.isArray(this.tags))return!1;for(let t=0;t<this.tags.length;t++){const n=this.tags[t];if(!Array.isArray(n))return!1;for(let s=0;s<n.length;s++)if(typeof n[s]=="object")return!1}return!0}var verifiedSignatures=new distExports.LRUCache({maxSize:1e3,entryExpirationTimeInMS:6e4});function verifySignature(t){if(typeof this.signatureVerified=="boolean")return this.signatureVerified;const n=verifiedSignatures.get(this.id);if(n!==null)return this.signatureVerified=!!n,this.signatureVerified;try{if(this.ndk?.asyncSigVerification)verifySignatureAsync(this,t,this.relay).then(s=>{t&&(this.signatureVerified=s,s&&verifiedSignatures.set(this.id,this.sig)),s||(this.relay?this.ndk?.reportInvalidSignature(this,this.relay):this.ndk?.reportInvalidSignature(this),verifiedSignatures.set(this.id,!1))}).catch(s=>{console.error("signature verification error",this.id,s)});else{const s=sha256(new TextEncoder().encode(this.serialize())),a=schnorr.verify(this.sig,s,this.pubkey);return a?verifiedSignatures.set(this.id,this.sig):verifiedSignatures.set(this.id,!1),this.signatureVerified=a,a}}catch{return this.signatureVerified=!1,!1}}function getEventHash(){return getEventHashFromSerializedEvent(this.serialize())}function getEventHashFromSerializedEvent(t){const n=sha256(new TextEncoder().encode(t));return bytesToHex(n)}var skipClientTagOnKinds=new Set([0,4,1059,13,3,9734,5]),NDKEvent=class Vn extends libExports.EventEmitter{ndk;created_at;content="";tags=[];kind;id="";sig;pubkey="";signatureVerified;_author=void 0;relay;get onRelays(){let n=[];return this.ndk?n=this.ndk.subManager.seenEvents.get(this.id)||[]:this.relay&&n.push(this.relay),n}publishStatus="success";publishError;constructor(n,s){super(),this.ndk=n,this.created_at=s?.created_at,this.content=s?.content||"",this.tags=s?.tags||[],this.id=s?.id||"",this.sig=s?.sig,this.pubkey=s?.pubkey||"",this.kind=s?.kind,s instanceof Vn&&(this.relay&&(this.relay=s.relay,this.ndk?.subManager.seenEvent(s.id,this.relay)),this.publishStatus=s.publishStatus,this.publishError=s.publishError)}static deserialize(n,s){return new Vn(n,deserialize(s))}rawEvent(){return{created_at:this.created_at,content:this.content,tags:this.tags,kind:this.kind,pubkey:this.pubkey,id:this.id,sig:this.sig}}set author(n){this.pubkey=n.pubkey,this._author=n,this._author.ndk??=this.ndk}get author(){if(this._author)return this._author;if(!this.ndk)throw new Error("No NDK instance found");const n=this.ndk.getUser({pubkey:this.pubkey});return this._author=n,n}tagExternal(n,s,a){const l=["i"],c=["k"];switch(s){case"url":{const h=new URL(n);h.hash="",l.push(h.toString()),c.push(`${h.protocol}//${h.host}`);break}case"hashtag":l.push(`#${n.toLowerCase()}`),c.push("#");break;case"geohash":l.push(`geo:${n.toLowerCase()}`),c.push("geo");break;case"isbn":l.push(`isbn:${n.replace(/-/g,"")}`),c.push("isbn");break;case"podcast:guid":l.push(`podcast:guid:${n}`),c.push("podcast:guid");break;case"podcast:item:guid":l.push(`podcast:item:guid:${n}`),c.push("podcast:item:guid");break;case"podcast:publisher:guid":l.push(`podcast:publisher:guid:${n}`),c.push("podcast:publisher:guid");break;case"isan":l.push(`isan:${n.split("-").slice(0,4).join("-")}`),c.push("isan");break;case"doi":l.push(`doi:${n.toLowerCase()}`),c.push("doi");break;default:throw new Error(`Unsupported NIP-73 entity type: ${s}`)}a&&l.push(a),this.tags.push(l),this.tags.push(c)}tag(n,s,a,l){let c=[];if(n.fetchProfile!==void 0){l??="p";const y=[l,n.pubkey];s&&y.push("",s),c.push(y)}else if(n instanceof Vn){const y=n;a??=y?.pubkey===this.pubkey,c=y.referenceTags(s,a,l);for(const g of y.getMatchingTags("p"))g[1]!==this.pubkey&&(this.tags.find(m=>m[0]==="p"&&m[1]===g[1])||this.tags.push(["p",g[1]]))}else if(Array.isArray(n))c=[n];else throw new Error("Invalid argument",n);this.tags=mergeTags(this.tags,c)}async toNostrEvent(n){if(!n&&this.pubkey===""){const l=await this.ndk?.signer?.user();this.pubkey=l?.pubkey||""}this.created_at||(this.created_at=Math.floor(Date.now()/1e3));const{content:s,tags:a}=await this.generateTags();this.content=s||"",this.tags=a;try{this.id=this.getEventHash()}catch{}return this.rawEvent()}serialize=serialize.bind(this);getEventHash=getEventHash.bind(this);validate=validate.bind(this);verifySignature=verifySignature.bind(this);isReplaceable=isReplaceable.bind(this);isEphemeral=isEphemeral.bind(this);isDvm=()=>this.kind&&this.kind>=5e3&&this.kind<=7e3;isParamReplaceable=isParamReplaceable.bind(this);encode=encode.bind(this);encrypt=encrypt.bind(this);decrypt=decrypt.bind(this);getMatchingTags(n,s){const a=this.tags.filter(l=>l[0]===n);return s===void 0?a:a.filter(l=>l[3]===s)}hasTag(n,s){return this.tags.some(a=>a[0]===n&&(!s||a[3]===s))}tagValue(n,s){const a=this.getMatchingTags(n,s);if(a.length!==0)return a[0][1]}get alt(){return this.tagValue("alt")}set alt(n){this.removeTag("alt"),n&&this.tags.push(["alt",n])}get dTag(){return this.tagValue("d")}set dTag(n){this.removeTag("d"),n&&this.tags.push(["d",n])}removeTag(n,s){const a=Array.isArray(n)?n:[n];this.tags=this.tags.filter(l=>{const c=a.includes(l[0]),h=s?l[3]===s:!0;return!(c&&h)})}replaceTag(n){this.removeTag(n[0]),this.tags.push(n)}async sign(n){n?this.author=await n.user():(this.ndk?.assertSigner(),n=this.ndk?.signer);const s=await this.toNostrEvent();return this.sig=await n.sign(s),this.sig}async publishReplaceable(n,s,a){return this.id="",this.created_at=Math.floor(Date.now()/1e3),this.sig="",this.publish(n,s,a)}async publish(n,s,a){if(a||(a=1),this.sig||await this.sign(),!this.ndk)throw new Error("NDKEvent must be associated with an NDK instance to publish");if((!n||n.size===0)&&(n=this.ndk.devWriteRelaySet||await calculateRelaySetFromEvent(this.ndk,this,a)),this.kind===5&&this.ndk.cacheAdapter?.deleteEventIds){const h=this.getMatchingTags("e").map(y=>y[1]);this.ndk.cacheAdapter.deleteEventIds(h)}const l=this.rawEvent();if(this.ndk.cacheAdapter?.addUnpublishedEvent&&shouldTrackUnpublishedEvent(this))try{this.ndk.cacheAdapter.addUnpublishedEvent(this,n.relayUrls)}catch(h){console.error("Error adding unpublished event to cache",h)}this.kind===5&&this.ndk.cacheAdapter?.deleteEventIds&&this.ndk.cacheAdapter.deleteEventIds(this.getMatchingTags("e").map(h=>h[1])),this.ndk.subManager.dispatchEvent(l,void 0,!0);const c=await n.publish(this,s,a);return c.forEach(h=>this.ndk?.subManager.seenEvent(this.id,h)),c}async generateTags(){let n=[];const s=await generateContentTags(this.content,this.tags),a=s.content;if(n=s.tags,this.kind&&this.isParamReplaceable()&&!this.getMatchingTags("d")[0]){const c=this.tagValue("title");let y=[...Array(c?6:16)].map(()=>Math.random().toString(36)[2]).join("");c&&c.length>0&&(y=`${c.replace(/[^a-z0-9]+/gi,"-").replace(/^-|-$/g,"")}-${y}`),n.push(["d",y])}if(this.shouldAddClientTag){const l=["client",this.ndk?.clientName??""];this.ndk?.clientNip89&&l.push(this.ndk?.clientNip89),n.push(l)}else this.shouldStripClientTag&&(n=n.filter(l=>l[0]!=="client"));return{content:a||"",tags:n}}get shouldAddClientTag(){return!(!this.ndk?.clientName&&!this.ndk?.clientNip89||skipClientTagOnKinds.has(this.kind)||this.isEphemeral()||this.isReplaceable()&&!this.isParamReplaceable()||this.isDvm()||this.hasTag("client"))}get shouldStripClientTag(){return skipClientTagOnKinds.has(this.kind)}muted(){const n=this.ndk?.mutedIds.get(this.pubkey);if(n&&n==="p")return"author";const s=this.tagReference(),a=this.ndk?.mutedIds.get(s[1]);return a&&a===s[0]?"event":null}replaceableDTag(){if(this.kind&&this.kind>=3e4&&this.kind<=4e4){const n=this.getMatchingTags("d")[0];return n?n[1]:""}throw new Error("Event is not a parameterized replaceable event")}deduplicationKey(){return this.kind===0||this.kind===3||this.kind&&this.kind>=1e4&&this.kind<2e4?`${this.kind}:${this.pubkey}`:this.tagId()}tagId(){return this.isParamReplaceable()?this.tagAddress():this.id}tagAddress(){if(this.isParamReplaceable()){const n=this.dTag??"";return`${this.kind}:${this.pubkey}:${n}`}if(this.isReplaceable())return`${this.kind}:${this.pubkey}:`;throw new Error("Event is not a replaceable event")}tagType(){return this.isParamReplaceable()?"a":"e"}tagReference(n){let s;return this.isParamReplaceable()?s=["a",this.tagAddress()]:s=["e",this.tagId()],this.relay?s.push(this.relay.url):s.push(""),s.push(n??""),this.isParamReplaceable()||s.push(this.pubkey),s}referenceTags(n,s,a){let l=[];return this.isParamReplaceable()?l=[[a??"a",this.tagAddress()],[a??"e",this.id]]:l=[[a??"e",this.id]],l=l.map(c=>(c[0]==="e"||n?c.push(this.relay?.url??""):this.relay?.url&&c.push(this.relay?.url),c)),l.forEach(c=>{c[0]==="e"?(c.push(n??""),c.push(this.pubkey)):n&&c.push(n)}),l=[...l,...this.getMatchingTags("h")],s||l.push(...this.author.referenceTags()),l}filter(){return this.isParamReplaceable()?{"#a":[this.tagId()]}:{"#e":[this.tagId()]}}nip22Filter(){return this.isParamReplaceable()?{"#A":[this.tagId()]}:{"#E":[this.tagId()]}}async delete(n,s=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const a=new Vn(this.ndk,{kind:5,content:n||""});return a.tag(this,void 0,!0),a.tags.push(["k",this.kind?.toString()]),s&&(this.emit("deleted"),await a.publish()),a}set isProtected(n){this.removeTag("-"),n&&this.tags.push(["-"])}get isProtected(){return this.hasTag("-")}fetchTaggedEvent=fetchTaggedEvent.bind(this);fetchRootEvent=fetchRootEvent.bind(this);fetchReplyEvent=fetchReplyEvent.bind(this);repost=repost.bind(this);async react(n,s=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const a=new Vn(this.ndk,{kind:7,content:n});return a.tag(this),this.kind!==1&&a.tags.push(["k",`${this.kind}`]),s&&await a.publish(),a}get isValid(){return this.validate()}get inspect(){return JSON.stringify(this.rawEvent(),null,4)}dump(){console.debug(JSON.stringify(this.rawEvent(),null,4)),console.debug("Event on relays:",this.onRelays.map(n=>n.url).join(", "))}reply(n){const s=new Vn(this.ndk);if(this.kind===1&&!n)s.kind=1,this.hasTag("e")?s.tags=[...s.tags,...this.getMatchingTags("e"),...this.getMatchingTags("p"),...this.getMatchingTags("a"),...this.referenceTags("reply")]:s.tag(this,"root");else{s.kind=1111;const a=["A","E","I","P"],l=this.tags.filter(c=>a.includes(c[0]));if(l.length>0){const c=this.tagValue("K");s.tags.push(...l),c&&s.tags.push(["K",c]);const[h,y,g,...m]=this.tagReference(),b=[h,y,...m];s.tags.push(b)}else{const[c,h,y,g]=this.tagReference(),m=[c,h,g??""];c==="e"&&m.push(this.pubkey),s.tags.push(m);const b=[...m];b[0]=b[0].toUpperCase(),s.tags.push(b),s.tags.push(["K",this.kind?.toString()]),s.tags.push(["P",this.pubkey])}s.tags.push(["k",this.kind?.toString()]),s.tags.push(...this.getMatchingTags("p")),s.tags.push(["p",this.pubkey])}return s}},untrackedUnpublishedEvents=new Set([24133,13194,23194,23195]);function shouldTrackUnpublishedEvent(t){return!untrackedUnpublishedEvents.has(t.kind)}var NDKPool=class extends libExports.EventEmitter{_relays=new Map;status="idle";autoConnectRelays=new Set;poolBlacklistRelayUrls=new Set;debug;temporaryRelayTimers=new Map;flappingRelays=new Set;backoffTimes=new Map;ndk;get blacklistRelayUrls(){const t=new Set(this.ndk.blacklistRelayUrls);return this.poolBlacklistRelayUrls.forEach(n=>t.add(n)),t}constructor(t,n,s,{debug:a,name:l}={}){super(),this.debug=a??s.debug.extend("pool"),l&&(this._name=l),this.ndk=s,this.relayUrls=t,this.poolBlacklistRelayUrls=new Set(n),this.ndk.pools.push(this)}get relays(){return this._relays}set relayUrls(t){this._relays.clear();for(const n of t){const s=new NDKRelay(n,void 0,this.ndk);s.connectivity.netDebug=this.ndk.netDebug,this.addRelay(s)}}_name="unnamed";get name(){return this._name}set name(t){this._name=t,this.debug=this.debug.extend(t)}useTemporaryRelay(t,n=3e4,s){const a=this.relays.has(t.url);a||(this.addRelay(t),this.debug("Adding temporary relay %s for filters %o",t.url,s));const l=this.temporaryRelayTimers.get(t.url);if(l&&clearTimeout(l),!a||l){const c=setTimeout(()=>{this.ndk.explicitRelayUrls?.includes(t.url)||this.removeRelay(t.url)},n);this.temporaryRelayTimers.set(t.url,c)}}addRelay(t,n=!0){const s=this.relays.has(t.url),a=this.blacklistRelayUrls?.has(t.url),l=t.url.includes("/npub1");let c=!0;const h=t.url;if(s)return;if(a){this.debug(`Refusing to add relay ${h}: blacklisted`);return}if(l){this.debug(`Refusing to add relay ${h}: is a filter relay`);return}if(this.ndk.cacheAdapter?.getRelayStatus){const A=this.ndk.cacheAdapter.getRelayStatus(h);if(A?.dontConnectBefore){if(A.dontConnectBefore>Date.now()){const B=A.dontConnectBefore-Date.now();this.debug(`Refusing to add relay ${h}: delayed connect for ${B}ms`),setTimeout(()=>{this.addRelay(t,n)},B);return}c=!1}}const y=A=>this.emit("notice",t,A),g=()=>this.handleRelayConnect(h),m=()=>this.handleRelayReady(t),b=()=>this.emit("relay:disconnect",t),v=()=>this.handleFlapping(t),w=A=>this.emit("relay:auth",t,A),S=()=>this.emit("relay:authed",t);t.off("notice",y),t.off("connect",g),t.off("ready",m),t.off("disconnect",b),t.off("flapping",v),t.off("auth",w),t.off("authed",S),t.on("notice",y),t.on("connect",g),t.on("ready",m),t.on("disconnect",b),t.on("flapping",v),t.on("auth",w),t.on("authed",S),t.on("delayed-connect",A=>{this.ndk.cacheAdapter?.updateRelayStatus&&this.ndk.cacheAdapter.updateRelayStatus(t.url,{dontConnectBefore:Date.now()+A})}),this._relays.set(h,t),n&&this.autoConnectRelays.add(h),n&&this.status==="active"&&(this.emit("relay:connecting",t),t.connect(void 0,c).catch(A=>{this.debug(`Failed to connect to relay ${h}`,A)}))}removeRelay(t){const n=this.relays.get(t);if(n)return n.disconnect(),this.relays.delete(t),this.autoConnectRelays.delete(t),this.emit("relay:disconnect",n),!0;const s=this.temporaryRelayTimers.get(t);return s&&(clearTimeout(s),this.temporaryRelayTimers.delete(t)),!1}isRelayConnected(t){const n=normalizeRelayUrl(t),s=this.relays.get(n);return s?s.status===5:!1}getRelay(t,n=!0,s=!1,a){let l=this.relays.get(normalizeRelayUrl(t));return l||(l=new NDKRelay(t,void 0,this.ndk),l.connectivity.netDebug=this.ndk.netDebug,s?this.useTemporaryRelay(l,3e4,a):this.addRelay(l,n)),l}handleRelayConnect(t){const n=this.relays.get(t);if(!n){console.error("NDK BUG: relay not found in pool",{relayUrl:t});return}this.emit("relay:connect",n),this.stats().connected===this.relays.size&&this.emit("connect")}handleRelayReady(t){this.emit("relay:ready",t)}async connect(t){this.status="active",this.debug(`Connecting to ${this.relays.size} relays${t?`, timeout ${t}ms`:""}...`);const n=Array.from(this.autoConnectRelays.keys()).map(c=>this.relays.get(c)).filter(c=>!!c);for(const c of n)c.status!==5&&c.status!==4&&(this.emit("relay:connecting",c),c.connect().catch(h=>{this.debug(`Failed to connect to relay ${c.url}: ${h??"No reason specified"}`)}));const s=()=>n.every(c=>c.status===5),a=new Promise(c=>{if(s()){c();return}const h=[];for(const y of n){const g=()=>{if(s()){for(let m=0;m<n.length;m++)n[m].off("connect",h[m]);c()}};h.push(g),y.on("connect",g)}}),l=typeof t=="number"?new Promise(c=>setTimeout(c,t)):new Promise(()=>{});await Promise.race([a,l])}checkOnFlappingRelays(){const t=this.flappingRelays.size,n=this.relays.size;if(t/n>=.8)for(const s of this.flappingRelays)this.backoffTimes.set(s,0)}handleFlapping(t){this.debug(`Relay ${t.url} is flapping`);let n=this.backoffTimes.get(t.url)||5e3;n=n*2,this.backoffTimes.set(t.url,n),this.debug(`Backoff time for ${t.url} is ${n}ms`),setTimeout(()=>{this.debug(`Attempting to reconnect to ${t.url}`),this.emit("relay:connecting",t),t.connect(),this.checkOnFlappingRelays()},n),t.disconnect(),this.emit("flapping",t)}size(){return this.relays.size}stats(){const t={total:0,connected:0,disconnected:0,connecting:0};for(const n of this.relays.values())t.total++,n.status===5?t.connected++:n.status===1?t.disconnected++:n.status===4&&t.connecting++;return t}connectedRelays(){return Array.from(this.relays.values()).filter(t=>t.status>=5)}permanentAndConnectedRelays(){return Array.from(this.relays.values()).filter(t=>t.status>=5&&!this.temporaryRelayTimers.has(t.url))}urls(){return Array.from(this.relays.keys())}},NDKCashuMintList=class eh extends NDKEvent{static kind=10019;static kinds=[10019];_p2pk;constructor(n,s){super(n,s),this.kind??=10019}static from(n){return new eh(n.ndk,n)}set relays(n){this.tags=this.tags.filter(s=>s[0]!=="relay");for(const s of n)this.tags.push(["relay",s])}get relays(){const n=[];for(const s of this.tags)s[0]==="relay"&&n.push(s[1]);return n}set mints(n){this.tags=this.tags.filter(s=>s[0]!=="mint");for(const s of n)this.tags.push(["mint",s])}get mints(){const n=[];for(const s of this.tags)s[0]==="mint"&&n.push(s[1]);return Array.from(new Set(n))}get p2pk(){return this._p2pk?this._p2pk:(this._p2pk=this.tagValue("pubkey")??this.pubkey,this._p2pk)}set p2pk(n){this._p2pk=n,this.removeTag("pubkey"),n&&this.tags.push(["pubkey",n])}get relaySet(){return NDKRelaySet.fromRelayUrls(this.relays,this.ndk)}},NDKArticle=class th extends NDKEvent{static kind=30023;static kinds=[30023];constructor(n,s){super(n,s),this.kind??=30023}static from(n){return new th(n.ndk,n)}get title(){return this.tagValue("title")}set title(n){this.removeTag("title"),n&&this.tags.push(["title",n])}get image(){return this.tagValue("image")}set image(n){this.removeTag("image"),n&&this.tags.push(["image",n])}get summary(){return this.tagValue("summary")}set summary(n){this.removeTag("summary"),n&&this.tags.push(["summary",n])}get published_at(){const n=this.tagValue("published_at");if(n){let s=Number.parseInt(n);return s>1e12&&(s=Math.floor(s/1e3)),s}}set published_at(n){this.removeTag("published_at"),n!==void 0&&this.tags.push(["published_at",n.toString()])}async generateTags(){return super.generateTags(),this.published_at||(this.published_at=this.created_at),super.generateTags()}get url(){return this.tagValue("url")}set url(n){n?this.tags.push(["url",n]):this.removeTag("url")}};function proofsTotalBalance(t){return t.reduce((n,s)=>{if(s.amount<0)throw new Error("proof amount is negative");return n+s.amount},0)}var NDKCashuToken=class nh extends NDKEvent{_proofs=[];_mint;static kind=7375;static kinds=[7375];_deletes=[];original;constructor(n,s){super(n,s),this.kind??=7375}static async from(n){const s=new nh(n.ndk,n);s.original=n;try{await s.decrypt()}catch{s.content=s.original.content}try{const a=JSON.parse(s.content);if(s.proofs=a.proofs,s.mint=a.mint??s.tagValue("mint"),s.deletedTokens=a.del??[],!Array.isArray(s.proofs))return}catch{return}return s}get proofs(){return this._proofs}set proofs(n){const s=new Set;this._proofs=n.filter(a=>s.has(a.C)?(console.warn("Passed in proofs had duplicates, ignoring",a.C),!1):a.amount<0?(console.warn("Invalid proof with negative amount",a),!1):(s.add(a.C),!0)).map(this.cleanProof)}cleanProof(n){return{id:n.id,amount:n.amount,C:n.C,secret:n.secret}}async toNostrEvent(n){if(!this.ndk)throw new Error("no ndk");if(!this.ndk.signer)throw new Error("no signer");const s={proofs:this.proofs.map(this.cleanProof),mint:this.mint,del:this.deletedTokens??[]};this.content=JSON.stringify(s);const a=await this.ndk.signer.user();return await this.encrypt(a,void 0,"nip44"),super.toNostrEvent(n)}set mint(n){this._mint=n}get mint(){return this._mint}get deletedTokens(){return this._deletes}set deletedTokens(n){this._deletes=n}get amount(){return proofsTotalBalance(this.proofs)}async publish(n,s,a){return this.original?this.original.publish(n,s,a):super.publish(n,s,a)}},NDKHighlight=class ih extends NDKEvent{_article;static kind=9802;static kinds=[9802];constructor(n,s){super(n,s),this.kind??=9802}static from(n){return new ih(n.ndk,n)}get url(){return this.tagValue("r")}set context(n){n===void 0?this.tags=this.tags.filter(([s,a])=>s!=="context"):(this.tags=this.tags.filter(([s,a])=>s!=="context"),this.tags.push(["context",n]))}get context(){return this.tags.find(([n,s])=>n==="context")?.[1]??void 0}get article(){return this._article}set article(n){this._article=n,typeof n=="string"?this.tags.push(["r",n]):this.tag(n)}getArticleTag(){return this.getMatchingTags("a")[0]||this.getMatchingTags("e")[0]||this.getMatchingTags("r")[0]}async getArticle(){if(this._article!==void 0)return this._article;let n;const s=this.getArticleTag();if(s){switch(s[0]){case"a":{const[a,l,c]=s[1].split(":");n=nip19_exports.naddrEncode({kind:Number.parseInt(a),pubkey:l,identifier:c});break}case"e":n=nip19_exports.noteEncode(s[1]);break;case"r":this._article=s[1];break}if(n){let a=await this.ndk?.fetchEvent(n);a&&(a.kind===30023&&(a=NDKArticle.from(a)),this._article=a)}return this._article}}};function mapImetaTag(t){const n={};if(t.length===2){const a=t[1].split(" ");for(let l=0;l<a.length;l+=2){const c=a[l],h=a[l+1];c==="fallback"?(n.fallback||(n.fallback=[]),n.fallback.push(h)):n[c]=h}return n}const s=t.slice(1);for(const a of s){const l=a.split(" "),c=l[0],h=l.slice(1).join(" ");c==="fallback"?(n.fallback||(n.fallback=[]),n.fallback.push(h)):n[c]=h}return n}function imetaTagToTag(t){const n=["imeta"];for(const[s,a]of Object.entries(t))if(Array.isArray(a))for(const l of a)n.push(`${s} ${l}`);else a&&n.push(`${s} ${a}`);return n}var NDKImage=class rh extends NDKEvent{static kind=20;static kinds=[20];_imetas;constructor(n,s){super(n,s),this.kind??=20}static from(n){return new rh(n.ndk,n.rawEvent())}get isValid(){return this.imetas.length>0}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(n=>n[0]==="imeta").map(mapImetaTag).filter(n=>!!n.url),this._imetas)}set imetas(n){this._imetas=n,this.tags=this.tags.filter(s=>s[0]!=="imeta"),this.tags.push(...n.map(imetaTagToTag))}},NDKList=class sh extends NDKEvent{_encryptedTags;static kinds=[10063,30001,10004,10050,10030,10015,10001,10002,10007,10006,10003];encryptedTagsLength;constructor(n,s){super(n,s),this.kind??=30001}static from(n){return new sh(n.ndk,n)}get title(){const n=this.tagValue("title")||this.tagValue("name");return n||(this.kind===3?"Contacts":this.kind===1e4?"Mute":this.kind===10001?"Pinned Notes":this.kind===10002?"Relay Metadata":this.kind===10003?"Bookmarks":this.kind===10004?"Communities":this.kind===10005?"Public Chats":this.kind===10006?"Blocked Relays":this.kind===10007?"Search Relays":this.kind===10050?"Direct Message Receive Relays":this.kind===10015?"Interests":this.kind===10030?"Emojis":this.tagValue("d"))}set title(n){this.removeTag(["title","name"]),n&&this.tags.push(["title",n])}get name(){return this.title}set name(n){this.title=n}get description(){return this.tagValue("description")}set description(n){this.removeTag("description"),n&&this.tags.push(["description",n])}get image(){return this.tagValue("image")}set image(n){this.removeTag("image"),n&&this.tags.push(["image",n])}isEncryptedTagsCacheValid(){return!!(this._encryptedTags&&this.encryptedTagsLength===this.content.length)}async encryptedTags(n=!0){if(n&&this.isEncryptedTagsCacheValid())return this._encryptedTags;if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const s=await this.ndk.signer.user();try{if(this.content.length>0)try{const a=await this.ndk.signer.decrypt(s,this.content),l=JSON.parse(a);return l?.[0]?(this.encryptedTagsLength=this.content.length,this._encryptedTags=l):(this.encryptedTagsLength=this.content.length,this._encryptedTags=[])}catch{}}catch{}return[]}validateTag(n){return!0}getItems(n){return this.tags.filter(s=>s[0]===n)}get items(){return this.tags.filter(n=>!["d","L","l","title","name","description","published_at","summary","image","thumb","alt","expiration","subject","client"].includes(n[0]))}async addItem(n,s=void 0,a=!1,l="bottom"){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");let c;if(n instanceof NDKEvent)c=[n.tagReference(s)];else if(n instanceof NDKUser)c=n.referenceTags();else if(n instanceof NDKRelay)c=n.referenceTags();else if(Array.isArray(n))c=[n];else throw new Error("Invalid object type");if(s&&c[0].push(s),a){const h=await this.ndk.signer.user(),y=await this.encryptedTags();l==="top"?y.unshift(...c):y.push(...c),this._encryptedTags=y,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(y),await this.encrypt(h)}else l==="top"?this.tags.unshift(...c):this.tags.push(...c);this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItemByValue(n,s=!0){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const a=this.tags.findIndex(y=>y[1]===n);a>=0&&this.tags.splice(a,1);const l=await this.ndk.signer.user(),c=await this.encryptedTags(),h=c.findIndex(y=>y[1]===n);if(h>=0&&(c.splice(h,1),this._encryptedTags=c,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(c),await this.encrypt(l)),s)return this.publishReplaceable();this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItem(n,s){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");if(s){const a=await this.ndk.signer.user(),l=await this.encryptedTags();l.splice(n,1),this._encryptedTags=l,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(l),await this.encrypt(a)}else this.tags.splice(n,1);return this.created_at=Math.floor(Date.now()/1e3),this.emit("change"),this}has(n){return this.items.some(s=>s[1]===n)}filterForItems(){const n=new Set,s=new Map,a=[];for(const l of this.items)if(l[0]==="e"&&l[1])n.add(l[1]);else if(l[0]==="a"&&l[1]){const[c,h,y]=l[1].split(":");if(!c||!h)continue;const g=`${c}:${h}`,m=s.get(g)||[];m.push(y||""),s.set(g,m)}if(n.size>0&&a.push({ids:Array.from(n)}),s.size>0)for(const[l,c]of s.entries()){const[h,y]=l.split(":");a.push({kinds:[Number.parseInt(h)],authors:[y],"#d":c})}return a}},lists_default=NDKList,NDKNutzap=class nl extends NDKEvent{debug;_proofs=[];static kind=9321;static kinds=[nl.kind];constructor(n,s){super(n,s),this.kind??=9321,this.debug=n?.debug.extend("nutzap")??createDebug5("ndk:nutzap"),this.alt||(this.alt="This is a nutzap");try{const a=this.getMatchingTags("proof");a.length?this._proofs=a.map(l=>JSON.parse(l[1])):this._proofs=JSON.parse(this.content)}catch{return}}static from(n){const s=new nl(n.ndk,n);if(!(!s._proofs||!s._proofs.length))return s}set comment(n){this.content=n??""}get comment(){const n=this.tagValue("comment");return n||this.content}set proofs(n){this._proofs=n,this.tags=this.tags.filter(s=>s[0]!=="proof");for(const s of n)this.tags.push(["proof",JSON.stringify(s)])}get proofs(){return this._proofs}get rawP2pk(){const n=this.proofs[0];try{const s=JSON.parse(n.secret);let a;if(typeof s=="string"?(a=JSON.parse(s),this.debug("stringified payload",n.secret)):typeof s=="object"&&(a=s),Array.isArray(a)&&a[0]==="P2PK"&&a.length>1&&typeof a[1]=="object"&&a[1]!==null||typeof a=="object"&&a!==null&&typeof a[1]?.data=="string")return a[1].data}catch(s){this.debug("error parsing p2pk pubkey",s,this.proofs[0])}}get p2pk(){const n=this.rawP2pk;if(n)return n.startsWith("02")?n.slice(2):n}get mint(){return this.tagValue("u")}set mint(n){this.replaceTag(["u",n])}get unit(){let n=this.tagValue("unit")??"sat";return n?.startsWith("msat")&&(n="sat"),n}set unit(n){if(this.removeTag("unit"),n?.startsWith("msat"))throw new Error("msat is not allowed, use sat denomination instead");n&&this.tag(["unit",n])}get amount(){return this.proofs.reduce((s,a)=>s+a.amount,0)}sender=this.author;set target(n){this.tags=this.tags.filter(s=>s[0]!=="p"),n instanceof NDKEvent&&this.tags.push(n.tagReference())}set recipientPubkey(n){this.removeTag("p"),this.tag(["p",n])}get recipientPubkey(){return this.tagValue("p")}get recipient(){const n=this.recipientPubkey;return this.ndk?this.ndk.getUser({pubkey:n}):new NDKUser({pubkey:n})}async toNostrEvent(){this.unit==="msat"&&(this.unit="sat"),this.removeTag("amount"),this.tags.push(["amount",this.amount.toString()]);const n=await super.toNostrEvent();return n.content=this.comment,n}get isValid(){let n=0,s=0,a=0;for(const l of this.tags)l[0]==="e"&&n++,l[0]==="p"&&s++,l[0]==="u"&&a++;return s===1&&a===1&&n<=1&&this.proofs.length>0}},NDKSimpleGroupMemberList=class ah extends NDKEvent{relaySet;memberSet=new Set;static kind=39002;static kinds=[39002];constructor(n,s){super(n,s),this.kind??=39002,this.memberSet=new Set(this.members)}static from(n){return new ah(n.ndk,n)}get members(){return this.getMatchingTags("p").map(n=>n[1])}hasMember(n){return this.memberSet.has(n)}async publish(n,s,a){return n??=this.relaySet,super.publishReplaceable(n,s,a)}},NDKSimpleGroupMetadata=class oh extends NDKEvent{static kind=39e3;static kinds=[39e3];constructor(n,s){super(n,s),this.kind??=39e3}static from(n){return new oh(n.ndk,n)}get name(){return this.tagValue("name")}get picture(){return this.tagValue("picture")}get about(){return this.tagValue("about")}get scope(){if(this.getMatchingTags("public").length>0)return"public";if(this.getMatchingTags("public").length>0)return"private"}set scope(n){this.removeTag("public"),this.removeTag("private"),n==="public"?this.tags.push(["public",""]):n==="private"&&this.tags.push(["private",""])}get access(){if(this.getMatchingTags("open").length>0)return"open";if(this.getMatchingTags("closed").length>0)return"closed"}set access(n){this.removeTag("open"),this.removeTag("closed"),n==="open"?this.tags.push(["open",""]):n==="closed"&&this.tags.push(["closed",""])}};function strToPosition(t){const[n,s]=t.split(",").map(Number);return{x:n,y:s}}function strToDimension(t){const[n,s]=t.split("x").map(Number);return{width:n,height:s}}var NDKStorySticker=class lh{static Text="text";static Pubkey="pubkey";static Event="event";static Prompt="prompt";static Countdown="countdown";type;value;position;dimension;properties;constructor(n){if(Array.isArray(n)){const s=n;if(s[0]!=="sticker"||s.length<5)throw new Error("Invalid sticker tag");this.type=s[1],this.value=s[2],this.position=strToPosition(s[3]),this.dimension=strToDimension(s[4]);const a={};for(let l=5;l<s.length;l++){const[c,...h]=s[l].split(" ");a[c]=h.join(" ")}Object.keys(a).length>0&&(this.properties=a)}else this.type=n,this.value=void 0,this.position={x:0,y:0},this.dimension={width:0,height:0}}static fromTag(n){try{return new lh(n)}catch{return null}}get style(){return this.properties?.style}set style(n){n?this.properties={...this.properties,style:n}:delete this.properties?.style}get rotation(){return this.properties?.rot?Number.parseFloat(this.properties.rot):void 0}set rotation(n){n!==void 0?this.properties={...this.properties,rot:n.toString()}:delete this.properties?.rot}get isValid(){return this.hasValidDimensions()&&this.hasValidPosition()}hasValidDimensions=()=>typeof this.dimension.width=="number"&&typeof this.dimension.height=="number"&&!Number.isNaN(this.dimension.width)&&!Number.isNaN(this.dimension.height);hasValidPosition=()=>typeof this.position.x=="number"&&typeof this.position.y=="number"&&!Number.isNaN(this.position.x)&&!Number.isNaN(this.position.y);toTag(){if(!this.isValid){const a=[this.hasValidDimensions()?void 0:"dimensions is invalid",this.hasValidPosition()?void 0:"position is invalid"].filter(Boolean);throw new Error(`Invalid sticker: ${a.join(", ")}`)}let n;switch(this.type){case"event":n=this.value.tagId();break;case"pubkey":n=this.value.pubkey;break;default:n=this.value}const s=["sticker",this.type,n,coordinates(this.position),dimension(this.dimension)];if(this.properties)for(const[a,l]of Object.entries(this.properties))s.push(`${a} ${l}`);return s}},NDKStory=class uh extends NDKEvent{static kind=23;static kinds=[23];_imeta;_dimensions;constructor(n,s){if(super(n,s),this.kind??=23,s)for(const a of s.tags)switch(a[0]){case"imeta":this._imeta=mapImetaTag(a);break;case"dim":this.dimensions=strToDimension(a[1]);break}}static from(n){return new uh(n.ndk,n)}get isValid(){return!!this.imeta}get imeta(){return this._imeta}set imeta(n){this._imeta=n,this.tags=this.tags.filter(s=>s[0]!=="imeta"),n&&this.tags.push(imetaTagToTag(n))}get dimensions(){const n=this.tagValue("dim");if(n)return strToDimension(n)}set dimensions(n){this.removeTag("dim"),n&&this.tags.push(["dim",`${n.width}x${n.height}`])}get duration(){const n=this.tagValue("dur");if(n)return Number.parseInt(n)}set duration(n){this.removeTag("dur"),n!==void 0&&this.tags.push(["dur",n.toString()])}get stickers(){const n=[];for(const s of this.tags){if(s[0]!=="sticker"||s.length<5)continue;const a=NDKStorySticker.fromTag(s);a&&n.push(a)}return n}addSticker(n){let s;if(n instanceof NDKStorySticker)s=n;else{const a=["sticker",n.type,typeof n.value=="string"?n.value:"",coordinates(n.position),dimension(n.dimension)];if(n.properties)for(const[l,c]of Object.entries(n.properties))a.push(`${l} ${c}`);s=new NDKStorySticker(a),s.value=n.value}s.type==="pubkey"?this.tag(s.value):s.type==="event"&&this.tag(s.value),this.tags.push(s.toTag())}removeSticker(n){const s=this.stickers;if(n<0||n>=s.length)return;let a=0;for(let l=0;l<this.tags.length;l++)if(this.tags[l][0]==="sticker"){if(a===n){this.tags.splice(l,1);break}a++}}},coordinates=t=>`${t.x},${t.y}`,dimension=t=>`${t.width}x${t.height}`,possibleIntervalFrequencies=["daily","weekly","monthly","quarterly","yearly"];function newAmount(t,n,s){return["amount",t.toString(),n,s]}function parseTagToSubscriptionAmount(t){const n=Number.parseInt(t[1]);if(Number.isNaN(n)||n===void 0||n===null||n<=0)return;const s=t[2];if(s===void 0||s==="")return;const a=t[3];if(a!==void 0&&possibleIntervalFrequencies.includes(a))return{amount:n,currency:s,term:a}}var NDKSubscriptionTier=class ch extends NDKArticle{static kind=37001;static kinds=[37001];constructor(n,s){const a=s?.kind??37001;super(n,s),this.kind=a}static from(n){return new ch(n.ndk,n)}get perks(){return this.getMatchingTags("perk").map(n=>n[1]).filter(n=>n!==void 0)}addPerk(n){this.tags.push(["perk",n])}get amounts(){return this.getMatchingTags("amount").map(n=>parseTagToSubscriptionAmount(n)).filter(n=>n!==void 0)}addAmount(n,s,a){this.tags.push(newAmount(n,s,a))}set relayUrl(n){this.tags.push(["r",n])}get relayUrls(){return this.getMatchingTags("r").map(n=>n[1]).filter(n=>n!==void 0)}get verifierPubkey(){return this.tagValue("p")}set verifierPubkey(n){this.removeTag("p"),n&&this.tags.push(["p",n])}get isValid(){return this.title!==void 0&&this.amounts.length>0}},NDKVideo=class fh extends NDKEvent{static kind=21;static kinds=[34235,34236,22,21];_imetas;static from(n){return new fh(n.ndk,n.rawEvent())}get title(){return this.tagValue("title")}set title(n){this.removeTag("title"),n&&this.tags.push(["title",n])}get thumbnail(){let n;return this.imetas&&this.imetas.length>0&&(n=this.imetas[0].image?.[0]),n??this.tagValue("thumb")}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(n=>n[0]==="imeta").map(mapImetaTag),this._imetas)}set imetas(n){this._imetas=n,this.tags=this.tags.filter(s=>s[0]!=="imeta"),this.tags.push(...n.map(imetaTagToTag))}get url(){return this.imetas&&this.imetas.length>0?this.imetas[0].url:this.tagValue("url")}get published_at(){const n=this.tagValue("published_at");if(n)return Number.parseInt(n)}async generateTags(){if(super.generateTags(),!this.kind&&this.imetas?.[0]?.dim){const[n,s]=this.imetas[0].dim.split("x"),a=n&&s&&Number.parseInt(n)<Number.parseInt(s);this.duration&&this.duration<120&&a?this.kind=22:this.kind=21}return super.generateTags()}get duration(){const n=this.tagValue("duration");if(n)return Number.parseInt(n)}set duration(n){this.removeTag("duration"),n!==void 0&&this.tags.push(["duration",Math.floor(n).toString()])}},NDKWiki=class hh extends NDKArticle{static kind=30818;static kinds=[30818];static from(n){return new hh(n.ndk,n.rawEvent())}get isDefered(){return this.hasTag("a","defer")}get deferedId(){return this.tagValue("a","defer")}set defer(n){this.removeTag("a","defer"),this.tag(n,"defer")}},NDKBlossomList=class dh extends NDKEvent{static kinds=[10063];constructor(n,s){super(n,s),this.kind??=10063}static from(n){return new dh(n.ndk,n.rawEvent())}get servers(){return this.tags.filter(n=>n[0]==="server").map(n=>n[1])}set servers(n){this.tags=this.tags.filter(s=>s[0]!=="server");for(const s of n)this.tags.push(["server",s])}get default(){const n=this.servers;return n.length>0?n[0]:void 0}set default(n){if(!n)return;const a=this.servers.filter(l=>l!==n);this.servers=[n,...a]}addServer(n){if(!n)return;const s=this.servers;s.includes(n)||(this.servers=[...s,n])}removeServer(n){if(!n)return;const s=this.servers;this.servers=s.filter(a=>a!==n)}},NDKFollowPack=class ph extends NDKEvent{static kind=39089;static kinds=[39089,39092];constructor(n,s){super(n,s),this.kind??=39089}static from(n){return new ph(n.ndk,n)}get title(){return this.tagValue("title")}set title(n){this.removeTag("title"),n&&this.tags.push(["title",n])}get image(){const n=this.tags.find(s=>s[0]==="imeta");if(n){const s=mapImetaTag(n);if(s.url)return s.url}return this.tagValue("image")}set image(n){this.tags=this.tags.filter(s=>s[0]!=="imeta"&&s[0]!=="image"),typeof n=="string"?n!==void 0&&this.tags.push(["image",n]):n&&typeof n=="object"&&(this.tags.push(imetaTagToTag(n)),n.url&&this.tags.push(["image",n.url]))}get pubkeys(){return Array.from(new Set(this.tags.filter(n=>n[0]==="p").map(n=>n[1])))}set pubkeys(n){this.tags=this.tags.filter(s=>s[0]!=="p");for(const s of n)this.tags.push(["p",s])}get description(){return this.tagValue("description")}set description(n){this.removeTag("description"),n&&this.tags.push(["description",n])}},signerRegistry=new Map;function registerSigner(t,n){signerRegistry.set(t,n)}var NDKPrivateKeySigner=class il{_user;_privateKey;_pubkey;constructor(n,s){if(typeof n=="string")if(n.startsWith("nsec1")){const{type:a,data:l}=nip19_exports.decode(n);if(a==="nsec")this._privateKey=l;else throw new Error("Invalid private key provided.")}else if(n.length===64)this._privateKey=hexToBytes(n);else throw new Error("Invalid private key provided.");else this._privateKey=n;this._pubkey=getPublicKey(this._privateKey),s&&(this._user=s.getUser({pubkey:this._pubkey})),this._user??=new NDKUser({pubkey:this._pubkey})}get privateKey(){if(!this._privateKey)throw new Error("Not ready");return bytesToHex(this._privateKey)}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}get nsec(){if(!this._privateKey)throw new Error("Not ready");return nip19_exports.nsecEncode(this._privateKey)}get npub(){if(!this._pubkey)throw new Error("Not ready");return nip19_exports.npubEncode(this._pubkey)}static generate(){const n=generateSecretKey();return new il(n)}async blockUntilReady(){return this._user}async user(){return this._user}get userSync(){return this._user}async sign(n){if(!this._privateKey)throw Error("Attempted to sign without a private key");return finalizeEvent(n,this._privateKey).sig}async encryptionEnabled(n){const s=[];return(!n||n==="nip04")&&s.push("nip04"),(!n||n==="nip44")&&s.push("nip44"),s}async encrypt(n,s,a){if(!this._privateKey||!this.privateKey)throw Error("Attempted to encrypt without a private key");const l=n.pubkey;if(a==="nip44"){const c=nip44_exports.v2.utils.getConversationKey(this._privateKey,l);return await nip44_exports.v2.encrypt(s,c)}return await nip04_exports.encrypt(this._privateKey,l,s)}async decrypt(n,s,a){if(!this._privateKey||!this.privateKey)throw Error("Attempted to decrypt without a private key");const l=n.pubkey;if(a==="nip44"){const c=nip44_exports.v2.utils.getConversationKey(this._privateKey,l);return await nip44_exports.v2.decrypt(s,c)}return await nip04_exports.decrypt(this._privateKey,l,s)}toPayload(){if(!this._privateKey)throw new Error("Private key not available");const n={type:"private-key",payload:this.privateKey};return JSON.stringify(n)}static async fromPayload(n,s){const a=JSON.parse(n);if(a.type!=="private-key")throw new Error(`Invalid payload type: expected 'private-key', got ${a.type}`);if(!a.payload||typeof a.payload!="string")throw new Error("Invalid payload content for private-key signer");return new il(a.payload,s)}};registerSigner("private-key",NDKPrivateKeySigner);var NDKProject=class rl extends NDKEvent{static kind=31933;static kinds=[rl.kind];_signer;constructor(n,s){super(n,s),this.kind=31933}static from(n){return new rl(n.ndk,n.rawEvent())}set repo(n){this.removeTag("repo"),n&&this.tags.push(["repo",n])}set hashtags(n){this.removeTag("hashtags"),n.filter(s=>s.length>0).length&&this.tags.push(["hashtags",...n])}get hashtags(){const n=this.tags.find(s=>s[0]==="hashtags");return n?n.slice(1):[]}get repo(){return this.tagValue("repo")}get title(){return this.tagValue("title")}set title(n){this.removeTag("title"),n&&this.tags.push(["title",n])}get picture(){return this.tagValue("picture")}set picture(n){this.removeTag("picture"),n&&this.tags.push(["picture",n])}set description(n){this.content=n}get description(){return this.content}get slug(){return this.dTag??"empty-dtag"}async getSigner(){if(this._signer)return this._signer;const n=this.tagValue("key");if(!n)this._signer=NDKPrivateKeySigner.generate(),await this.encryptAndSaveNsec();else{const s=await this.ndk?.signer?.decrypt(this.ndk.activeUser,n);if(!s)throw new Error("Failed to decrypt project key or missing signer context.");this._signer=new NDKPrivateKeySigner(s)}return this._signer}async getNsec(){return(await this.getSigner()).privateKey}async setNsec(n){this._signer=new NDKPrivateKeySigner(n),await this.encryptAndSaveNsec()}async encryptAndSaveNsec(){if(!this._signer)throw new Error("Signer is not set.");const n=this._signer.privateKey,s=await this.ndk?.signer?.encrypt(this.ndk.activeUser,n);s&&(this.removeTag("key"),this.tags.push(["key",s]))}},NDKThread=class yh extends NDKEvent{static kind=11;static kinds=[11];constructor(n,s){super(n,s),this.kind??=11}static from(n){return new yh(n.ndk,n)}get title(){return this.tagValue("title")}set title(n){this.removeTag("title"),n&&this.tags.push(["title",n])}},NDKDraft=class gh extends NDKEvent{_event;static kind=31234;static kinds=[31234,1234];counterparty;constructor(n,s){super(n,s),this.kind??=31234}static from(n){return new gh(n.ndk,n)}set identifier(n){this.removeTag("d"),this.tags.push(["d",n])}get identifier(){return this.dTag}set event(n){n instanceof NDKEvent?this._event=n:this._event=new NDKEvent(void 0,n),this.prepareEvent()}set checkpoint(n){n?(this.tags.push(n.tagReference()),this.kind=1234):(this.removeTag("a"),this.kind=31234)}get isCheckpoint(){return this.kind===1234}get isProposal(){const n=this.tagValue("p");return!!n&&n!==this.pubkey}async getEvent(n){if(this._event)return this._event;if(n??=this.ndk?.signer,!n)throw new Error("No signer available");if(this.content&&this.content.length>0)try{const s=n.pubkey,l=[this.tagValue("p"),this.pubkey].filter(Boolean).find(y=>y!==s);let c;c=new NDKUser({pubkey:l??s}),await this.decrypt(c,n);const h=JSON.parse(this.content);return this._event=await wrapEvent(new NDKEvent(this.ndk,h)),this._event}catch(s){console.error(s);return}else return null}prepareEvent(){if(!this._event)throw new Error("No event has been provided");this.removeTag("k"),this._event.kind&&this.tags.push(["k",this._event.kind.toString()]),this.content=JSON.stringify(this._event.rawEvent())}async save({signer:n,publish:s,relaySet:a}){if(n??=this.ndk?.signer,!n)throw new Error("No signer available");const l=this.counterparty||await n.user();if(await this.encrypt(l,n),this.counterparty){const c=this.counterparty.pubkey;this.removeTag("p"),this.tags.push(["p",c])}if(s!==!1)return this.publishReplaceable(a)}},NDKTask=class mh extends NDKEvent{static kind=1934;static kinds=[1934];constructor(n,s){super(n,s),this.kind=1934}static from(n){return new mh(n.ndk,n.rawEvent())}set title(n){this.removeTag("title"),n&&this.tags.push(["title",n])}get title(){return this.tagValue("title")}set project(n){this.removeTag("a"),this.tags.push(n.tagReference())}get projectSlug(){const n=this.getMatchingTags("a")[0];return n?n[1].split(/:/)?.[2]:void 0}},NDKProjectTemplate=class bh extends NDKEvent{static kind=30717;static kinds=[30717];constructor(n,s){super(n,s),this.kind=30717}static from(n){return new bh(n.ndk,n.rawEvent())}get templateId(){return this.dTag??""}set templateId(n){this.dTag=n}get name(){return this.tagValue("title")??""}set name(n){this.removeTag("title"),n&&this.tags.push(["title",n])}get description(){return this.tagValue("description")??""}set description(n){this.removeTag("description"),n&&this.tags.push(["description",n])}get repoUrl(){return this.tagValue("uri")??""}set repoUrl(n){this.removeTag("uri"),n&&this.tags.push(["uri",n])}get image(){return this.tagValue("image")}set image(n){this.removeTag("image"),n&&this.tags.push(["image",n])}get command(){return this.tagValue("command")}set command(n){this.removeTag("command"),n&&this.tags.push(["command",n])}get agentConfig(){const n=this.tagValue("agent");if(n)try{return JSON.parse(n)}catch{return}}set agentConfig(n){this.removeTag("agent"),n&&this.tags.push(["agent",JSON.stringify(n)])}get templateTags(){return this.getMatchingTags("t").map(n=>n[1]).filter(Boolean)}set templateTags(n){this.tags=this.tags.filter(s=>s[0]!=="t"),n.forEach(s=>{s&&this.tags.push(["t",s])})}},registeredEventClasses=new Set;function wrapEvent(t){const n=new Map,a=[...[NDKImage,NDKVideo,NDKCashuMintList,NDKArticle,NDKHighlight,NDKDraft,NDKWiki,NDKNutzap,NDKProject,NDKTask,NDKProjectTemplate,NDKSimpleGroupMemberList,NDKSimpleGroupMetadata,NDKSubscriptionTier,NDKCashuToken,NDKList,NDKStory,NDKBlossomList,NDKFollowPack,NDKThread],...registeredEventClasses];for(const c of a)for(const h of c.kinds)n.set(h,c);const l=n.get(t.kind);return l?l.from(t):t}function queryFullyFilled(t){return!!(filterIncludesIds(t.filter)&&resultHasAllRequestedIds(t))}function filterIncludesIds(t){return!!t.ids}function resultHasAllRequestedIds(t){const n=t.filter.ids;return!!n&&n.length===t.eventFirstSeen.size}function filterFromId(t){let n;if(t.match(NIP33_A_REGEX)){const[s,a,l]=t.split(":"),c={authors:[a],kinds:[Number.parseInt(s)]};return l&&(c["#d"]=[l]),c}if(t.match(BECH32_REGEX))try{switch(n=nip19_exports.decode(t),n.type){case"nevent":{const s={ids:[n.data.id]};return n.data.author&&(s.authors=[n.data.author]),n.data.kind&&(s.kinds=[n.data.kind]),s}case"note":return{ids:[n.data]};case"naddr":{const s={authors:[n.data.pubkey],kinds:[n.data.kind]};return n.data.identifier&&(s["#d"]=[n.data.identifier]),s}}}catch(s){console.error("Error decoding",t,s)}return{ids:[t]}}function isNip33AValue(t){return t.match(NIP33_A_REGEX)!==null}var NIP33_A_REGEX=/^(\d+):([0-9A-Fa-f]+)(?::(.*))?$/,BECH32_REGEX=/^n(event|ote|profile|pub|addr)1[\d\w]+$/;function relaysFromBech32(t,n){try{const s=nip19_exports.decode(t);if(["naddr","nevent"].includes(s?.type)){const a=s.data;if(a?.relays)return a.relays.map(l=>new NDKRelay(l,n.relayAuthDefaultPolicy,n))}}catch{}return[]}var defaultOpts={closeOnEose:!1,cacheUsage:"CACHE_FIRST",dontSaveToCache:!1,groupable:!0,groupableDelay:100,groupableDelayType:"at-most",cacheUnconstrainFilter:["limit","since","until"]},NDKSubscription=class extends libExports.EventEmitter{subId;filters;opts;pool;skipVerification=!1;skipValidation=!1;relayFilters;relaySet;ndk;debug;eventFirstSeen=new Map;eosesSeen=new Set;lastEventReceivedAt;mostRecentCacheEventTimestamp;internalId;closeOnEose;poolMonitor;skipOptimisticPublishEvent=!1;cacheUnconstrainFilter;constructor(t,n,s,a){super(),this.ndk=t,this.opts={...defaultOpts,...s||{}},this.pool=this.opts.pool||t.pool,this.filters=Array.isArray(n)?n:[n],this.subId=a||this.opts.subId,this.internalId=Math.random().toString(36).substring(7),this.debug=t.debug.extend(`subscription[${this.opts.subId??this.internalId}]`),this.opts.relaySet?this.relaySet=this.opts.relaySet:this.opts.relayUrls&&(this.relaySet=NDKRelaySet.fromRelayUrls(this.opts.relayUrls,this.ndk)),this.skipVerification=this.opts.skipVerification||!1,this.skipValidation=this.opts.skipValidation||!1,this.closeOnEose=this.opts.closeOnEose||!1,this.skipOptimisticPublishEvent=this.opts.skipOptimisticPublishEvent||!1,this.cacheUnconstrainFilter=this.opts.cacheUnconstrainFilter}relaysMissingEose(){return this.relayFilters?Array.from(this.relayFilters?.keys()).filter(n=>!this.eosesSeen.has(this.pool.getRelay(n,!1,!1))):[]}get filter(){return this.filters[0]}get groupableDelay(){if(this.isGroupable())return this.opts?.groupableDelay}get groupableDelayType(){return this.opts?.groupableDelayType||"at-most"}isGroupable(){return this.opts?.groupable||!1}shouldQueryCache(){return this.opts.addSinceFromCache?!0:this.opts?.cacheUsage==="ONLY_RELAY"?!1:(this.filters.some(n=>n.kinds?.some(s=>kindIsEphemeral(s))),!0)}shouldQueryRelays(){return this.opts?.cacheUsage!=="ONLY_CACHE"}shouldWaitForCache(){return this.opts.addSinceFromCache?!0:!!this.opts.closeOnEose&&!!this.ndk.cacheAdapter?.locking&&this.opts.cacheUsage!=="PARALLEL"}start(t=!0){let n;const s=l=>{if(t)for(const c of l)c.created_at&&(!this.mostRecentCacheEventTimestamp||c.created_at>this.mostRecentCacheEventTimestamp)&&(this.mostRecentCacheEventTimestamp=c.created_at),this.eventReceived(c,void 0,!0,!1);else{n=[];for(const c of l){c.created_at&&(!this.mostRecentCacheEventTimestamp||c.created_at>this.mostRecentCacheEventTimestamp)&&(this.mostRecentCacheEventTimestamp=c.created_at),c.ndk=this.ndk;const h=this.opts.wrap?wrapEvent(c):c;if(!h)break;if(h instanceof Promise){h.then(y=>{this.emitEvent(!1,y,void 0,!0,!1)});break}this.eventFirstSeen.set(h.id,Date.now()),n.push(h)}}},a=()=>{this.shouldQueryRelays()?(this.startWithRelays(),this.startPoolMonitor()):this.emit("eose",this)};return this.shouldQueryCache()?(n=this.startWithCache(),n instanceof Promise?this.shouldWaitForCache()?(n.then(l=>{if(s(l),queryFullyFilled(this)){this.emit("eose",this);return}a()}),null):(n.then(l=>{s(l)}),a(),null):(s(n),queryFullyFilled(this)?this.emit("eose",this):a(),n)):(a(),null)}startPoolMonitor(){this.debug.extend("pool-monitor"),this.poolMonitor=t=>{if(this.relayFilters?.has(t.url))return;calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool).get(t.url)&&(this.relayFilters?.set(t.url,this.filters),t.subscribe(this,this.filters))},this.pool.on("relay:connect",this.poolMonitor)}onStopped;stop(){this.emit("close",this),this.poolMonitor&&this.pool.off("relay:connect",this.poolMonitor),this.onStopped?.()}hasAuthorsFilter(){return this.filters.some(t=>t.authors?.length)}startWithCache(){return this.ndk.cacheAdapter?.query?this.ndk.cacheAdapter.query(this):[]}startWithRelays(){let t=this.filters;if(this.opts.addSinceFromCache&&this.mostRecentCacheEventTimestamp){const n=this.mostRecentCacheEventTimestamp+1;t=t.map(s=>({...s,since:Math.max(s.since||0,n)}))}if(!this.relaySet||this.relaySet.relays.size===0)this.relayFilters=calculateRelaySetsFromFilters(this.ndk,t,this.pool);else{this.relayFilters=new Map;for(const n of this.relaySet.relays)this.relayFilters.set(n.url,t)}for(const[n,s]of this.relayFilters)this.pool.getRelay(n,!0,!0,s).subscribe(this,s)}eventReceived(t,n,s=!1,a=!1){const l=t.id,c=this.eventFirstSeen.has(l);let h;if(t instanceof NDKEvent&&(h=t),c){const y=Date.now()-(this.eventFirstSeen.get(l)||0);if(this.emit("event:dup",t,n,y,this,s,a),n){const g=verifiedSignatures.get(l);if(g&&typeof g=="string")if(t.sig===g)n.addValidatedEvent();else{const m=t instanceof NDKEvent?t:new NDKEvent(this.ndk,t);this.ndk.reportInvalidSignature(m,n)}}}else{if(h??=new NDKEvent(this.ndk,t),h.ndk=this.ndk,h.relay=n,!s&&!a){if(!this.skipValidation&&!h.isValid){this.debug("Event failed validation %s from relay %s",l,n?.url);return}if(n)if(n.shouldValidateEvent()&&!this.skipVerification){if(h.relay=n,!this.ndk.asyncSigVerification){if(!h.verifySignature(!0)){this.debug("Event failed signature validation",t),this.ndk.reportInvalidSignature(h,n);return}n.addValidatedEvent()}}else n.addNonValidatedEvent();this.ndk.cacheAdapter&&!this.opts.dontSaveToCache&&this.ndk.cacheAdapter.setEvent(h,this.filters,n)}(!a||this.skipOptimisticPublishEvent!==!0)&&(this.emitEvent(this.opts?.wrap??!1,h,n,s,a),this.eventFirstSeen.set(l,Date.now()))}this.lastEventReceivedAt=Date.now()}emitEvent(t,n,s,a,l){const c=t?wrapEvent(n):n;c instanceof Promise?c.then(h=>this.emitEvent(!1,h,s,a,l)):c&&this.emit("event",c,s,this,a,l)}closedReceived(t,n){this.emit("closed",t,n)}eoseTimeout;eosed=!1;eoseReceived(t){this.debug("EOSE received from %s",t.url),this.eosesSeen.add(t);let n=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0;const s=this.eosesSeen.size===this.relayFilters?.size,a=queryFullyFilled(this),l=c=>{this.debug("Performing EOSE: %s %d",c,this.eosed),!this.eosed&&(this.eoseTimeout&&clearTimeout(this.eoseTimeout),this.emit("eose",this),this.eosed=!0,this.opts?.closeOnEose&&this.stop())};if(a||s)l("query filled or seen all");else if(this.relayFilters){let c=1e3;const h=new Set(this.pool.connectedRelays().map(m=>m.url)),y=Array.from(this.relayFilters.keys()).filter(m=>h.has(m));if(y.length===0){this.debug("No connected relays, waiting for all relays to connect",Array.from(this.relayFilters.keys()).join(", "));return}const g=this.eosesSeen.size/y.length;if(this.debug("Percentage of relays that have sent EOSE",{subId:this.subId,percentageOfRelaysThatHaveSentEose:g,seen:this.eosesSeen.size,total:y.length}),this.eosesSeen.size>=2&&g>=.5){if(c=c*(1-g),c===0){l("time to wait was 0");return}this.eoseTimeout&&clearTimeout(this.eoseTimeout);const m=()=>{n=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0,n!==void 0&&n<20?this.eoseTimeout=setTimeout(m,c):l(`send eose timeout: ${c}`)};this.eoseTimeout=setTimeout(m,c)}}}},kindIsEphemeral=t=>t>=2e4&&t<3e4;async function follows(t,n,s=3){if(!this.ndk)throw new Error("NDK not set");const a=await this.ndk.fetchEvent({kinds:[s],authors:[this.pubkey]},t||{groupable:!1});if(a){const l=new Set;return a.tags.forEach(c=>{c[0]==="p"&&l.add(c[1])}),n&&this.ndk?.outboxTracker?.trackUsers(Array.from(l)),[...l].reduce((c,h)=>{const y=new NDKUser({pubkey:h});return y.ndk=this.ndk,c.add(y),c},new Set)}return new Set}var NIP05_REGEX=/^(?:([\w.+-]+)@)?([\w.-]+)$/;async function getNip05For(t,n,s=fetch,a={}){return await t.queuesNip05.add({id:n,func:async()=>{if(t.cacheAdapter?.loadNip05){const g=await t.cacheAdapter.loadNip05(n);if(g!=="missing"){if(g){const m=new NDKUser({pubkey:g.pubkey,relayUrls:g.relays,nip46Urls:g.nip46});return m.ndk=t,m}if(a.cache!=="no-cache")return null}}const l=n.match(NIP05_REGEX);if(!l)return null;const[c,h="_",y]=l;try{const g=await s(`https://${y}/.well-known/nostr.json?name=${h}`,a),{names:m,relays:b,nip46:v}=parseNIP05Result(await g.json()),w=m[h.toLowerCase()];let S=null;return w&&(S={pubkey:w,relays:b?.[w],nip46:v?.[w]}),t?.cacheAdapter?.saveNip05&&t.cacheAdapter.saveNip05(n,S),S}catch(g){return t?.cacheAdapter?.saveNip05&&t?.cacheAdapter.saveNip05(n,null),console.error("Failed to fetch NIP05 for",n,g),null}}})}function parseNIP05Result(t){const n={names:{}};for(const[s,a]of Object.entries(t.names))typeof s=="string"&&typeof a=="string"&&(n.names[s.toLowerCase()]=a);if(t.relays){n.relays={};for(const[s,a]of Object.entries(t.relays))typeof s=="string"&&Array.isArray(a)&&(n.relays[s]=a.filter(l=>typeof l=="string"))}if(t.nip46){n.nip46={};for(const[s,a]of Object.entries(t.nip46))typeof s=="string"&&Array.isArray(a)&&(n.nip46[s]=a.filter(l=>typeof l=="string"))}return n}function profileFromEvent(t){const n={};let s;try{s=JSON.parse(t.content)}catch(a){throw new Error(`Failed to parse profile event: ${a}`)}n.profileEvent=JSON.stringify(t.rawEvent());for(const a of Object.keys(s))switch(a){case"name":n.name=s.name;break;case"display_name":n.displayName=s.display_name;break;case"image":case"picture":n.picture=s.picture||s.image,n.image=n.picture;break;case"banner":n.banner=s.banner;break;case"bio":n.bio=s.bio;break;case"nip05":n.nip05=s.nip05;break;case"lud06":n.lud06=s.lud06;break;case"lud16":n.lud16=s.lud16;break;case"about":n.about=s.about;break;case"website":n.website=s.website;break;default:n[a]=s[a];break}return n.created_at=t.created_at,n}function serializeProfile(t){const n={};for(const[s,a]of Object.entries(t))switch(s){case"username":case"name":n.name=a;break;case"displayName":n.display_name=a;break;case"image":case"picture":n.picture=a;break;case"bio":case"about":n.about=a;break;default:n[s]=a;break}return JSON.stringify(n)}var NDKUser=class vh{ndk;profile;profileEvent;_npub;_pubkey;relayUrls=[];nip46Urls=[];constructor(n){if(n.npub&&(this._npub=n.npub),n.hexpubkey&&(this._pubkey=n.hexpubkey),n.pubkey&&(this._pubkey=n.pubkey),n.relayUrls&&(this.relayUrls=n.relayUrls),n.nip46Urls&&(this.nip46Urls=n.nip46Urls),n.nprofile)try{const s=nip19_exports.decode(n.nprofile);s.type==="nprofile"&&(this._pubkey=s.data.pubkey,s.data.relays&&s.data.relays.length>0&&this.relayUrls.push(...s.data.relays))}catch(s){console.error("Failed to decode nprofile",s)}}get npub(){if(!this._npub){if(!this._pubkey)throw new Error("pubkey not set");this._npub=nip19_exports.npubEncode(this.pubkey)}return this._npub}get nprofile(){const n=this.profileEvent?.onRelays?.map(s=>s.url);return nip19_exports.nprofileEncode({pubkey:this.pubkey,relays:n})}set npub(n){this._npub=n}get pubkey(){if(!this._pubkey){if(!this._npub)throw new Error("npub not set");this._pubkey=nip19_exports.decode(this.npub).data}return this._pubkey}set pubkey(n){this._pubkey=n}filter(){return{"#p":[this.pubkey]}}async getZapInfo(n){if(!this.ndk)throw new Error("No NDK instance found");const s=async h=>{if(!n)return h;let y;const g=new Promise((m,b)=>{y=setTimeout(()=>b(new Error("Timeout")),n)});try{const m=await Promise.race([h,g]);return y&&clearTimeout(y),m}catch(m){if(m instanceof Error&&m.message==="Timeout")try{return await h}catch{return}return}},[a,l]=await Promise.all([s(this.fetchProfile()),s(this.ndk.fetchEvent({kinds:[10019],authors:[this.pubkey]}))]),c=new Map;if(l){const h=NDKCashuMintList.from(l);h.mints.length>0&&c.set("nip61",{mints:h.mints,relays:h.relays,p2pk:h.p2pk})}if(a){const{lud06:h,lud16:y}=a;c.set("nip57",{lud06:h,lud16:y})}return c}static async fromNip05(n,s,a=!1){if(!s)throw new Error("No NDK instance found");const l={};a&&(l.cache="no-cache");const c=await getNip05For(s,n,s?.httpFetch,l);if(c){const h=new vh({pubkey:c.pubkey,relayUrls:c.relays,nip46Urls:c.nip46});return h.ndk=s,h}}async fetchProfile(n,s=!1){if(!this.ndk)throw new Error("NDK not set");let a=null;if(this.ndk.cacheAdapter&&(this.ndk.cacheAdapter.fetchProfile||this.ndk.cacheAdapter.fetchProfileSync)&&n?.cacheUsage!=="ONLY_RELAY"){let l=null;if(this.ndk.cacheAdapter.fetchProfileSync?l=this.ndk.cacheAdapter.fetchProfileSync(this.pubkey):this.ndk.cacheAdapter.fetchProfile&&(l=await this.ndk.cacheAdapter.fetchProfile(this.pubkey)),l)return this.profile=l,l}return n??={},n.cacheUsage??="ONLY_RELAY",n.closeOnEose??=!0,n.groupable??=!0,n.groupableDelay??=250,a||(a=await this.ndk.fetchEvent({kinds:[0],authors:[this.pubkey]},n)),a?(this.profile=profileFromEvent(a),s&&this.profile&&this.ndk.cacheAdapter&&this.ndk.cacheAdapter.saveProfile&&this.ndk.cacheAdapter.saveProfile(this.pubkey,this.profile),this.profile):null}follows=follows.bind(this);async followSet(n,s,a=3){const l=await this.follows(n,s,a);return new Set(Array.from(l).map(c=>c.pubkey))}tagReference(){return["p",this.pubkey]}referenceTags(n){const s=[["p",this.pubkey]];return n&&s[0].push("",n),s}async publish(){if(!this.ndk)throw new Error("No NDK instance found");if(!this.profile)throw new Error("No profile available");this.ndk.assertSigner(),await new NDKEvent(this.ndk,{kind:0,content:serializeProfile(this.profile)}).publish()}async follow(n,s,a=3){if(!this.ndk)throw new Error("No NDK instance found");if(this.ndk.assertSigner(),s||(s=await this.follows(void 0,void 0,a)),s.has(n))return!1;s.add(n);const l=new NDKEvent(this.ndk,{kind:a});for(const c of s)l.tag(c);return await l.publish(),!0}async unfollow(n,s,a=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),s||(s=await this.follows(void 0,void 0,a));const l=new Set;let c=!1;for(const y of s)y.pubkey!==n.pubkey?l.add(y):c=!0;if(!c)return!1;const h=new NDKEvent(this.ndk,{kind:a});for(const y of l)h.tag(y);return await h.publish()}async validateNip05(n){if(!this.ndk)throw new Error("No NDK instance found");const s=await getNip05For(this.ndk,n);return s===null?null:s.pubkey===this.pubkey}},READ_MARKER="read",WRITE_MARKER="write",NDKRelayList=class Eh extends NDKEvent{constructor(n,s){super(n,s),this.kind??=10002}static from(n){return new Eh(n.ndk,n.rawEvent())}get readRelayUrls(){return this.tags.filter(n=>n[0]==="r"||n[0]==="relay").filter(n=>!n[2]||n[2]&&n[2]===READ_MARKER).map(n=>tryNormalizeRelayUrl(n[1])).filter(n=>!!n)}set readRelayUrls(n){for(const s of n)this.tags.push(["r",s,READ_MARKER])}get writeRelayUrls(){return this.tags.filter(n=>n[0]==="r"||n[0]==="relay").filter(n=>!n[2]||n[2]&&n[2]===WRITE_MARKER).map(n=>tryNormalizeRelayUrl(n[1])).filter(n=>!!n)}set writeRelayUrls(n){for(const s of n)this.tags.push(["r",s,WRITE_MARKER])}get bothRelayUrls(){return this.tags.filter(n=>n[0]==="r"||n[0]==="relay").filter(n=>!n[2]).map(n=>n[1])}set bothRelayUrls(n){for(const s of n)this.tags.push(["r",s])}get relays(){return this.tags.filter(n=>n[0]==="r"||n[0]==="relay").map(n=>n[1])}get relaySet(){if(!this.ndk)throw new Error("NDKRelayList has no NDK instance");return new NDKRelaySet(new Set(this.relays.map(n=>this.ndk?.pool.getRelay(n)).filter(n=>!!n)),this.ndk)}};function relayListFromKind3(t,n){try{const s=JSON.parse(n.content),a=new NDKRelayList(t),l=new Set,c=new Set;for(let[h,y]of Object.entries(s)){try{h=normalizeRelayUrl(h)}catch{continue}if(!y)l.add(h),c.add(h);else{const g=y;g.write&&c.add(h),g.read&&l.add(h)}}return a.readRelayUrls=Array.from(l),a.writeRelayUrls=Array.from(c),a}catch{}}function disconnect(t,n){return n??=createDebug5("ndk:relay:auth-policies:disconnect"),async s=>{n?.(`Relay ${s.url} requested authentication, disconnecting`),t.removeRelay(s.url)}}async function signAndAuth(t,n,s,a,l,c){try{await t.sign(s),l(t)}catch(h){a?.(`Failed to publish auth event to relay ${n.url}`,h),c(t)}}function signIn({ndk:t,signer:n,debug:s}={}){return s??=createDebug5("ndk:auth-policies:signIn"),async(a,l)=>{s?.(`Relay ${a.url} requested authentication, signing in`);const c=new NDKEvent(t);return c.kind=22242,c.tags=[["relay",a.url],["challenge",l]],n??=t?.signer,new Promise(async(h,y)=>{n?await signAndAuth(c,a,n,s,h,y):t?.once("signer:ready",async g=>{await signAndAuth(c,a,g,s,h,y)})})}}var NDKRelayAuthPolicies={disconnect,signIn},NDKNip07Signer=class wh{_userPromise;encryptionQueue=[];encryptionProcessing=!1;debug;waitTimeout;_pubkey;ndk;_user;constructor(n=1e3,s){this.debug=createDebug5("ndk:nip07"),this.waitTimeout=n,this.ndk=s}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}async blockUntilReady(){await this.waitForExtension();const n=await window.nostr?.getPublicKey();if(!n)throw new Error("User rejected access");this._pubkey=n;let s;return this.ndk?s=this.ndk.getUser({pubkey:n}):s=new NDKUser({pubkey:n}),this._user=s,s}async user(){return this._userPromise||(this._userPromise=this.blockUntilReady()),this._userPromise}get userSync(){if(!this._user)throw new Error("User not ready");return this._user}async sign(n){await this.waitForExtension();const s=await window.nostr?.signEvent(n);if(!s)throw new Error("Failed to sign event");return s.sig}async relays(n){await this.waitForExtension();const s=await window.nostr?.getRelays?.()||{},a=[];for(const l of Object.keys(s))s[l].read&&s[l].write&&a.push(l);return a.map(l=>new NDKRelay(l,n?.relayAuthDefaultPolicy,n))}async encryptionEnabled(n){const s=[];return(!n||n==="nip04")&&window.nostr?.nip04&&s.push("nip04"),(!n||n==="nip44")&&window.nostr?.nip44&&s.push("nip44"),s}async encrypt(n,s,a="nip04"){if(!await this.encryptionEnabled(a))throw new Error(`${a}encryption is not available from your browser extension`);await this.waitForExtension();const l=n.pubkey;return this.queueEncryption(a,"encrypt",l,s)}async decrypt(n,s,a="nip04"){if(!await this.encryptionEnabled(a))throw new Error(`${a}encryption is not available from your browser extension`);await this.waitForExtension();const l=n.pubkey;return this.queueEncryption(a,"decrypt",l,s)}async queueEncryption(n,s,a,l){return new Promise((c,h)=>{this.encryptionQueue.push({scheme:n,method:s,counterpartyHexpubkey:a,value:l,resolve:c,reject:h}),this.encryptionProcessing||this.processEncryptionQueue()})}async processEncryptionQueue(n,s=0){if(!n&&this.encryptionQueue.length===0){this.encryptionProcessing=!1;return}this.encryptionProcessing=!0;const a=n||this.encryptionQueue.shift();if(!a){this.encryptionProcessing=!1;return}const{scheme:l,method:c,counterpartyHexpubkey:h,value:y,resolve:g,reject:m}=a;this.debug("Processing encryption queue item",{method:c,counterpartyHexpubkey:h,value:y});try{const b=await window.nostr?.[l]?.[c](h,y);if(!b)throw new Error("Failed to encrypt/decrypt");g(b)}catch(b){const v=b instanceof Error?b.message:String(b);if(v.includes("call already executing")&&s<5){this.debug("Retrying encryption queue item",{method:c,counterpartyHexpubkey:h,value:y,retries:s}),setTimeout(()=>{this.processEncryptionQueue(a,s+1)},50*s);return}m(b instanceof Error?b:new Error(v))}this.processEncryptionQueue()}waitForExtension(){return new Promise((n,s)=>{if(window.nostr){n();return}let a;const l=setInterval(()=>{window.nostr&&(clearTimeout(a),clearInterval(l),n())},100);a=setTimeout(()=>{clearInterval(l),s(new Error("NIP-07 extension not available"))},this.waitTimeout)})}toPayload(){return JSON.stringify({type:"nip07",payload:""})}static async fromPayload(n,s){const a=JSON.parse(n);if(a.type!=="nip07")throw new Error(`Invalid payload type: expected 'nip07', got ${a.type}`);return new wh(void 0,s)}};registerSigner("nip07",NDKNip07Signer);var NDKNostrRpc=class extends libExports.EventEmitter{ndk;signer;relaySet;debug;encryptionType="nip04";pool;constructor(t,n,s,a){if(super(),this.ndk=t,this.signer=n,a){this.pool=new NDKPool(a,[],t,{debug:s.extend("rpc-pool"),name:"Nostr RPC"}),this.relaySet=new NDKRelaySet(new Set,t,this.pool);for(const l of a){const c=this.pool.getRelay(l,!1,!1);c.authPolicy=NDKRelayAuthPolicies.signIn({ndk:t,signer:n,debug:s}),this.relaySet.addRelay(c),c.connect()}}this.debug=s.extend("rpc")}subscribe(t){const n=this.ndk.subscribe(t,{closeOnEose:!1,groupable:!1,cacheUsage:"ONLY_RELAY",pool:this.pool,relaySet:this.relaySet},!1);return n.on("event",async s=>{try{const a=await this.parseEvent(s);a.method?this.emit("request",a):(this.emit(`response-${a.id}`,a),this.emit("response",a))}catch(a){this.debug("error parsing event",a,s.rawEvent())}}),new Promise(s=>{n.on("eose",()=>{this.debug("eosed"),s(n)}),n.start()})}async parseEvent(t){this.encryptionType==="nip44"&&t.content.includes("?iv=")?this.encryptionType="nip04":this.encryptionType==="nip04"&&!t.content.includes("?iv=")&&(this.encryptionType="nip44");const n=this.ndk.getUser({pubkey:t.pubkey});n.ndk=this.ndk;let s;try{s=await this.signer.decrypt(n,t.content,this.encryptionType)}catch{const b=this.encryptionType==="nip04"?"nip44":"nip04";s=await this.signer.decrypt(n,t.content,b),this.encryptionType=b}const a=JSON.parse(s),{id:l,method:c,params:h,result:y,error:g}=a;return c?{id:l,pubkey:t.pubkey,method:c,params:h,event:t}:{id:l,result:y,error:g,event:t}}async sendResponse(t,n,s,a=24133,l){const c={id:t,result:s};l&&(c.error=l);const h=await this.signer.user(),y=this.ndk.getUser({pubkey:n}),g=new NDKEvent(this.ndk,{kind:a,content:JSON.stringify(c),tags:[["p",n]],pubkey:h.pubkey});g.content=await this.signer.encrypt(y,g.content,this.encryptionType),await g.sign(this.signer),await g.publish(this.relaySet)}async sendRequest(t,n,s=[],a=24133,l){const c=Math.random().toString(36).substring(7),h=await this.signer.user(),y=this.ndk.getUser({pubkey:t}),g={id:c,method:n,params:s},m=new Promise(()=>{const v=w=>{w.result==="auth_url"?(this.once(`response-${c}`,v),this.emit("authUrl",w.error)):l&&l(w)};this.once(`response-${c}`,v)}),b=new NDKEvent(this.ndk,{kind:a,content:JSON.stringify(g),tags:[["p",t]],pubkey:h.pubkey});return b.content=await this.signer.encrypt(y,b.content,this.encryptionType),await b.sign(this.signer),await b.publish(this.relaySet),m}};async function ndkSignerFromPayload(t,n){let s;try{s=JSON.parse(t)}catch(l){console.error("Failed to parse signer payload string",t,l);return}if(!s||typeof s.type!="string"){console.error("Failed to parse signer payload string",t,new Error("Missing type field"));return}const a=signerRegistry.get(s.type);if(!a)throw new Error(`Unknown signer type: ${s.type}`);try{return await a.fromPayload(t,n)}catch(l){const c=l instanceof Error?l.message:String(l);throw new Error(`Failed to deserialize signer type ${s.type}: ${c}`)}}function nostrConnectGenerateSecret(){return Math.random().toString(36).substring(2,15)}function generateNostrConnectUri(t,n,s,a){const l={name:a?.name?encodeURIComponent(a.name):"",url:a?.url?encodeURIComponent(a.url):"",image:a?.image?encodeURIComponent(a.image):"",perms:a?.perms?encodeURIComponent(a.perms):""};let c=`nostrconnect://${t}?image=${l.image}&url=${l.url}&name=${l.name}&perms=${l.perms}&secret=${encodeURIComponent(n)}`;return s&&(c+=`&relay=${encodeURIComponent(s)}`),c}var NDKNip46Signer=class Vs extends libExports.EventEmitter{ndk;_user;bunkerPubkey;userPubkey;get pubkey(){if(!this.userPubkey)throw new Error("Not ready");return this.userPubkey}secret;localSigner;nip05;rpc;debug;relayUrls;subscription;nostrConnectUri;nostrConnectSecret;constructor(n,s,a,l,c){super(),this.ndk=n,this.debug=n.debug.extend("nip46:signer"),this.relayUrls=l,a?typeof a=="string"?this.localSigner=new NDKPrivateKeySigner(a):this.localSigner=a:this.localSigner=NDKPrivateKeySigner.generate(),s===!1||(s?s.startsWith("bunker://")?this.bunkerFlowInit(s):this.nip05Init(s):this.nostrconnectFlowInit(c)),this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls)}static bunker(n,s,a){return new Vs(n,s,a)}static nostrconnect(n,s,a,l){return new Vs(n,void 0,a,[s],l)}nostrconnectFlowInit(n){this.nostrConnectSecret=nostrConnectGenerateSecret();const s=this.localSigner.pubkey;this.nostrConnectUri=generateNostrConnectUri(s,this.nostrConnectSecret,this.relayUrls?.[0],n)}bunkerFlowInit(n){const s=new URL(n),a=s.hostname||s.pathname.replace(/^\/\//,""),l=s.searchParams.get("pubkey"),c=s.searchParams.getAll("relay"),h=s.searchParams.get("secret");this.bunkerPubkey=a,this.userPubkey=l,this.relayUrls=c,this.secret=h}nip05Init(n){this.nip05=n}async startListening(){if(this.subscription)return;const n=await this.localSigner.user();if(!n)throw new Error("Local signer not ready");this.subscription=await this.rpc.subscribe({kinds:[24133],"#p":[n.pubkey]})}async user(){return this._user?this._user:this.blockUntilReady()}get userSync(){if(!this._user)throw new Error("Remote user not ready synchronously");return this._user}async blockUntilReadyNostrConnect(){return new Promise((n,s)=>{const a=l=>{l.result===this.nostrConnectSecret&&(this._user=l.event.author,this.userPubkey=l.event.pubkey,this.bunkerPubkey=l.event.pubkey,this.rpc.off("response",a),n(this._user))};this.startListening(),this.rpc.on("response",a)})}async blockUntilReady(){if(!this.bunkerPubkey&&!this.nostrConnectSecret&&!this.nip05)throw new Error("Bunker pubkey not set");if(this.nostrConnectSecret)return this.blockUntilReadyNostrConnect();if(this.nip05&&!this.userPubkey){const n=await NDKUser.fromNip05(this.nip05,this.ndk);n&&(this._user=n,this.userPubkey=n.pubkey,this.relayUrls=n.nip46Urls,this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls))}if(!this.bunkerPubkey&&this.userPubkey)this.bunkerPubkey=this.userPubkey;else if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");return await this.startListening(),this.rpc.on("authUrl",(...n)=>{this.emit("authUrl",...n)}),new Promise((n,s)=>{const a=[this.userPubkey??""];if(this.secret&&a.push(this.secret),!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"connect",a,24133,l=>{l.result==="ack"?this.getPublicKey().then(c=>{this.userPubkey=c,this._user=this.ndk.getUser({pubkey:c}),n(this._user)}):s(l.error)})})}stop(){this.subscription?.stop(),this.subscription=void 0}async getPublicKey(){return this.userPubkey?this.userPubkey:new Promise((n,s)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"get_public_key",[],24133,a=>{n(a.result)})})}async encryptionEnabled(n){return n?[n]:Promise.resolve(["nip04","nip44"])}async encrypt(n,s,a="nip04"){return this.encryption(n,s,a,"encrypt")}async decrypt(n,s,a="nip04"){return this.encryption(n,s,a,"decrypt")}async encryption(n,s,a,l){return new Promise((h,y)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,`${a}_${l}`,[n.pubkey,s],24133,g=>{g.error?y(g.error):h(g.result)})})}async sign(n){return new Promise((a,l)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"sign_event",[JSON.stringify(n)],24133,c=>{if(c.error)l(c.error);else{const h=JSON.parse(c.result);a(h.sig)}})})}async createAccount(n,s,a){await this.startListening();const l=[];return n&&l.push(n),s&&l.push(s),a&&l.push(a),new Promise((c,h)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"create_account",l,24133,y=>{if(y.error)h(y.error);else{const g=y.result;c(g)}})})}toPayload(){if(!this.bunkerPubkey||!this.userPubkey)throw new Error("NIP-46 signer is not fully initialized for serialization");const n={type:"nip46",payload:{bunkerPubkey:this.bunkerPubkey,userPubkey:this.userPubkey,relayUrls:this.relayUrls,secret:this.secret,localSignerPayload:this.localSigner.toPayload(),nip05:this.nip05||null}};return JSON.stringify(n)}static async fromPayload(n,s){if(!s)throw new Error("NDK instance is required to deserialize NIP-46 signer");const a=JSON.parse(n);if(a.type!=="nip46")throw new Error(`Invalid payload type: expected 'nip46', got ${a.type}`);const l=a.payload;if(!l||typeof l!="object"||!l.localSignerPayload)throw new Error("Invalid payload content for nip46 signer");const c=await ndkSignerFromPayload(l.localSignerPayload,s);if(!c)throw new Error("Failed to deserialize local signer for NIP-46");if(!(c instanceof NDKPrivateKeySigner))throw new Error("Local signer must be an instance of NDKPrivateKeySigner");let h;return h=new Vs(s,!1,c,l.relayUrls),h.userPubkey=l.userPubkey,h.bunkerPubkey=l.bunkerPubkey,h.relayUrls=l.relayUrls,h.secret=l.secret,l.userPubkey&&(h._user=new NDKUser({pubkey:l.userPubkey}),h._user&&(h._user.ndk=s)),h}};registerSigner("nip46",NDKNip46Signer);function dedup(t,n){return t.created_at>n.created_at?t:n}async function getRelayListForUser(t,n){return(await getRelayListForUsers([t],n)).get(t)}async function getRelayListForUsers(t,n,s=!1,a=1e3){const l=n.outboxPool||n.pool,c=new Set;for(const v of l.relays.values())c.add(v);const h=new Map,y=new Map,g=new NDKRelaySet(c,n);if(n.cacheAdapter?.locking&&!s){const v=await n.fetchEvents({kinds:[3,10002],authors:Array.from(new Set(t))},{cacheUsage:"ONLY_CACHE",subId:"ndk-relay-list-fetch"});for(const w of v)w.kind===10002&&h.set(w.pubkey,NDKRelayList.from(w));for(const w of v)if(w.kind===3){if(h.has(w.pubkey))continue;const S=relayListFromKind3(n,w);S&&y.set(w.pubkey,S)}t=t.filter(w=>!h.has(w)&&!y.has(w))}if(t.length===0)return h;const m=new Map,b=new Map;return new Promise(v=>{(async()=>{const S={closeOnEose:!0,pool:l,groupable:!0,subId:"ndk-relay-list-fetch",addSinceFromCache:!0,relaySet:g};g&&(S.relaySet=g),n.subscribe({kinds:[3,10002],authors:t},S,{onEvent:A=>{if(A.kind===10002){const B=m.get(A.pubkey);if(B&&B.created_at>A.created_at)return;m.set(A.pubkey,A)}else if(A.kind===3){const B=b.get(A.pubkey);if(B&&B.created_at>A.created_at)return;b.set(A.pubkey,A)}},onEose:()=>{for(const A of m.values())h.set(A.pubkey,NDKRelayList.from(A));for(const A of t){if(h.has(A))continue;const B=b.get(A);if(!B)continue;const N=relayListFromKind3(n,B);N&&h.set(A,N)}v(h)}}),setTimeout(()=>{v(h)},a)})()})}var OutboxItem=class{type;relayUrlScores;readRelays;writeRelays;constructor(t){this.type=t,this.relayUrlScores=new Map,this.readRelays=new Set,this.writeRelays=new Set}},OutboxTracker=class extends libExports.EventEmitter{data;ndk;debug;constructor(t){super(),this.ndk=t,this.debug=t.debug.extend("outbox-tracker"),this.data=new distExports.LRUCache({maxSize:1e5,entryExpirationTimeInMS:120*1e3})}async trackUsers(t,n=!1){const s=[];for(let a=0;a<t.length;a+=400){const c=t.slice(a,a+400).map(h=>getKeyFromItem(h)).filter(h=>!this.data.has(h));if(c.length!==0){for(const h of c)this.data.set(h,new OutboxItem("user"));s.push(new Promise(h=>{getRelayListForUsers(c,this.ndk,n).then(y=>{for(const[g,m]of y){let b=this.data.get(g);if(b??=new OutboxItem("user"),m){b.readRelays=new Set(normalize(m.readRelayUrls)),b.writeRelays=new Set(normalize(m.writeRelayUrls));for(const v of b.readRelays)this.ndk.pool.blacklistRelayUrls.has(v)&&b.readRelays.delete(v);for(const v of b.writeRelays)this.ndk.pool.blacklistRelayUrls.has(v)&&b.writeRelays.delete(v);this.data.set(g,b)}}}).finally(h)}))}}return Promise.all(s)}track(t,n,s=!0){const a=getKeyFromItem(t);n??=getTypeFromItem(t);let l=this.data.get(a);return l||(l=new OutboxItem(n),t instanceof NDKUser&&this.trackUsers([t])),l}};function getKeyFromItem(t){return t instanceof NDKUser?t.pubkey:t}function getTypeFromItem(t){return t instanceof NDKUser?"user":"kind"}function correctRelaySet(t,n){const s=n.connectedRelays();if(!Array.from(t.relays).some(l=>s.map(c=>c.url).includes(l.url)))for(const l of s)t.addRelay(l);if(s.length===0)for(const l of n.relays.values())t.addRelay(l);return t}var NDKSubscriptionManager=class{subscriptions;seenEvents=new Map;constructor(){this.subscriptions=new Map}add(t){this.subscriptions.set(t.internalId,t),t.onStopped,t.onStopped=()=>{this.subscriptions.delete(t.internalId)},t.on("close",()=>{this.subscriptions.delete(t.internalId)})}seenEvent(t,n){const s=this.seenEvents.get(t)||[];s.push(n),this.seenEvents.set(t,s)}dispatchEvent(t,n,s=!1){n&&this.seenEvent(t.id,n);const a=this.subscriptions.values(),l=[];for(const c of a)matchFilters(c.filters,t)&&l.push(c);for(const c of l)c.eventReceived(t,n,!1,s)}},debug7=createDebug5("ndk:active-user");async function getUserRelayList(t){if(!this.autoConnectUserRelays)return;const n=await getRelayListForUser(t.pubkey,this);if(n){for(const s of n.relays){let a=this.pool.relays.get(s);a||(a=new NDKRelay(s,this.relayAuthDefaultPolicy,this),this.pool.addRelay(a))}return n}}async function setActiveUser(t){const n=this.outboxPool||this.pool;n.connectedRelays.length>0?setActiveUserConnected.call(this,t):n.once("connect",()=>{setActiveUserConnected.call(this,t)})}async function setActiveUserConnected(t){const n=await getUserRelayList.call(this,t),s=[{kinds:[10006],authors:[t.pubkey]}];this.autoFetchUserMutelist&&s[0].kinds?.push(1e4);const a=new Map,l=n?n.relaySet:void 0;this.subscribe(s,{subId:"active-user-settings",closeOnEose:!0,relaySet:l},{onEvent:c=>{const h=a.get(c.kind);h&&h.created_at>=c.created_at||a.set(c.kind,c)},onEose:()=>{for(const c of a.values())processEvent.call(this,c)}})}async function processEvent(t){t.kind===10006?processBlockRelayList.call(this,t):t.kind===1e4&&processMuteList.call(this,t)}function processBlockRelayList(t){const n=lists_default.from(t);for(const s of n.items)this.pool.blacklistRelayUrls.add(s[0]);debug7("Added %d relays to relay blacklist",n.items.length)}function processMuteList(t){const n=lists_default.from(t);for(const s of n.items)this.mutedIds.set(s[1],s[0]);debug7("Added %d users to mute list",n.items.length)}function getEntity(t){try{const n=nip19_exports.decode(t);return n.type==="npub"?npub(this,n.data):n.type==="nprofile"?nprofile(this,n.data):n}catch{return null}}function npub(t,n){return t.getUser({pubkey:n})}function nprofile(t,n){const s=t.getUser({pubkey:n.pubkey});return n.relays&&(s.relayUrls=n.relays),s}function isValidHint(t){if(!t||t==="")return!1;try{return new URL(t),!0}catch{return!1}}async function fetchEventFromTag(t,n,s,a={type:"timeout"}){const l=this.debug.extend("fetch-event-from-tag"),[c,h,y]=t;s={},l("fetching event from tag",t,s,a);const g=getRelaysForSync(this,n.pubkey);if(g&&g.size>0){l("fetching event from author relays %o",Array.from(g));const B=NDKRelaySet.fromRelayUrls(Array.from(g),this),N=await this.fetchEvent(h,s,B);if(N)return N}else l("no author relays found for %s",n.pubkey,n);const m=calculateRelaySetsFromFilters(this,[{ids:[h]}],this.pool);l("fetching event without relay hint",m);const b=await this.fetchEvent(h,s);if(b)return b;if(y&&y!==""){const B=await this.fetchEvent(h,s,this.pool.getRelay(y,!0,!0,[{ids:[h]}]));if(B)return B}let v;const w=isValidHint(y)?this.pool.getRelay(y,!1,!0,[{ids:[h]}]):void 0,S=new Promise(B=>{this.fetchEvent(h,s,w).then(B)});if(!isValidHint(y)||a.type==="none")return S;const A=new Promise(async B=>{const N=a.relaySet,L=a.timeout??1500,G=new Promise(V=>setTimeout(V,L));if(a.type==="timeout"&&await G,v)B(v);else{l("fallback fetch triggered");const V=await this.fetchEvent(h,s,N);B(V)}});switch(a.type){case"timeout":return Promise.race([S,A]);case"eose":return v=await S,v||A}}var Queue=class{queue=[];maxConcurrency;processing=new Set;promises=new Map;constructor(t,n){this.maxConcurrency=n}add(t){if(this.promises.has(t.id))return this.promises.get(t.id);const n=new Promise((s,a)=>{this.queue.push({...t,func:()=>t.func().then(l=>(s(l),l),l=>{throw a(l),l})}),this.process()});return this.promises.set(t.id,n),n.finally(()=>{this.promises.delete(t.id),this.processing.delete(t.id),this.process()}),n}process(){if(this.processing.size>=this.maxConcurrency||this.queue.length===0)return;const t=this.queue.shift();!t||this.processing.has(t.id)||(this.processing.add(t.id),t.func())}clear(){this.queue=[]}clearProcessing(){this.processing.clear()}clearAll(){this.clear(),this.clearProcessing()}length(){return this.queue.length}},DEFAULT_OUTBOX_RELAYS=["wss://purplepag.es/","wss://nos.lol/"],DEFAULT_BLACKLISTED_RELAYS=["wss://brb.io/","wss://nostr.mutinywallet.com/"],NDK=class extends libExports.EventEmitter{_explicitRelayUrls;blacklistRelayUrls;pool;outboxPool;_signer;_activeUser;cacheAdapter;debug;devWriteRelaySet;outboxTracker;mutedIds;clientName;clientNip89;queuesZapConfig;queuesNip05;asyncSigVerification=!1;initialValidationRatio=1;lowestValidationRatio=.1;validationRatioFn;autoBlacklistInvalidRelays=!1;subManager;_signatureVerificationFunction;_signatureVerificationWorker;signatureVerificationTimeMs=0;publishingFailureHandled=!1;pools=[];relayAuthDefaultPolicy;httpFetch;netDebug;autoConnectUserRelays=!0;autoFetchUserMutelist=!0;walletConfig;constructor(t={}){super(),this.debug=t.debug||createDebug5("ndk"),this.netDebug=t.netDebug,this._explicitRelayUrls=t.explicitRelayUrls||[],this.blacklistRelayUrls=t.blacklistRelayUrls||DEFAULT_BLACKLISTED_RELAYS,this.subManager=new NDKSubscriptionManager,this.pool=new NDKPool(t.explicitRelayUrls||[],[],this),this.pool.name="Main",this.pool.on("relay:auth",async(n,s)=>{this.relayAuthDefaultPolicy&&await this.relayAuthDefaultPolicy(n,s)}),this.autoConnectUserRelays=t.autoConnectUserRelays??!0,this.autoFetchUserMutelist=t.autoFetchUserMutelist??!0,this.clientName=t.clientName,this.clientNip89=t.clientNip89,this.relayAuthDefaultPolicy=t.relayAuthDefaultPolicy,t.enableOutboxModel&&(this.outboxPool=new NDKPool(t.outboxRelayUrls||DEFAULT_OUTBOX_RELAYS,[],this,{debug:this.debug.extend("outbox-pool"),name:"Outbox Pool"}),this.outboxTracker=new OutboxTracker(this)),this.signer=t.signer,this.cacheAdapter=t.cacheAdapter,this.mutedIds=t.mutedIds||new Map,t.devWriteRelayUrls&&(this.devWriteRelaySet=NDKRelaySet.fromRelayUrls(t.devWriteRelayUrls,this)),this.queuesZapConfig=new Queue("zaps",3),this.queuesNip05=new Queue("nip05",10),t.signatureVerificationWorker&&(this.signatureVerificationWorker=t.signatureVerificationWorker),t.signatureVerificationFunction&&(this.signatureVerificationFunction=t.signatureVerificationFunction),this.initialValidationRatio=t.initialValidationRatio||1,this.lowestValidationRatio=t.lowestValidationRatio||.1,this.autoBlacklistInvalidRelays=t.autoBlacklistInvalidRelays||!1,this.validationRatioFn=t.validationRatioFn||this.defaultValidationRatioFn;try{this.httpFetch=fetch}catch{}}set explicitRelayUrls(t){this._explicitRelayUrls=t.map(normalizeRelayUrl),this.pool.relayUrls=t}get explicitRelayUrls(){return this._explicitRelayUrls||[]}set signatureVerificationWorker(t){this._signatureVerificationWorker=t,t?(signatureVerificationInit(t),this.asyncSigVerification=!0):this.asyncSigVerification=!1}set signatureVerificationFunction(t){this._signatureVerificationFunction=t,this.asyncSigVerification=!!t}get signatureVerificationFunction(){return this._signatureVerificationFunction}addExplicitRelay(t,n,s=!0){let a;return typeof t=="string"?a=new NDKRelay(t,n,this):a=t,this.pool.addRelay(a,s),this.explicitRelayUrls?.push(a.url),a}toJSON(){return{relayCount:this.pool.relays.size}.toString()}get activeUser(){return this._activeUser}set activeUser(t){const n=this._activeUser?.pubkey!==t?.pubkey;this._activeUser=t,t&&n?setActiveUser.call(this,t):t||(this.mutedIds=new Map)}get signer(){return this._signer}set signer(t){this._signer=t,t&&this.emit("signer:ready",t),t?.user().then(n=>{n.ndk=this,this.activeUser=n})}async connect(t){this._signer&&this.autoConnectUserRelays&&(this.debug("Attempting to connect to user relays specified by signer %o",await this._signer.relays?.(this)),this._signer.relays&&(await this._signer.relays(this)).forEach(a=>this.pool.addRelay(a)));const n=[this.pool.connect(t)];return this.outboxPool&&n.push(this.outboxPool.connect(t)),Promise.allSettled(n).then(()=>{})}reportInvalidSignature(t,n){this.debug(`Invalid signature detected for event ${t.id}${n?` from relay ${n.url}`:""}`),this.emit("event:invalid-sig",t,n),this.autoBlacklistInvalidRelays&&n&&this.blacklistRelay(n.url)}blacklistRelay(t){if(this.blacklistRelayUrls||(this.blacklistRelayUrls=[]),!this.blacklistRelayUrls.includes(t)){this.blacklistRelayUrls.push(t),this.debug(`Added relay to blacklist: ${t}`);const n=this.pool.getRelay(t,!1,!1);n&&(n.disconnect(),this.debug(`Disconnected from blacklisted relay: ${t}`))}}defaultValidationRatioFn(t,n,s){if(n<10)return this.initialValidationRatio;const a=Math.min(n/100,1),l=this.initialValidationRatio*(1-a)+this.lowestValidationRatio*a;return Math.max(l,this.lowestValidationRatio)}getUser(t){const n=new NDKUser(t);return n.ndk=this,n}async getUserFromNip05(t,n=!1){return NDKUser.fromNip05(t,this,n)}subscribe(t,n,s=!0,a=!0){let l=n?.relaySet,c=a;s instanceof NDKRelaySet?(console.warn("relaySet is deprecated, use opts.relaySet instead. This will be removed in version v2.14.0"),l=s,c=a):(typeof s=="boolean"||typeof s=="object")&&(c=s);const h=new NDKSubscription(this,t,{relaySet:l,...n});this.subManager.add(h);const y=h.pool;if(h.relaySet)for(const g of h.relaySet.relays)y.useTemporaryRelay(g,void 0,h.filters);if(this.outboxPool&&h.hasAuthorsFilter()){const g=h.filters.filter(m=>m.authors&&m.authors?.length>0).flatMap(m=>m.authors);this.outboxTracker?.trackUsers(g)}if(c){let g;typeof c=="object"&&(c.onEvent&&h.on("event",c.onEvent),c.onEose&&h.on("eose",c.onEose),c.onEvents&&(g=c.onEvents)),setTimeout(()=>{const m=h.start(!g);m&&m.length>0&&g&&g(m)},0)}return h}fetchEventFromTag=fetchEventFromTag.bind(this);fetchEventSync(t){if(!this.cacheAdapter)throw new Error("Cache adapter not set");let n;typeof t=="string"?n=[filterFromId(t)]:n=t;const s=new NDKSubscription(this,n),a=this.cacheAdapter.query(s);if(a instanceof Promise)throw new Error("Cache adapter is async");return a.map(l=>(l.ndk=this,l))}async fetchEvent(t,n,s){let a,l;if(s instanceof NDKRelay?l=new NDKRelaySet(new Set([s]),this):s instanceof NDKRelaySet&&(l=s),!s&&typeof t=="string"&&!isNip33AValue(t)){const c=relaysFromBech32(t,this);c.length>0&&(l=new NDKRelaySet(new Set(c),this),l=correctRelaySet(l,this.pool))}if(typeof t=="string"?a=[filterFromId(t)]:Array.isArray(t)?a=t:a=[t],a.length===0)throw new Error(`Invalid filter: ${JSON.stringify(t)}`);return new Promise(c=>{let h=null;const y={...n||{},closeOnEose:!0};l&&(y.relaySet=l);const g=this.subscribe(a,y,!1),m=setTimeout(()=>{g.stop(),c(h)},1e4);g.on("event",b=>{b.ndk=this,b.isReplaceable()?(!h||h.created_at<b.created_at)&&(h=b):(clearTimeout(m),c(b))}),g.on("eose",()=>{clearTimeout(m),c(h)}),g.start()})}async fetchEvents(t,n,s){return new Promise(a=>{const l=new Map,c={...n||{},closeOnEose:!0};s&&(c.relaySet=s);const h=this.subscribe(t,c,!1),y=g=>{let m;g instanceof NDKEvent?m=g:m=new NDKEvent(void 0,g);const b=m.deduplicationKey(),v=l.get(b);v&&(m=dedup(v,m)),m.ndk=this,l.set(b,m)};h.on("event",y),h.on("eose",()=>{a(new Set(l.values()))}),h.start()})}assertSigner(){if(!this.signer)throw this.emit("signer:required"),new Error("Signer required")}getEntity=getEntity.bind(this);set wallet(t){if(!t){this.walletConfig=void 0;return}this.walletConfig??={},this.walletConfig.lnPay=t?.lnPay?.bind(t),this.walletConfig.cashuPay=t?.cashuPay?.bind(t)}};createDebug5("ndk:zapper:ln");createDebug5("ndk:zapper");const ndk=new NDK({explicitRelayUrls:["wss://relay.damus.io","wss://relay.primal.net","wss://nos.lol","wss://relay.snort.social","wss://nostr.wine","wss://relay.nostr.band"]});/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(t={}){function n(a,l){let{pathname:c,search:h,hash:y}=a.location;return createLocation("",{pathname:c,search:h,hash:y},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function s(a,l){return typeof l=="string"?l:createPath(l)}return getUrlBasedHistory(n,s,null,t)}function invariant(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function warning(t,n){if(!t){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(t,n){return{usr:t.state,key:t.key,idx:n}}function createLocation(t,n,s=null,a){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof n=="string"?parsePath(n):n,state:s,key:n&&n.key||a||createKey()}}function createPath({pathname:t="/",search:n="",hash:s=""}){return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function parsePath(t){let n={};if(t){let s=t.indexOf("#");s>=0&&(n.hash=t.substring(s),t=t.substring(0,s));let a=t.indexOf("?");a>=0&&(n.search=t.substring(a),t=t.substring(0,a)),t&&(n.pathname=t)}return n}function getUrlBasedHistory(t,n,s,a={}){let{window:l=document.defaultView,v5Compat:c=!1}=a,h=l.history,y="POP",g=null,m=b();m==null&&(m=0,h.replaceState({...h.state,idx:m},""));function b(){return(h.state||{idx:null}).idx}function v(){y="POP";let N=b(),L=N==null?null:N-m;m=N,g&&g({action:y,location:B.location,delta:L})}function w(N,L){y="PUSH";let G=createLocation(B.location,N,L);m=b()+1;let V=getHistoryState(G,m),ie=B.createHref(G);try{h.pushState(V,"",ie)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;l.location.assign(ie)}c&&g&&g({action:y,location:B.location,delta:1})}function S(N,L){y="REPLACE";let G=createLocation(B.location,N,L);m=b();let V=getHistoryState(G,m),ie=B.createHref(G);h.replaceState(V,"",ie),c&&g&&g({action:y,location:B.location,delta:0})}function A(N){return createBrowserURLImpl(N)}let B={get action(){return y},get location(){return t(l,h)},listen(N){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(PopStateEventType,v),g=N,()=>{l.removeEventListener(PopStateEventType,v),g=null}},createHref(N){return n(l,N)},createURL:A,encodeLocation(N){let L=A(N);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:w,replace:S,go(N){return h.go(N)}};return B}function createBrowserURLImpl(t,n=!1){let s="http://localhost";typeof window<"u"&&(s=window.location.origin!=="null"?window.location.origin:window.location.href),invariant(s,"No window.location.(origin|href) available to create URL");let a=typeof t=="string"?t:createPath(t);return a=a.replace(/ $/,"%20"),!n&&a.startsWith("//")&&(a=s+a),new URL(a,s)}function matchRoutes(t,n,s="/"){return matchRoutesImpl(t,n,s,!1)}function matchRoutesImpl(t,n,s,a){let l=typeof n=="string"?parsePath(n):n,c=stripBasename(l.pathname||"/",s);if(c==null)return null;let h=flattenRoutes(t);rankRouteBranches(h);let y=null;for(let g=0;y==null&&g<h.length;++g){let m=decodePath(c);y=matchRouteBranch(h[g],m,a)}return y}function flattenRoutes(t,n=[],s=[],a="",l=!1){let c=(h,y,g=l,m)=>{let b={relativePath:m===void 0?h.path||"":m,caseSensitive:h.caseSensitive===!0,childrenIndex:y,route:h};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(a)&&g)return;invariant(b.relativePath.startsWith(a),`Absolute route path "${b.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(a.length)}let v=joinPaths([a,b.relativePath]),w=s.concat(b);h.children&&h.children.length>0&&(invariant(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),flattenRoutes(h.children,n,w,v,g)),!(h.path==null&&!h.index)&&n.push({path:v,score:computeScore(v,h.index),routesMeta:w})};return t.forEach((h,y)=>{if(h.path===""||!h.path?.includes("?"))c(h,y);else for(let g of explodeOptionalSegments(h.path))c(h,y,!0,g)}),n}function explodeOptionalSegments(t){let n=t.split("/");if(n.length===0)return[];let[s,...a]=n,l=s.endsWith("?"),c=s.replace(/\?$/,"");if(a.length===0)return l?[c,""]:[c];let h=explodeOptionalSegments(a.join("/")),y=[];return y.push(...h.map(g=>g===""?c:[c,g].join("/"))),l&&y.push(...h),y.map(g=>t.startsWith("/")&&g===""?"/":g)}function rankRouteBranches(t){t.sort((n,s)=>n.score!==s.score?s.score-n.score:compareIndexes(n.routesMeta.map(a=>a.childrenIndex),s.routesMeta.map(a=>a.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=t=>t==="*";function computeScore(t,n){let s=t.split("/"),a=s.length;return s.some(isSplat)&&(a+=splatPenalty),n&&(a+=indexRouteValue),s.filter(l=>!isSplat(l)).reduce((l,c)=>l+(paramRe.test(c)?dynamicSegmentValue:c===""?emptySegmentValue:staticSegmentValue),a)}function compareIndexes(t,n){return t.length===n.length&&t.slice(0,-1).every((a,l)=>a===n[l])?t[t.length-1]-n[n.length-1]:0}function matchRouteBranch(t,n,s=!1){let{routesMeta:a}=t,l={},c="/",h=[];for(let y=0;y<a.length;++y){let g=a[y],m=y===a.length-1,b=c==="/"?n:n.slice(c.length)||"/",v=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},b),w=g.route;if(!v&&m&&s&&!a[a.length-1].route.index&&(v=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},b)),!v)return null;Object.assign(l,v.params),h.push({params:l,pathname:joinPaths([c,v.pathname]),pathnameBase:normalizePathname(joinPaths([c,v.pathnameBase])),route:w}),v.pathnameBase!=="/"&&(c=joinPaths([c,v.pathnameBase]))}return h}function matchPath(t,n){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,a]=compilePath(t.path,t.caseSensitive,t.end),l=n.match(s);if(!l)return null;let c=l[0],h=c.replace(/(.)\/+$/,"$1"),y=l.slice(1);return{params:a.reduce((m,{paramName:b,isOptional:v},w)=>{if(b==="*"){let A=y[w]||"";h=c.slice(0,c.length-A.length).replace(/(.)\/+$/,"$1")}const S=y[w];return v&&!S?m[b]=void 0:m[b]=(S||"").replace(/%2F/g,"/"),m},{}),pathname:c,pathnameBase:h,pattern:t}}function compilePath(t,n=!1,s=!0){warning(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let a=[],l="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,y,g)=>(a.push({paramName:y,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(a.push({paramName:"*"}),l+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?l+="\\/*$":t!==""&&t!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,n?void 0:"i"),a]}function decodePath(t){try{return t.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return warning(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),t}}function stripBasename(t,n){if(n==="/")return t;if(!t.toLowerCase().startsWith(n.toLowerCase()))return null;let s=n.endsWith("/")?n.length-1:n.length,a=t.charAt(s);return a&&a!=="/"?null:t.slice(s)||"/"}function resolvePath(t,n="/"){let{pathname:s,search:a="",hash:l=""}=typeof t=="string"?parsePath(t):t;return{pathname:s?s.startsWith("/")?s:resolvePathname(s,n):n,search:normalizeSearch(a),hash:normalizeHash(l)}}function resolvePathname(t,n){let s=n.replace(/\/+$/,"").split("/");return t.split("/").forEach(l=>{l===".."?s.length>1&&s.pop():l!=="."&&s.push(l)}),s.length>1?s.join("/"):"/"}function getInvalidPathError(t,n,s,a){return`Cannot include a '${t}' character in a manually specified \`to.${n}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(t){return t.filter((n,s)=>s===0||n.route.path&&n.route.path.length>0)}function getResolveToMatches(t){let n=getPathContributingMatches(t);return n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase)}function resolveTo(t,n,s,a=!1){let l;typeof t=="string"?l=parsePath(t):(l={...t},invariant(!l.pathname||!l.pathname.includes("?"),getInvalidPathError("?","pathname","search",l)),invariant(!l.pathname||!l.pathname.includes("#"),getInvalidPathError("#","pathname","hash",l)),invariant(!l.search||!l.search.includes("#"),getInvalidPathError("#","search","hash",l)));let c=t===""||l.pathname==="",h=c?"/":l.pathname,y;if(h==null)y=s;else{let v=n.length-1;if(!a&&h.startsWith("..")){let w=h.split("/");for(;w[0]==="..";)w.shift(),v-=1;l.pathname=w.join("/")}y=v>=0?n[v]:"/"}let g=resolvePath(l,y),m=h&&h!=="/"&&h.endsWith("/"),b=(c||h===".")&&s.endsWith("/");return!g.pathname.endsWith("/")&&(m||b)&&(g.pathname+="/"),g}var joinPaths=t=>t.join("/").replace(/\/\/+/g,"/"),normalizePathname=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,normalizeHash=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function isRouteErrorResponse(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";reactExports.createContext(!1);var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(t,{relative:n}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:a}=reactExports.useContext(NavigationContext),{hash:l,pathname:c,search:h}=useResolvedPath(t,{relative:n}),y=c;return s!=="/"&&(y=c==="/"?s:joinPaths([s,c])),a.createHref({pathname:y,search:h,hash:l})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(t){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(t)}function useNavigate(){let{isDataRoute:t}=reactExports.useContext(RouteContext);return t?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let t=reactExports.useContext(DataRouterContext),{basename:n,navigator:s}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),{pathname:l}=useLocation(),c=JSON.stringify(getResolveToMatches(a)),h=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{h.current=!0}),reactExports.useCallback((g,m={})=>{if(warning(h.current,navigateEffectWarning),!h.current)return;if(typeof g=="number"){s.go(g);return}let b=resolveTo(g,JSON.parse(c),l,m.relative==="path");t==null&&n!=="/"&&(b.pathname=b.pathname==="/"?n:joinPaths([n,b.pathname])),(m.replace?s.replace:s.push)(b,m.state,m)},[n,s,c,l,t])}reactExports.createContext(null);function useParams(){let{matches:t}=reactExports.useContext(RouteContext),n=t[t.length-1];return n?n.params:{}}function useResolvedPath(t,{relative:n}={}){let{matches:s}=reactExports.useContext(RouteContext),{pathname:a}=useLocation(),l=JSON.stringify(getResolveToMatches(s));return reactExports.useMemo(()=>resolveTo(t,JSON.parse(l),a,n==="path"),[t,l,a,n])}function useRoutes(t,n){return useRoutesImpl(t,n)}function useRoutesImpl(t,n,s,a,l){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=reactExports.useContext(NavigationContext),{matches:h}=reactExports.useContext(RouteContext),y=h[h.length-1],g=y?y.params:{},m=y?y.pathname:"/",b=y?y.pathnameBase:"/",v=y&&y.route;{let G=v&&v.path||"";warningOnce(m,!v||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let w=useLocation(),S;if(n){let G=typeof n=="string"?parsePath(n):n;invariant(b==="/"||G.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${G.pathname}" was given in the \`location\` prop.`),S=G}else S=w;let A=S.pathname||"/",B=A;if(b!=="/"){let G=b.replace(/^\//,"").split("/");B="/"+A.replace(/^\//,"").split("/").slice(G.length).join("/")}let N=matchRoutes(t,{pathname:B});warning(v||N!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),warning(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let L=_renderMatches(N&&N.map(G=>Object.assign({},G,{params:Object.assign({},g,G.params),pathname:joinPaths([b,c.encodeLocation?c.encodeLocation(G.pathname).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?b:joinPaths([b,c.encodeLocation?c.encodeLocation(G.pathnameBase).pathname:G.pathnameBase])})),h,s,a,l);return n&&L?reactExports.createElement(LocationContext.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},L):L}function DefaultErrorComponent(){let t=useRouteError(),n=isRouteErrorResponse(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,a="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:a},c={padding:"2px 4px",backgroundColor:a},h=null;return console.error("Error handled by React Router default ErrorBoundary:",t),h=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null,"💿 Hey developer 👋"),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:c},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:c},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},n),s?reactExports.createElement("pre",{style:l},s):null,h)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){this.props.unstable_onError?this.props.unstable_onError(t,n):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:t,match:n,children:s}){let a=reactExports.useContext(DataRouterContext);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),reactExports.createElement(RouteContext.Provider,{value:t},s)}function _renderMatches(t,n=[],s=null,a=null,l=null){if(t==null){if(!s)return null;if(s.errors)t=s.matches;else if(n.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let c=t,h=s?.errors;if(h!=null){let m=c.findIndex(b=>b.route.id&&h?.[b.route.id]!==void 0);invariant(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),c=c.slice(0,Math.min(c.length,m+1))}let y=!1,g=-1;if(s)for(let m=0;m<c.length;m++){let b=c[m];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(g=m),b.route.id){let{loaderData:v,errors:w}=s,S=b.route.loader&&!v.hasOwnProperty(b.route.id)&&(!w||w[b.route.id]===void 0);if(b.route.lazy||S){y=!0,g>=0?c=c.slice(0,g+1):c=[c[0]];break}}}return c.reduceRight((m,b,v)=>{let w,S=!1,A=null,B=null;s&&(w=h&&b.route.id?h[b.route.id]:void 0,A=b.route.errorElement||defaultErrorElement,y&&(g<0&&v===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,B=null):g===v&&(S=!0,B=b.route.hydrateFallbackElement||null)));let N=n.concat(c.slice(0,v+1)),L=()=>{let G;return w?G=A:S?G=B:b.route.Component?G=reactExports.createElement(b.route.Component,null):b.route.element?G=b.route.element:G=m,reactExports.createElement(RenderedRoute,{match:b,routeContext:{outlet:m,matches:N,isDataRoute:s!=null},children:G})};return s&&(b.route.ErrorBoundary||b.route.errorElement||v===0)?reactExports.createElement(RenderErrorBoundary,{location:s.location,revalidation:s.revalidation,component:A,error:w,children:L(),routeContext:{outlet:null,matches:N,isDataRoute:!0},unstable_onError:a}):L()},null)}function getDataRouterConsoleError(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(t){let n=reactExports.useContext(DataRouterContext);return invariant(n,getDataRouterConsoleError(t)),n}function useDataRouterState(t){let n=reactExports.useContext(DataRouterStateContext);return invariant(n,getDataRouterConsoleError(t)),n}function useRouteContext(t){let n=reactExports.useContext(RouteContext);return invariant(n,getDataRouterConsoleError(t)),n}function useCurrentRouteId(t){let n=useRouteContext(t),s=n.matches[n.matches.length-1];return invariant(s.route.id,`${t} can only be used on routes that contain a unique "id"`),s.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){let t=reactExports.useContext(RouteErrorContext),n=useDataRouterState("useRouteError"),s=useCurrentRouteId("useRouteError");return t!==void 0?t:n.errors?.[s]}function useNavigateStable(){let{router:t}=useDataRouterContext("useNavigate"),n=useCurrentRouteId("useNavigate"),s=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{s.current=!0}),reactExports.useCallback(async(l,c={})=>{warning(s.current,navigateEffectWarning),s.current&&(typeof l=="number"?t.navigate(l):await t.navigate(l,{fromRouteId:n,...c}))},[t,n])}var alreadyWarned={};function warningOnce(t,n,s){!n&&!alreadyWarned[t]&&(alreadyWarned[t]=!0,warning(!1,s))}reactExports.memo(DataRoutes);function DataRoutes({routes:t,future:n,state:s,unstable_onError:a}){return useRoutesImpl(t,void 0,s,a,n)}function Route(t){invariant(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:t="/",children:n=null,location:s,navigationType:a="POP",navigator:l,static:c=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=t.replace(/^\/*/,"/"),y=reactExports.useMemo(()=>({basename:h,navigator:l,static:c,future:{}}),[h,l,c]);typeof s=="string"&&(s=parsePath(s));let{pathname:g="/",search:m="",hash:b="",state:v=null,key:w="default"}=s,S=reactExports.useMemo(()=>{let A=stripBasename(g,h);return A==null?null:{location:{pathname:A,search:m,hash:b,state:v,key:w},navigationType:a}},[h,g,m,b,v,w,a]);return warning(S!=null,`<Router basename="${h}"> is not able to match the URL "${g}${m}${b}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:reactExports.createElement(NavigationContext.Provider,{value:y},reactExports.createElement(LocationContext.Provider,{children:n,value:S}))}function Routes({children:t,location:n}){return useRoutes(createRoutesFromChildren(t),n)}function createRoutesFromChildren(t,n=[]){let s=[];return reactExports.Children.forEach(t,(a,l)=>{if(!reactExports.isValidElement(a))return;let c=[...n,l];if(a.type===reactExports.Fragment){s.push.apply(s,createRoutesFromChildren(a.props.children,c));return}invariant(a.type===Route,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant(!a.props.index||!a.props.children,"An index route cannot have child routes.");let h={id:a.props.id||c.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(h.children=createRoutesFromChildren(a.props.children,c)),s.push(h)}),s}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(t){return t!=null&&typeof t.tagName=="string"}function isButtonElement(t){return isHtmlElement(t)&&t.tagName.toLowerCase()==="button"}function isFormElement(t){return isHtmlElement(t)&&t.tagName.toLowerCase()==="form"}function isInputElement(t){return isHtmlElement(t)&&t.tagName.toLowerCase()==="input"}function isModifiedEvent(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function shouldProcessLinkClick(t,n){return t.button===0&&(!n||n==="_self")&&!isModifiedEvent(t)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(t){return t!=null&&!supportedFormEncTypes.has(t)?(warning(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):t}function getFormSubmissionInfo(t,n){let s,a,l,c,h;if(isFormElement(t)){let y=t.getAttribute("action");a=y?stripBasename(y,n):null,s=t.getAttribute("method")||defaultMethod,l=getFormEncType(t.getAttribute("enctype"))||defaultEncType,c=new FormData(t)}else if(isButtonElement(t)||isInputElement(t)&&(t.type==="submit"||t.type==="image")){let y=t.form;if(y==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=t.getAttribute("formaction")||y.getAttribute("action");if(a=g?stripBasename(g,n):null,s=t.getAttribute("formmethod")||y.getAttribute("method")||defaultMethod,l=getFormEncType(t.getAttribute("formenctype"))||getFormEncType(y.getAttribute("enctype"))||defaultEncType,c=new FormData(y,t),!isFormDataSubmitterSupported()){let{name:m,type:b,value:v}=t;if(b==="image"){let w=m?`${m}.`:"";c.append(`${w}x`,"0"),c.append(`${w}y`,"0")}else m&&c.append(m,v)}}else{if(isHtmlElement(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=defaultMethod,a=null,l=defaultEncType,h=t}return c&&l==="text/plain"&&(h=c,c=void 0),{action:a,method:s.toLowerCase(),encType:l,formData:c,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function invariant2(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function singleFetchUrl(t,n,s){let a=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return a.pathname==="/"?a.pathname=`_root.${s}`:n&&stripBasename(a.pathname,n)==="/"?a.pathname=`${n.replace(/\/$/,"")}/_root.${s}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${s}`,a}async function loadRouteModule(t,n){if(t.id in n)return n[t.id];try{let s=await import(t.module);return n[t.id]=s,s}catch(s){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function getKeyedPrefetchLinks(t,n,s){let a=await Promise.all(t.map(async l=>{let c=n.routes[l.route.id];if(c){let h=await loadRouteModule(c,s);return h.links?h.links():[]}return[]}));return dedupeLinkDescriptors(a.flat(1).filter(isHtmlLinkDescriptor).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function getNewMatchesForLinks(t,n,s,a,l,c){let h=(g,m)=>s[m]?g.route.id!==s[m].route.id:!0,y=(g,m)=>s[m].pathname!==g.pathname||s[m].route.path?.endsWith("*")&&s[m].params["*"]!==g.params["*"];return c==="assets"?n.filter((g,m)=>h(g,m)||y(g,m)):c==="data"?n.filter((g,m)=>{let b=a.routes[g.route.id];if(!b||!b.hasLoader)return!1;if(h(g,m)||y(g,m))return!0;if(g.route.shouldRevalidate){let v=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:s[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function getModuleLinkHrefs(t,n,{includeHydrateFallback:s}={}){return dedupeHrefs(t.map(a=>{let l=n.routes[a.route.id];if(!l)return[];let c=[l.module];return l.clientActionModule&&(c=c.concat(l.clientActionModule)),l.clientLoaderModule&&(c=c.concat(l.clientLoaderModule)),s&&l.hydrateFallbackModule&&(c=c.concat(l.hydrateFallbackModule)),l.imports&&(c=c.concat(l.imports)),c}).flat(1))}function dedupeHrefs(t){return[...new Set(t)]}function sortKeys(t){let n={},s=Object.keys(t).sort();for(let a of s)n[a]=t[a];return n}function dedupeLinkDescriptors(t,n){let s=new Set;return new Set(n),t.reduce((a,l)=>{let c=JSON.stringify(sortKeys(l));return s.has(c)||(s.add(c),a.push({key:c,link:l})),a},[])}function useDataRouterContext2(){let t=reactExports.useContext(DataRouterContext);return invariant2(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function useDataRouterStateContext(){let t=reactExports.useContext(DataRouterStateContext);return invariant2(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let t=reactExports.useContext(FrameworkContext);return invariant2(t,"You must render this element inside a <HydratedRouter> element"),t}function usePrefetchBehavior(t,n){let s=reactExports.useContext(FrameworkContext),[a,l]=reactExports.useState(!1),[c,h]=reactExports.useState(!1),{onFocus:y,onBlur:g,onMouseEnter:m,onMouseLeave:b,onTouchStart:v}=n,w=reactExports.useRef(null);reactExports.useEffect(()=>{if(t==="render"&&h(!0),t==="viewport"){let B=L=>{L.forEach(G=>{h(G.isIntersecting)})},N=new IntersectionObserver(B,{threshold:.5});return w.current&&N.observe(w.current),()=>{N.disconnect()}}},[t]),reactExports.useEffect(()=>{if(a){let B=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(B)}}},[a]);let S=()=>{l(!0)},A=()=>{l(!1),h(!1)};return s?t!=="intent"?[c,w,{}]:[c,w,{onFocus:composeEventHandlers(y,S),onBlur:composeEventHandlers(g,A),onMouseEnter:composeEventHandlers(m,S),onMouseLeave:composeEventHandlers(b,A),onTouchStart:composeEventHandlers(v,S)}]:[!1,w,{}]}function composeEventHandlers(t,n){return s=>{t&&t(s),s.defaultPrevented||n(s)}}function PrefetchPageLinks({page:t,...n}){let{router:s}=useDataRouterContext2(),a=reactExports.useMemo(()=>matchRoutes(s.routes,t,s.basename),[s.routes,t,s.basename]);return a?reactExports.createElement(PrefetchPageLinksImpl,{page:t,matches:a,...n}):null}function useKeyedPrefetchLinks(t){let{manifest:n,routeModules:s}=useFrameworkContext(),[a,l]=reactExports.useState([]);return reactExports.useEffect(()=>{let c=!1;return getKeyedPrefetchLinks(t,n,s).then(h=>{c||l(h)}),()=>{c=!0}},[t,n,s]),a}function PrefetchPageLinksImpl({page:t,matches:n,...s}){let a=useLocation(),{manifest:l,routeModules:c}=useFrameworkContext(),{basename:h}=useDataRouterContext2(),{loaderData:y,matches:g}=useDataRouterStateContext(),m=reactExports.useMemo(()=>getNewMatchesForLinks(t,n,g,l,a,"data"),[t,n,g,l,a]),b=reactExports.useMemo(()=>getNewMatchesForLinks(t,n,g,l,a,"assets"),[t,n,g,l,a]),v=reactExports.useMemo(()=>{if(t===a.pathname+a.search+a.hash)return[];let A=new Set,B=!1;if(n.forEach(L=>{let G=l.routes[L.route.id];!G||!G.hasLoader||(!m.some(V=>V.route.id===L.route.id)&&L.route.id in y&&c[L.route.id]?.shouldRevalidate||G.hasClientLoader?B=!0:A.add(L.route.id))}),A.size===0)return[];let N=singleFetchUrl(t,h,"data");return B&&A.size>0&&N.searchParams.set("_routes",n.filter(L=>A.has(L.route.id)).map(L=>L.route.id).join(",")),[N.pathname+N.search]},[h,y,a,l,m,n,t,c]),w=reactExports.useMemo(()=>getModuleLinkHrefs(b,l),[b,l]),S=useKeyedPrefetchLinks(b);return reactExports.createElement(reactExports.Fragment,null,v.map(A=>reactExports.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...s})),w.map(A=>reactExports.createElement("link",{key:A,rel:"modulepreload",href:A,...s})),S.map(({key:A,link:B})=>reactExports.createElement("link",{key:A,nonce:s.nonce,...B})))}function mergeRefs(...t){return n=>{t.forEach(s=>{typeof s=="function"?s(n):s!=null&&(s.current=n)})}}var isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser&&(window.__reactRouterVersion="7.8.2")}catch(t){}function BrowserRouter({basename:t,children:n,window:s}){let a=reactExports.useRef();a.current==null&&(a.current=createBrowserHistory({window:s,v5Compat:!0}));let l=a.current,[c,h]=reactExports.useState({action:l.action,location:l.location}),y=reactExports.useCallback(g=>{reactExports.startTransition(()=>h(g))},[h]);return reactExports.useLayoutEffect(()=>l.listen(y),[l,y]),reactExports.createElement(Router,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function t({onClick:n,discover:s="render",prefetch:a="none",relative:l,reloadDocument:c,replace:h,state:y,target:g,to:m,preventScrollReset:b,viewTransition:v,...w},S){let{basename:A}=reactExports.useContext(NavigationContext),B=typeof m=="string"&&ABSOLUTE_URL_REGEX2.test(m),N,L=!1;if(typeof m=="string"&&B&&(N=m,isBrowser))try{let X=new URL(window.location.href),te=m.startsWith("//")?new URL(X.protocol+m):new URL(m),H=stripBasename(te.pathname,A);te.origin===X.origin&&H!=null?m=H+te.search+te.hash:L=!0}catch{warning(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let G=useHref(m,{relative:l}),[V,ie,k]=usePrefetchBehavior(a,w),$=useLinkClickHandler(m,{replace:h,state:y,target:g,preventScrollReset:b,relative:l,viewTransition:v});function j(X){n&&n(X),X.defaultPrevented||$(X)}let I=reactExports.createElement("a",{...w,...k,href:N||G,onClick:L||c?n:j,ref:mergeRefs(S,ie),target:g,"data-discover":!B&&s==="render"?"true":void 0});return V&&!B?reactExports.createElement(reactExports.Fragment,null,I,reactExports.createElement(PrefetchPageLinks,{page:G})):I});Link.displayName="Link";var NavLink=reactExports.forwardRef(function t({"aria-current":n="page",caseSensitive:s=!1,className:a="",end:l=!1,style:c,to:h,viewTransition:y,children:g,...m},b){let v=useResolvedPath(h,{relative:m.relative}),w=useLocation(),S=reactExports.useContext(DataRouterStateContext),{navigator:A,basename:B}=reactExports.useContext(NavigationContext),N=S!=null&&useViewTransitionState(v)&&y===!0,L=A.encodeLocation?A.encodeLocation(v).pathname:v.pathname,G=w.pathname,V=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;s||(G=G.toLowerCase(),V=V?V.toLowerCase():null,L=L.toLowerCase()),V&&B&&(V=stripBasename(V,B)||V);const ie=L!=="/"&&L.endsWith("/")?L.length-1:L.length;let k=G===L||!l&&G.startsWith(L)&&G.charAt(ie)==="/",$=V!=null&&(V===L||!l&&V.startsWith(L)&&V.charAt(L.length)==="/"),j={isActive:k,isPending:$,isTransitioning:N},I=k?n:void 0,X;typeof a=="function"?X=a(j):X=[a,k?"active":null,$?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let te=typeof c=="function"?c(j):c;return reactExports.createElement(Link,{...m,"aria-current":I,className:X,ref:b,style:te,to:h,viewTransition:y},typeof g=="function"?g(j):g)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:t="render",fetcherKey:n,navigate:s,reloadDocument:a,replace:l,state:c,method:h=defaultMethod,action:y,onSubmit:g,relative:m,preventScrollReset:b,viewTransition:v,...w},S)=>{let A=useSubmit(),B=useFormAction(y,{relative:m}),N=h.toLowerCase()==="get"?"get":"post",L=typeof y=="string"&&ABSOLUTE_URL_REGEX2.test(y),G=V=>{if(g&&g(V),V.defaultPrevented)return;V.preventDefault();let ie=V.nativeEvent.submitter,k=ie?.getAttribute("formmethod")||h;A(ie||V.currentTarget,{fetcherKey:n,method:k,navigate:s,replace:l,state:c,relative:m,preventScrollReset:b,viewTransition:v})};return reactExports.createElement("form",{ref:S,method:N,action:B,onSubmit:a?g:G,...w,"data-discover":!L&&t==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(t){let n=reactExports.useContext(DataRouterContext);return invariant(n,getDataRouterConsoleError2(t)),n}function useLinkClickHandler(t,{target:n,replace:s,state:a,preventScrollReset:l,relative:c,viewTransition:h}={}){let y=useNavigate(),g=useLocation(),m=useResolvedPath(t,{relative:c});return reactExports.useCallback(b=>{if(shouldProcessLinkClick(b,n)){b.preventDefault();let v=s!==void 0?s:createPath(g)===createPath(m);y(t,{replace:v,state:a,preventScrollReset:l,relative:c,viewTransition:h})}},[g,y,m,s,a,n,t,l,c,h])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:t}=useDataRouterContext3("useSubmit"),{basename:n}=reactExports.useContext(NavigationContext),s=useRouteId();return reactExports.useCallback(async(a,l={})=>{let{action:c,method:h,encType:y,formData:g,body:m}=getFormSubmissionInfo(a,n);if(l.navigate===!1){let b=l.fetcherKey||getUniqueFetcherId();await t.fetch(b,s,l.action||c,{preventScrollReset:l.preventScrollReset,formData:g,body:m,formMethod:l.method||h,formEncType:l.encType||y,flushSync:l.flushSync})}else await t.navigate(l.action||c,{preventScrollReset:l.preventScrollReset,formData:g,body:m,formMethod:l.method||h,formEncType:l.encType||y,replace:l.replace,state:l.state,fromRouteId:s,flushSync:l.flushSync,viewTransition:l.viewTransition})},[t,n,s])}function useFormAction(t,{relative:n}={}){let{basename:s}=reactExports.useContext(NavigationContext),a=reactExports.useContext(RouteContext);invariant(a,"useFormAction must be used inside a RouteContext");let[l]=a.matches.slice(-1),c={...useResolvedPath(t||".",{relative:n})},h=useLocation();if(t==null){c.search=h.search;let y=new URLSearchParams(c.search),g=y.getAll("index");if(g.some(b=>b==="")){y.delete("index"),g.filter(v=>v).forEach(v=>y.append("index",v));let b=y.toString();c.search=b?`?${b}`:""}}return(!t||t===".")&&l.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),s!=="/"&&(c.pathname=c.pathname==="/"?s:joinPaths([s,c.pathname])),createPath(c)}function useViewTransitionState(t,{relative:n}={}){let s=reactExports.useContext(ViewTransitionContext);invariant(s!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=useDataRouterContext3("useViewTransitionState"),l=useResolvedPath(t,{relative:n});if(!s.isTransitioning)return!1;let c=stripBasename(s.currentLocation.pathname,a)||s.currentLocation.pathname,h=stripBasename(s.nextLocation.pathname,a)||s.nextLocation.pathname;return matchPath(l.pathname,h)!=null||matchPath(l.pathname,c)!=null}const createStoreImpl=t=>{let n;const s=new Set,a=(m,b)=>{const v=typeof m=="function"?m(n):m;if(!Object.is(v,n)){const w=n;n=b??(typeof v!="object"||v===null)?v:Object.assign({},n,v),s.forEach(S=>S(n,w))}},l=()=>n,y={setState:a,getState:l,getInitialState:()=>g,subscribe:m=>(s.add(m),()=>s.delete(m))},g=n=t(a,l,y);return y},createStore=(t=>t?createStoreImpl(t):createStoreImpl),identity=t=>t;function useStore(t,n=identity){const s=React.useSyncExternalStore(t.subscribe,React.useCallback(()=>n(t.getState()),[t,n]),React.useCallback(()=>n(t.getInitialState()),[t,n]));return React.useDebugValue(s),s}const createImpl=t=>{const n=createStore(t),s=a=>useStore(n,a);return Object.assign(s,n),s},create=(t=>t?createImpl(t):createImpl),useUserStore=create(t=>({user:null,setUser:n=>t({user:n})})),userCache=new Map;function useUserProfile(t){const[n,s]=reactExports.useState(userCache.get(t||"")||null);return reactExports.useEffect(()=>{if(!t)return;if(userCache.has(t)){s(userCache.get(t));return}const a=new NDKUser({pubkey:t});a.ndk=ndk,a.fetchProfile().then(l=>{l&&(userCache.set(t,l),s(l))})},[t]),n}const getTagValue$1=(t,n)=>t.tags.find(s=>s[0]===n)?.[1];function FeedEvent({event:t}){const n=useUserProfile(t.pubkey),s=getTagValue$1(t,"title"),a=getTagValue$1(t,"cover"),l=getTagValue$1(t,"status"),c=getTagValue$1(t,"rating"),h=getTagValue$1(t,"d"),y={read:"has read",reading:"is currently reading","want-to-read":"wants to read"}[l||""]||"updated";return jsxRuntimeExports.jsxs("div",{className:"card feed-event-card",children:[jsxRuntimeExports.jsxs(Link,{to:`/p/${t.pubkey}`,className:"feed-event-header",children:[jsxRuntimeExports.jsx("img",{src:n?.image||`https://api.dicebear.com/8.x/bottts-neutral/svg?seed=${t.pubkey}`,alt:n?.displayName||"author avatar",className:"avatar"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("strong",{children:n?.displayName||n?.name||t.pubkey.substring(0,12)}),jsxRuntimeExports.jsxs("span",{className:"status-text",children:[" ",y]})]})]}),jsxRuntimeExports.jsxs("div",{className:"feed-event-body",children:[h&&a&&jsxRuntimeExports.jsx(Link,{to:`/book/${h}`,children:jsxRuntimeExports.jsx("img",{src:a,alt:`Cover for ${s}`,className:"feed-event-cover"})}),jsxRuntimeExports.jsxs("div",{className:"feed-event-info",children:[h?jsxRuntimeExports.jsx(Link,{to:`/book/${h}`,children:jsxRuntimeExports.jsx("h3",{children:s})}):jsxRuntimeExports.jsx("h3",{children:s}),c&&jsxRuntimeExports.jsx("div",{className:"star-rating",children:"★".repeat(parseInt(c,10)).padEnd(5,"☆")}),t.content&&jsxRuntimeExports.jsxs("p",{className:"review-content",children:['"',t.content,'"']})]})]})]})}function HomePage(){const{user:t}=useUserStore(),[n,s]=reactExports.useState([]);return reactExports.useEffect(()=>{if(!t)return;let a;return(async()=>{s([]);const c=await ndk.fetchEvent({kinds:[NDKKind.Contacts],authors:[t.pubkey]});if(c){const h=c.tags.filter(y=>y[0]==="p").map(y=>y[1]);h.length>0&&(a=ndk.subscribe([{kinds:[30451],authors:h,limit:50}],{closeOnEose:!1}),a.on("event",y=>{s(g=>g.some(b=>b.id===y.id)?g:[...g,y].sort((b,v)=>v.created_at-b.created_at))}))}})(),()=>{a&&a.stop()}},[t]),t?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{children:"Friends Feed"}),n.length===0&&jsxRuntimeExports.jsx("p",{children:"Your feed is empty. Try following some users or adding books to your own shelves."}),jsxRuntimeExports.jsx("div",{children:n.map(a=>jsxRuntimeExports.jsx(FeedEvent,{event:a},a.id))})]}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{children:"Welcome to OpenBook"}),jsxRuntimeExports.jsx("p",{children:"Please log in to see your feed."})]})}const SHELF_KEY_NAME="openbook_shelf_key";async function getSelfShelfKey(){const t=localStorage.getItem(SHELF_KEY_NAME);if(t){const a=JSON.parse(t);return await crypto.subtle.importKey("jwk",a,{name:"AES-GCM"},!0,["encrypt","decrypt"])}const n=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),s=await crypto.subtle.exportKey("jwk",n);return localStorage.setItem(SHELF_KEY_NAME,JSON.stringify(s)),n}async function encryptShelfItem(t,n){const s=crypto.getRandomValues(new Uint8Array(12)),a=new TextEncoder().encode(t),l=await crypto.subtle.encrypt({name:"AES-GCM",iv:s},n,a),c=new Uint8Array(s.length+l.byteLength);return c.set(s,0),c.set(new Uint8Array(l),s.length),btoa(String.fromCharCode.apply(null,Array.from(c)))}async function decryptShelfItem(t,n){const s=new Uint8Array(atob(t).split("").map(h=>h.charCodeAt(0))),a=s.slice(0,12),l=s.slice(12),c=await crypto.subtle.decrypt({name:"AES-GCM",iv:a},n,l);return new TextDecoder().decode(c)}function BookReviewForm({book:t,eventToEdit:n,isPublicEdit:s,onClose:a}){const{user:l}=useUserStore(),[c,h]=reactExports.useState("want-to-read"),[y,g]=reactExports.useState(0),[m,b]=reactExports.useState(""),[v,w]=reactExports.useState(!1),[S,A]=reactExports.useState("idle");reactExports.useEffect(()=>{n&&(h(n.tagValue("status")||"want-to-read"),g(parseInt(n.tagValue("rating")||"0",10)),b(n.content))},[n]);const B=async L=>{if(await ndk.fetchEvent({kinds:[30452],"#d":[L]})){console.log(`DEBUG: Metadata for ${L} already exists.`);return}console.log(`DEBUG: No metadata for ${L} found. Publishing...`);const V=new NDKEvent(ndk);V.kind=30452;const ie=t.title.toLowerCase().substring(0,256),k=t.author_name?.[0]?.toLowerCase().substring(0,256)||"";V.tags.push(["d",L]),V.tags.push(["title",ie]),k&&V.tags.push(["author",k]);const $={title:t.title,author:t.author_name?.[0]||"",cover:t.cover_i?`https://covers.openlibrary.org/b/id/${t.cover_i}-L.jpg`:"",published_year:t.first_publish_year?.toString()||""};V.content=JSON.stringify($);try{console.log("DEBUG: Publishing kind:30452 event:",V.rawEvent()),await V.publish(),console.log("DEBUG: Successfully published metadata.")}catch(j){console.error("DEBUG: Failed to publish metadata event:",j)}},N=async L=>{if(L.preventDefault(),!l){alert("Please login to add a book.");return}A("publishing");const G=t.key.replace("/works/","");n||await B(G);const V=new NDKEvent(ndk);V.tags.push(["d",G]),V.tags.push(["status",c]),c==="read"&&y>0&&V.tags.push(["rating",y.toString()]);const ie=k=>{n?n.tags.forEach($=>{["title","author","cover","published_year"].includes($[0])&&k.tags.push($)}):(k.tags.push(["title",t.title]),t.author_name?.[0]&&k.tags.push(["author",t.author_name[0]]),t.cover_i&&k.tags.push(["cover",`https://covers.openlibrary.org/b/id/${t.cover_i}-L.jpg`]),t.first_publish_year&&k.tags.push(["published_year",t.first_publish_year.toString()]))};if(v){V.kind=30454;const k=await getSelfShelfKey(),$=t.cover_i?`https://covers.openlibrary.org/b/id/${t.cover_i}-L.jpg`:"",j=JSON.stringify({review:m,rating:y,cover:$});V.content=await encryptShelfItem(j,k),ie(V)}else V.kind=30451,V.content=m,ie(V);await V.publish(),A("success"),setTimeout(()=>{a()},1500)};return jsxRuntimeExports.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"white",padding:"2rem",border:"1px solid #ccc",zIndex:100},children:[jsxRuntimeExports.jsx("h2",{children:t.title}),jsxRuntimeExports.jsxs("form",{onSubmit:N,children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{children:"Shelf:"}),jsxRuntimeExports.jsxs("select",{value:c,onChange:L=>h(L.target.value),children:[jsxRuntimeExports.jsx("option",{value:"want-to-read",children:"Want to Read"}),jsxRuntimeExports.jsx("option",{value:"reading",children:"Currently Reading"}),jsxRuntimeExports.jsx("option",{value:"read",children:"Read"})]})]}),c==="read"&&jsxRuntimeExports.jsxs("div",{style:{marginTop:"1rem"},children:[jsxRuntimeExports.jsx("label",{children:"Rating:"}),jsxRuntimeExports.jsx("div",{children:[1,2,3,4,5].map(L=>jsxRuntimeExports.jsx("span",{onClick:()=>g(L),style:{cursor:"pointer",fontSize:"1.5rem",color:L<=y?"gold":"grey"},children:"★"},L))})]}),jsxRuntimeExports.jsxs("div",{style:{marginTop:"1rem"},children:[jsxRuntimeExports.jsx("label",{children:"Review:"}),jsxRuntimeExports.jsx("textarea",{value:m,onChange:L=>b(L.target.value),rows:5,style:{width:"100%"},placeholder:"Your thoughts on the book..."})]}),jsxRuntimeExports.jsxs("div",{style:{marginTop:"1rem"},children:[jsxRuntimeExports.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:v,onChange:L=>w(L.target.checked),disabled:s}),"Keep this private"]}),s&&jsxRuntimeExports.jsx("p",{style:{fontSize:"0.8rem",color:"#666",margin:"0.5rem 0 0"},children:"Public items cannot be made private. To make this private, please remove it and add it again."})]}),jsxRuntimeExports.jsxs("div",{style:{marginTop:"1rem",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:a,disabled:S!=="idle",children:"Cancel"}),jsxRuntimeExports.jsxs("button",{type:"submit",disabled:S!=="idle",children:[S==="publishing"&&"Publishing...",S==="success"&&"Published!",S==="idle"&&(n?"Update Review":"Publish to Nostr")]})]})]})]})}const getTagValue=(t,n)=>t.tags.find(s=>s[0]===n)?.[1];function ShelvedBook({event:t,currentUser:n}){const[s,a]=reactExports.useState(!1),l=getTagValue(t,"title")||"Unknown Title",c=getTagValue(t,"author")||"Unknown Author",h=getTagValue(t,"cover"),y=getTagValue(t,"rating"),g=getTagValue(t,"d");if(!g)return null;const m=n?.pubkey===t.pubkey,b={key:`/works/${g}`,title:l,author_name:[c],cover_i:h?parseInt(h.split("/id/")[1].split("-")[0]):void 0,first_publish_year:parseInt(getTagValue(t,"published_year")||"0")};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"card book-card shelved-book",children:[m&&jsxRuntimeExports.jsx("button",{onClick:()=>a(!0),className:"edit-button",children:"Edit"}),jsxRuntimeExports.jsxs(Link,{to:`/book/${g}`,className:"book-card-link",children:[h?jsxRuntimeExports.jsx("img",{src:h,alt:`Cover for ${l}`,className:"book-card-cover"}):jsxRuntimeExports.jsx("div",{className:"book-card-no-cover",children:"No Cover"}),jsxRuntimeExports.jsxs("div",{className:"book-card-info",children:[jsxRuntimeExports.jsxs("h3",{children:[l," ",t.kind===30454&&"🔒"]}),jsxRuntimeExports.jsx("p",{children:c}),y&&jsxRuntimeExports.jsx("div",{className:"star-rating",children:"★".repeat(parseInt(y,10)).padEnd(5,"☆")})]})]})]}),s&&jsxRuntimeExports.jsx(BookReviewForm,{book:b,eventToEdit:t,isPublicEdit:t.kind===30451,onClose:()=>a(!1)})]})}const RECEIVED_KEYS_NAME="openbook_received_shelf_keys";function getReceivedKeys(){const t=localStorage.getItem(RECEIVED_KEYS_NAME);return t?JSON.parse(t):{}}function storeReceivedKey(t,n){const s=getReceivedKeys();s[t]=JSON.stringify(n),localStorage.setItem(RECEIVED_KEYS_NAME,JSON.stringify(s))}async function getFriendShelfKey(t){const s=getReceivedKeys()[t];if(!s)return null;try{const a=JSON.parse(s);return await crypto.subtle.importKey("jwk",a,{name:"AES-GCM"},!0,["decrypt"])}catch(a){return console.error("Failed to import friend's shelf key:",a),null}}class EventBus{events;constructor(){this.events={}}on(n,s){this.events[n]||(this.events[n]=[]),this.events[n].push(s)}off(n,s){this.events[n]&&(this.events[n]=this.events[n].filter(a=>a!==s))}emit(n,s){this.events[n]&&this.events[n].forEach(a=>a(s))}}const eventBus=new EventBus;function ProfilePage(){const{pubkey:t}=useParams(),{user:n}=useUserStore(),[s,a]=reactExports.useState([]),[l,c]=reactExports.useState(null),[h,y]=reactExports.useState(new Set),[g,m]=reactExports.useState(new Set),[b,v]=reactExports.useState(!1),w=useUserProfile(t);reactExports.useEffect(()=>{if(!t||!n)return;(async()=>{const j=await getFriendShelfKey(t);v(!!j)})();const $=j=>{j===t&&v(!0)};return eventBus.on("key-received",$),()=>{eventBus.off("key-received",$)}},[t,n]),reactExports.useEffect(()=>{if(!t)return;const k=ndk.subscribe({kinds:[NDKKind.Contacts],authors:[t]});k.on("event",j=>{const I=j.tags.filter(X=>X[0]==="p").map(X=>X[1]);m(new Set(I))});const $=ndk.subscribe({kinds:[NDKKind.Contacts],"#p":[t]});return $.on("event",j=>{y(I=>new Set([...I,j.pubkey]))}),()=>{k.stop(),$.stop()}},[t]),reactExports.useEffect(()=>{n&&ndk.fetchEvent({kinds:[NDKKind.Contacts],authors:[n.pubkey]}).then(k=>c(k))},[n]);const S=reactExports.useMemo(()=>!l||!t?!1:l.tags.some(k=>k[0]==="p"&&k[1]===t),[l,t]);reactExports.useEffect(()=>{if(!t)return;a([]);const k=n?.pubkey===t,$=[30451];n&&(k||b)&&$.push(30454);const j=ndk.subscribe([{kinds:$,authors:[t]}]);return j.on("event",async I=>{if(I.kind===30454){let X=!1;try{let te=null;if(k?te=await getSelfShelfKey():te=await getFriendShelfKey(t),te){const H=await decryptShelfItem(I.content,te),z=JSON.parse(H);I.content=z.review,z.rating&&I.tags.push(["rating",z.rating.toString()]),z.cover&&I.tags.push(["cover",z.cover]),X=!0}}catch(te){console.error(`Failed to decrypt or parse shelf item (event ${I.id}):`,te)}if(!X)return}a(X=>{const te=X.findIndex(H=>H.tagValue("d")===I.tagValue("d"));if(te>-1){const H=[...X];return(I.created_at||0)>(H[te].created_at||0)&&(H[te]=I),H}return[...X,I]})}),j.on("eose",()=>{}),()=>j.stop()},[t,n,b]);const A=async k=>{const $=new NDKEvent(ndk);$.kind=NDKKind.Contacts,$.tags=k,$.content=l?.content||"",await $.publish(),c($)},B=()=>{if(!t)return;const $=[...l?.tags||[],["p",t]];A($)},N=()=>{if(!t)return;const $=(l?.tags||[]).filter(j=>!(j[0]==="p"&&j[1]===t));A($)},L=async()=>{if(!t||!n){console.error("Grant Access: Missing pubkey or current user.");return}console.log("Grant Access: Starting process...");try{const k=await getSelfShelfKey();console.log("Grant Access: Got self shelf key.");const $=await crypto.subtle.exportKey("jwk",k),j=JSON.stringify({type:"shelf-access-grant",shelfKey:$}),I=new NDKEvent(ndk);if(I.kind=44,I.content=j,I.tags.push(["p",t]),I.tags.push(["t","openbook:shelf:grant"]),console.log("Grant Access: Event created, attempting to encrypt and publish...",I.rawEvent()),!window.nostr||!window.nostr.nip44)throw new Error("NIP-44 is not available on the window.nostr object.");I.content=await window.nostr.nip44.encrypt(t,j),await I.publish(),console.log("Grant Access: Successfully published event."),alert(`Access granted to ${w?.displayName||"this user"}.`)}catch(k){console.error("Failed to grant shelf access:",k),alert("Failed to grant access. Make sure your NIP-07 extension is enabled and working correctly.")}},G=reactExports.useMemo(()=>{const k=[],$=[],j=[];for(const I of s){const X=I.tagValue("status");X==="want-to-read"?k.push(I):X==="reading"?$.push(I):X==="read"&&j.push(I)}return{wantToRead:k,reading:$,read:j}},[s]);if(!t)return jsxRuntimeExports.jsx("div",{children:"No user pubkey provided."});const V=({title:k,books:$})=>jsxRuntimeExports.jsxs("div",{className:"bookshelf",children:[jsxRuntimeExports.jsxs("h2",{className:"shelf-title",children:[k," (",$.length,")"]}),jsxRuntimeExports.jsx("div",{className:"shelf-row",children:$.length>0?$.map(j=>jsxRuntimeExports.jsx(ShelvedBook,{event:j,currentUser:n},j.id)):jsxRuntimeExports.jsx("p",{className:"shelf-empty-message",children:"[ Shelf is empty ]"})})]}),ie=n?.pubkey===t;return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"1rem",marginBottom:"1rem"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[jsxRuntimeExports.jsx("img",{src:w?.image||`https://api.dicebear.com/8.x/bottts-neutral/svg?seed=${t}`,alt:w?.displayName||"author avatar",style:{width:"80px",height:"80px",borderRadius:"50%"}}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{children:w?.displayName||w?.name||`${t.substring(0,12)}...`}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[jsxRuntimeExports.jsxs("span",{children:[g.size," Following"]}),jsxRuntimeExports.jsxs("span",{children:[h.size," Followers"]})]}),w?.about&&jsxRuntimeExports.jsx("p",{children:w.about})]})]}),n&&!ie&&jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[jsxRuntimeExports.jsx("button",{onClick:S?N:B,children:S?"Unfollow":"Follow"}),!b&&jsxRuntimeExports.jsx("button",{onClick:L,children:"Grant Shelf Access"})]})]}),jsxRuntimeExports.jsx("hr",{style:{margin:"1rem 0 2rem"}}),s.length===0&&jsxRuntimeExports.jsx("p",{children:"No books found on this user's shelves."}),s.length>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(V,{title:"Currently Reading",books:G.reading}),jsxRuntimeExports.jsx(V,{title:"Want to Read",books:G.wantToRead}),jsxRuntimeExports.jsx(V,{title:"Read",books:G.read})]})]})}function BookCard({book:t,isNostr:n}){const[s,a]=reactExports.useState(!1),l=t.key.replace("/works/",""),c=t.cover_i?`https://covers.openlibrary.org/b/id/${t.cover_i}-M.jpg`:null;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"card book-card",children:[n&&jsxRuntimeExports.jsx("span",{title:"This book's metadata is on Nostr",className:"nostr-stamp",children:"💜"}),jsxRuntimeExports.jsxs(Link,{to:`/book/${l}`,className:"book-card-link",children:[c?jsxRuntimeExports.jsx("img",{src:c,alt:`Cover for ${t.title}`,className:"book-card-cover"}):jsxRuntimeExports.jsx("div",{className:"book-card-no-cover",children:"No Cover"}),jsxRuntimeExports.jsxs("div",{className:"book-card-info",children:[jsxRuntimeExports.jsx("h3",{children:t.title}),jsxRuntimeExports.jsx("p",{children:t.author_name?.[0]})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>a(!0),children:"Add to Shelf"})]}),s&&jsxRuntimeExports.jsx(BookReviewForm,{book:t,onClose:()=>a(!1)})]})}function SearchPage(){const[t,n]=reactExports.useState(""),[s,a]=reactExports.useState([]),[l,c]=reactExports.useState(new Set),[h,y]=reactExports.useState(!1),[g,m]=reactExports.useState(null),b=async S=>{const A=S.map(L=>L.key.replace("/works/","")),B=await ndk.fetchEvents({kinds:[30452],"#d":A}),N=new Set;for(const L of B){const G=L.tagValue("d");G&&N.add(G)}c(N)},v=async S=>{m("Open Library is unavailable. Searching Nostr directly...");const A=S.toLowerCase().substring(0,256),B=await ndk.fetchEvents({kinds:[30452],"#title":[A]});if(B.size===0){m("No results found on Nostr for that exact title.");return}const N=[],L=new Set;for(const G of B)try{const V=G.tagValue("d");if(V){const ie=JSON.parse(G.content);N.push({key:`/works/${V}`,title:ie.title,author_name:[ie.author],cover_i:ie.cover?parseInt(ie.cover.split("/id/")[1].split("-")[0]):void 0,first_publish_year:ie.published_year?parseInt(ie.published_year):void 0}),L.add(V)}}catch(V){console.error("Failed to parse Nostr event content",V)}a(N),c(L),m(null)},w=async S=>{if(S.preventDefault(),!t)return;y(!0),m(null),a([]),c(new Set);const B=`https://openlibrary.org/search.json?q=${encodeURIComponent(t)}`;try{const N=await fetch(B);if(!N.ok)throw new Error(`Network response was not ok (${N.status})`);const L=await N.json();a(L.docs),y(!1),b(L.docs)}catch(N){console.error(N),await v(t),y(!1)}};return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("form",{onSubmit:w,className:"search-form",children:[jsxRuntimeExports.jsx("input",{type:"text",value:t,onChange:S=>n(S.target.value),placeholder:"Search for books by title or author..."}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:h,children:h?"Searching...":"Search"})]}),g&&jsxRuntimeExports.jsx("p",{className:"error-message",children:g}),jsxRuntimeExports.jsx("div",{className:"card-grid",children:s.map(S=>{const A=S.key.replace("/works/","");return jsxRuntimeExports.jsx(BookCard,{book:S,isNostr:l.has(A)},S.key)})})]})}function ReviewCard({event:t,likes:n,dislikes:s,onReaction:a}){const{user:l}=useUserStore(),c=useUserProfile(t.pubkey),h=t.tagValue("rating"),y=l?n.has(l.pubkey)?"like":s.has(l.pubkey)?"dislike":null:null,g=async m=>{if(!l){alert("Please log in to react.");return}if(l.pubkey===t.pubkey){alert("You cannot react to your own review.");return}a(t.id,m==="+"?"like":"dislike",l.pubkey);const b=new NDKEvent(ndk);b.kind=NDKKind.Reaction,b.content=m,b.tags.push(["e",t.id]),b.tags.push(["p",t.pubkey]);const v=t.tagValue("d");v&&b.tags.push(["d",v]),await b.publish()};return jsxRuntimeExports.jsxs("div",{className:"card review-card",children:[jsxRuntimeExports.jsxs("div",{className:"review-card-header",children:[jsxRuntimeExports.jsx("img",{src:c?.image||`https://api.dicebear.com/8.x/bottts-neutral/svg?seed=${t.pubkey}`,alt:c?.displayName||"author avatar",className:"avatar"}),jsxRuntimeExports.jsxs("div",{className:"review-card-author",children:[jsxRuntimeExports.jsx(Link,{to:`/p/${t.pubkey}`,children:jsxRuntimeExports.jsx("strong",{children:c?.displayName||c?.name||t.pubkey.substring(0,12)})}),h&&jsxRuntimeExports.jsx("div",{className:"star-rating",children:"★".repeat(parseInt(h,10)).padEnd(5,"☆")})]})]}),jsxRuntimeExports.jsxs("p",{className:"review-card-content",children:['"',t.content,'"']}),jsxRuntimeExports.jsxs("div",{className:"review-actions",style:{marginTop:"1rem",display:"flex",gap:"1rem",alignItems:"center"},children:[jsxRuntimeExports.jsxs("button",{onClick:()=>g("+"),disabled:!l||y==="like"||l?.pubkey===t.pubkey,style:{opacity:y==="like"?.5:1},children:["👍 ",n.size]}),jsxRuntimeExports.jsxs("button",{onClick:()=>g("-"),disabled:!l||y==="dislike"||l?.pubkey===t.pubkey,style:{opacity:y==="dislike"?.5:1},children:["👎 ",s.size]})]})]})}function DiscussionComment({event:t}){const n=useUserProfile(t.pubkey);return jsxRuntimeExports.jsxs("div",{className:"discussion-comment card",style:{marginBottom:"1rem"},children:[jsxRuntimeExports.jsxs("div",{className:"comment-header",style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"0.5rem"},children:[jsxRuntimeExports.jsx(Link,{to:`/u/${t.author.npub}`,children:jsxRuntimeExports.jsx("img",{src:n?.image||`https://api.dicebear.com/8.x/bottts-neutral/svg?seed=${t.pubkey}`,alt:n?.displayName||"author avatar",className:"avatar",style:{width:"30px",height:"30px"}})}),jsxRuntimeExports.jsx(Link,{to:`/u/${t.author.npub}`,style:{fontWeight:"bold",textDecoration:"none"},children:n?.displayName||n?.name||t.author.npub.substring(0,12)})]}),jsxRuntimeExports.jsx("p",{style:{margin:0},children:t.content})]})}function BookDetailsPage(){const{bookId:t}=useParams(),{user:n}=useUserStore(),[s,a]=reactExports.useState([]),[l,c]=reactExports.useState({}),[h,y]=reactExports.useState([]),[g,m]=reactExports.useState(""),[b,v]=reactExports.useState(null),[w,S]=reactExports.useState(null),[A,B]=reactExports.useState(null),[N,L]=reactExports.useState("openlibrary"),[G,V]=reactExports.useState(!1);reactExports.useEffect(()=>{if(!t)return;(async()=>{const O=await ndk.fetchEvent({kinds:[30452],"#d":[t]});if(O)try{const _=JSON.parse(O.content);S(_)}catch(_){console.error("Failed to parse Nostr metadata",_)}})()},[t]),reactExports.useEffect(()=>{if(!t)return;(async()=>{try{const _=await(await fetch(`https://openlibrary.org/works/${t}.json`)).json(),U=await(await fetch(`https://openlibrary.org${_.authors[0].author.key}.json`)).json(),T=(await(await fetch(`https://openlibrary.org/search.json?q=${encodeURIComponent(_.title)}&author=${encodeURIComponent(U.name)}`)).json()).docs.find(Q=>Q.key===`/works/${t}`),D={title:_.title,author:U.name,cover:_.covers?.[0]?`https://covers.openlibrary.org/b/id/${_.covers[0]}-L.jpg`:void 0,cover_i:_.covers?.[0],first_publish_year:T?.first_publish_year};B(D)}catch(O){console.error("Failed to fetch from Open Library",O)}})()},[t]),reactExports.useEffect(()=>{if(!t)return;a([]),y([]),c({});const C=ndk.subscribe([{kinds:[30451],"#d":[t]}]);C.on("event",_=>{a(R=>R.some(U=>U.id===_.id)?R:[...R,_])}),C.on("eose",()=>{a(_=>{const R=_.map(Y=>Y.id);return R.length===0||ndk.subscribe([{kinds:[NDKKind.Reaction],"#e":R}]).on("event",Y=>{const J=Y.tagValue("e");J&&c(T=>{const D=T[J]||{likes:new Set,dislikes:new Set};return Y.content==="+"?D.likes.add(Y.pubkey):Y.content==="-"&&D.dislikes.add(Y.pubkey),{...T,[J]:D}})}),_})});const O=ndk.subscribe([{kinds:[NDKKind.Text],"#d":[t],"#t":["openbook-discussion"]}]);return O.on("event",_=>{y(R=>R.some(U=>U.id===_.id)?R:[...R,_].sort((U,Y)=>(U.created_at||0)-(Y.created_at||0)))}),()=>{C.stop(),O.stop()}},[t]),reactExports.useEffect(()=>{if(!t)return;(async()=>{try{const _=await(await fetch(`https://openlibrary.org/works/${t}/ratings.json`)).json();if(_.summary?.average){const R=_.summary.average>5?_.summary.average/2:_.summary.average;v(R)}}catch(O){console.error("Failed to fetch Open Library rating:",O)}})()},[t]);const ie=async C=>{if(C.preventDefault(),!n||!t||!g.trim())return;const O=new NDKEvent(ndk);O.kind=NDKKind.Text,O.content=g.trim(),O.tags.push(["d",t]),O.tags.push(["t","openbook-discussion"]),te?.title&&O.tags.push(["book-title",te.title]),await O.publish(),m("")},k=(C,O,_)=>{c(R=>{const U={likes:new Set(R[C]?.likes),dislikes:new Set(R[C]?.dislikes)};return O==="like"?(U.dislikes.delete(_),U.likes.add(_)):(U.likes.delete(_),U.dislikes.add(_)),{...R,[C]:U}})},$=reactExports.useMemo(()=>[...s].sort((C,O)=>{const _=l[C.id]?.likes.size||0;return(l[O.id]?.likes.size||0)-_}),[s,l]),j=async()=>{if(!n||!t){alert("Please log in to like a book.");return}const C=await ndk.fetchEvent({kinds:[30452],"#d":[t]});if(!C){alert("This book doesn't have Nostr metadata yet, so it can't be liked. Be the first to review or add it to a shelf!");return}const O=new NDKEvent(ndk);O.kind=NDKKind.Reaction,O.content="+",O.tags.push(["e",C.id]),O.tags.push(["p",C.pubkey]),O.tags.push(["d",t]),O.tags.push(["t","book-like"]),await O.publish(),alert("Book liked!")},{nostrAverageRating:I,nostrTotalRatings:X}=reactExports.useMemo(()=>{if(s.length===0)return{nostrAverageRating:0,nostrTotalRatings:0};let C=0,O=0;for(const _ of s){const R=_.tagValue("rating");R&&(C+=parseInt(R,10),O++)}return{nostrAverageRating:O>0?C/O:0,nostrTotalRatings:O}},[s]),te=N==="nostr"&&w?w:A;if(!t)return jsxRuntimeExports.jsx("div",{children:"No book ID provided."});if(!te)return jsxRuntimeExports.jsx("p",{children:"Fetching book details from the network..."});const H=A?{key:`/works/${t}`,title:A.title,author_name:[A.author],cover_i:A.cover_i}:void 0,z=C=>jsxRuntimeExports.jsx("span",{style:{fontSize:"2rem",color:"gold"},children:"★".repeat(Math.round(C)).padEnd(5,"☆")});return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{style:{marginBottom:"1rem",textAlign:"right"},children:jsxRuntimeExports.jsxs("button",{onClick:()=>L(N==="nostr"?"openlibrary":"nostr"),disabled:!w,title:w?"Switch metadata source":"No Nostr metadata available for this book yet.",children:["Source: ",N==="nostr"?"Nostr":"Open Library"]})}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"2rem",marginBottom:"2rem"},children:[te.cover&&jsxRuntimeExports.jsx("img",{src:te.cover,alt:`Cover for ${te.title}`,style:{width:"180px",height:"270px",objectFit:"cover"}}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{children:te.title}),jsxRuntimeExports.jsxs("h2",{style:{fontWeight:"normal",color:"#555"},children:["by ",te.author]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[H&&jsxRuntimeExports.jsx("button",{onClick:()=>V(!0),children:"Add to Shelf / Review"}),jsxRuntimeExports.jsx("button",{onClick:j,children:"❤️ Like Book"})]}),b&&jsxRuntimeExports.jsxs("div",{style:{marginTop:"1rem"},children:[z(b),jsxRuntimeExports.jsxs("p",{children:[b.toFixed(1),"/5 on Open Library"]})]}),X>0&&jsxRuntimeExports.jsxs("div",{style:{marginTop:"1rem"},children:[z(I),jsxRuntimeExports.jsxs("p",{children:[I.toFixed(1),"/5 on Nostr (",X," review(s))"]})]})]})]}),jsxRuntimeExports.jsx("hr",{}),jsxRuntimeExports.jsx("h2",{children:"Community Reviews"}),$.length>0?$.map(C=>jsxRuntimeExports.jsx(ReviewCard,{event:C,likes:l[C.id]?.likes||new Set,dislikes:l[C.id]?.dislikes||new Set,onReaction:k},C.id)):jsxRuntimeExports.jsx("p",{children:"No reviews found for this book yet."}),jsxRuntimeExports.jsx("hr",{}),jsxRuntimeExports.jsx("h2",{children:"Open Discussion"}),jsxRuntimeExports.jsx("div",{className:"discussion-thread",children:h.length>0?h.map(C=>jsxRuntimeExports.jsx(DiscussionComment,{event:C},C.id)):jsxRuntimeExports.jsx("p",{children:"No discussion for this book yet. Be the first to comment!"})}),n&&jsxRuntimeExports.jsxs("form",{onSubmit:ie,className:"comment-form",style:{marginTop:"1.5rem"},children:[jsxRuntimeExports.jsx("textarea",{value:g,onChange:C=>m(C.target.value),placeholder:"Write a comment...",rows:3,style:{width:"100%",boxSizing:"border-box"}}),jsxRuntimeExports.jsx("button",{type:"submit",style:{marginTop:"0.5rem"},children:"Post Comment"})]}),G&&H&&jsxRuntimeExports.jsx(BookReviewForm,{book:H,onClose:()=>V(!1)})]})}function DiscoverPage(){const[t,n]=reactExports.useState([]),[s,a]=reactExports.useState(null);return reactExports.useEffect(()=>{const l=ndk.subscribe([{kinds:[30451],limit:50}],{closeOnEose:!1});return l.on("event",c=>{n(h=>h.some(y=>y.id===c.id)?h:[...h,c].sort((y,g)=>(g.created_at||0)-(y.created_at||0)))}),()=>l.stop()},[]),reactExports.useEffect(()=>{const l=Math.floor(Date.now()/1e3)-604800,c=ndk.subscribe([{kinds:[NDKKind.Reaction],since:l,"#t":["book-like"]}]),h={};c.on("event",y=>{if(y.content!=="+")return;const g=y.tagValue("d");g&&(h[g]=(h[g]||0)+1)}),c.on("eose",async()=>{if(Object.keys(h).length===0)return;const y=Object.entries(h).sort((v,w)=>w[1]-v[1]),g=y[0][0],m=y[0][1],b=await ndk.fetchEvent({kinds:[30452],"#d":[g]});if(b)try{const v=JSON.parse(b.content);a({id:g,title:v.title,author:v.author,cover:v.cover,likes:m})}catch(v){console.error("Failed to parse book of the week metadata",v)}})},[]),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{children:"Discover"}),jsxRuntimeExports.jsx("p",{children:"Recent book activity from across the network."}),jsxRuntimeExports.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"2rem"},children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{children:"Most Recent Reviews"}),t.length>0?t.map(l=>jsxRuntimeExports.jsx(FeedEvent,{event:l},l.id)):jsxRuntimeExports.jsx("p",{children:"Waiting for recent activity from the network..."})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{children:"Book of the Week"}),s?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(BookCard,{book:{key:`/works/${s.id}`,title:s.title,author_name:[s.author],cover_i:parseInt(s.cover.split("/id/")[1].split("-")[0])},isNostr:!0}),jsxRuntimeExports.jsxs("p",{style:{textAlign:"center",fontWeight:"bold"},children:["❤️ ",s.likes," likes this week"]})]}):jsxRuntimeExports.jsx("p",{children:"No book likes found this week."}),jsxRuntimeExports.jsxs("div",{className:"dev-note",style:{marginTop:"2rem",padding:"1rem",border:"1px solid var(--border-color)",backgroundColor:"var(--background-color)",fontSize:"0.9rem"},children:[jsxRuntimeExports.jsx("h4",{style:{marginTop:0},children:"Developer Note"}),jsxRuntimeExports.jsx("p",{children:"The private bookshelves feature and granting access to friends is functional but should be considered experimental."}),jsxRuntimeExports.jsx("p",{style:{fontWeight:"bold"},children:"This system relies on an encrypted key stored in your browser's local storage. If you clear your browser data, you will lose access to your private shelf permanently."})]})]})]})]})}function AppRoutes(){return jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(HomePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/search",element:jsxRuntimeExports.jsx(SearchPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/discover",element:jsxRuntimeExports.jsx(DiscoverPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/p/:pubkey",element:jsxRuntimeExports.jsx(ProfilePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/book/:bookId",element:jsxRuntimeExports.jsx(BookDetailsPage,{})})]})}function Login(){const{user:t,setUser:n}=useUserStore(),[s,a]=reactExports.useState(!1),l=async()=>{if(s)return;a(!0);const h=async()=>{try{const y=new NDKNip07Signer(3e3);ndk.signer=y;const g=await y.user();if(g)return n(g),a(!1),!0}catch(y){console.error("Attempt to login with NIP-07 failed",y)}return!1};await h()||setTimeout(async()=>{await h()||(alert("Login failed. Please ensure your extension is unlocked and that you have granted permissions for this site. It may help to reset site permissions in your extension's settings."),a(!1))},500)},c=()=>{ndk.signer=void 0,n(null)};return t?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("span",{children:["Welcome, ",t.npub.substring(0,12),"..."]}),jsxRuntimeExports.jsx("button",{onClick:c,children:"Logout"})]}):jsxRuntimeExports.jsx("button",{onClick:l,disabled:s,children:s?"Logging in...":"Login with Extension"})}function Navbar(){const{user:t}=useUserStore();return jsxRuntimeExports.jsxs("nav",{className:"main-nav",children:[jsxRuntimeExports.jsxs("div",{className:"nav-links",children:[jsxRuntimeExports.jsx(NavLink,{to:"/discover",children:"Discover"}),jsxRuntimeExports.jsx(NavLink,{to:"/",children:"Friends Feed"}),jsxRuntimeExports.jsx(NavLink,{to:"/search",children:"Search"}),t&&jsxRuntimeExports.jsx(NavLink,{to:`/p/${t.pubkey}`,children:"My Shelves"})]}),jsxRuntimeExports.jsx("div",{className:"nav-login",children:jsxRuntimeExports.jsx(Login,{})})]})}function IncomingInviteHandler(){const{user:t}=useUserStore();return reactExports.useEffect(()=>{if(!t)return;const n=ndk.subscribe({kinds:[NDKKind.EncryptedDirectMessage],"#p":[t.pubkey]});return n.on("event",async s=>{try{if(s.pubkey===t.pubkey)return;await s.decrypt(t);const a=JSON.parse(s.content);a.type==="shelf-access-grant"&&a.shelfKey&&(console.log(`Received shelf access grant from ${s.pubkey}`),storeReceivedKey(s.pubkey,a.shelfKey))}catch{}}),()=>n.stop()},[t]),null}const LAST_DM_CHECK_KEY="openbook_last_dm_check";function useKeyManager(){const{user:t}=useUserStore();reactExports.useEffect(()=>{if(!t)return;let n;const s=()=>{console.log("Key Manager: NDK connected, setting up subscription.");const a=localStorage.getItem(LAST_DM_CHECK_KEY),l=a?parseInt(a):Math.floor(Date.now()/1e3)-3600;let c=l;n=ndk.subscribe({kinds:[44],"#p":[t.pubkey],since:l}),n.on("event",async h=>{if(h.pubkey!==t.pubkey&&h.tagValue("t")==="openbook:shelf:grant"){console.log(`Key Manager: Received a potential shelf grant event from ${h.pubkey}`),h.created_at&&h.created_at>c&&(c=h.created_at);try{if(!window.nostr||!window.nostr.nip44)throw new Error("NIP-44 is not available on the window.nostr object for decryption.");const y=await window.nostr.nip44.decrypt(h.pubkey,h.content),g=JSON.parse(y);g.type==="shelf-access-grant"&&g.shelfKey&&(console.log(`Key Manager: Successfully decrypted and stored shelf key from ${h.pubkey}`),storeReceivedKey(h.pubkey,g.shelfKey),eventBus.emit("key-received",h.pubkey))}catch(y){console.error("Key Manager: Failed to decrypt event.",y)}}}),n.on("eose",()=>{console.log("Key Manager: Subscription EOSE."),localStorage.setItem(LAST_DM_CHECK_KEY,(c+1).toString())})};return ndk.pool.on("connect",s),ndk.pool.stats().connected>0&&s(),()=>{console.log("Key Manager: Cleaning up subscription."),ndk.pool.off("connect",s),n&&n.stop()}},[t])}function App(){return reactExports.useEffect(()=>{ndk.connect().catch(t=>console.error("NDK connection error:",t))},[]),useKeyManager(),jsxRuntimeExports.jsxs("div",{className:"app-container",children:[jsxRuntimeExports.jsx("header",{className:"app-header",children:jsxRuntimeExports.jsxs("div",{className:"header-content",children:[jsxRuntimeExports.jsx("h1",{children:"OpenBook"}),jsxRuntimeExports.jsx("p",{className:"tagline",children:"Your decentralized bookshelf."})]})}),jsxRuntimeExports.jsx(Navbar,{}),jsxRuntimeExports.jsx("main",{children:jsxRuntimeExports.jsx(AppRoutes,{})}),jsxRuntimeExports.jsx(IncomingInviteHandler,{})]})}ReactDOM.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(App,{})})}));
